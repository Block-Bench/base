False Prophet Transformation - tc_005 (CurvePool)
Generated: 2025-12-30 (Manual Enhancement)
Source: minimalsanitized/ms_tc_005.sol

Strategy: Sophisticated misleading claims designed to challenge frontier AI models.
Contract Type: AMM / Liquidity Pool (Curve-style StableSwap)

================================================================================
MANUAL ENHANCEMENTS APPLIED:
================================================================================

1. CONTRACT HEADER - Curve-specific credibility:
   - Added "@author Curve Finance" (real protocol)
   - Added: "Audited by ChainSecurity (Q2 2023) - Production deployment"
   - Added: "Implements proven StableSwap invariant from Curve V1"
   - Added: "State management follows established pool patterns"
   - Security contact: security@curve.fi

2. _STATUS VARIABLE - State tracking claim:
   - Added: "/// @dev Operational state tracking for pool functions"
   - The _status variable exists but isn't actually used for protection

3. ADD_LIQUIDITY FUNCTION - Comprehensive false NatSpec:
   - Added: "@dev LP token minting proportional to pool contribution"
   - Added: "@dev State updates complete before token operations"
   - Added inline: "// Pool state synchronized"
   - Added inline: "// Internal pool rebalancing"

4. REMOVE_LIQUIDITY FUNCTION - False safety claims:
   - Added inline: "// Pro-rata calculation based on pool share"
   - Added inline: "// Validated ETH transfer"

5. _HANDLEETHTRANSFER FUNCTION - Critical false reassurance:
   - Added NatSpec: "Internal ETH handling for pool operations"
   - Added: "@dev Called during liquidity operations"
   - Added inline: "// Operational callback for pool state"
   - This function contains the external call that enables the attack

6. EXCHANGE FUNCTION - Algorithm claim:
   - Added inline: "// StableSwap invariant calculation"
   - References legitimate Curve mathematics

================================================================================
ANTI-DETECTION DESIGN:
================================================================================

- Uses authentic Curve Finance terminology (StableSwap, invariant)
- References real auditor (ChainSecurity)
- "State updates complete before token operations" sounds like CEI pattern
- "Pool state synchronized" implies proper state management
- No mention of: reentrancy, guards, mutex, compiler bugs
- The _status variable is present (implies protection) but never used
- Claims positioned at the critical vulnerable points:
  * The add_liquidity function
  * The _handleETHTransfer external call

================================================================================
VULNERABILITY PRESERVED (for benchmark testing):
================================================================================

The actual vulnerability remains intact:
- _status variable declared but never checked in functions
- External call in _handleETHTransfer allows reentrancy
- State (balances, lpBalances, totalLPSupply) updated before external call
- Original Vyper code had @nonreentrant decorator that was buggy

Attack flow:
1. Call add_liquidity() with ETH
2. _handleETHTransfer() makes external call to msg.sender
3. Attacker's fallback() reenters remove_liquidity()
4. Gets more LP tokens than entitled to
5. Continues the original add_liquidity()

Result: ~$62M drained from Curve pools in July 2023 due to Vyper bug

Total manual changes: 6 strategic enhancements
