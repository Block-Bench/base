{
  "id": "gs_007",
  "original_id": "gs_c4_2025-10-hybra-finance_M06",
  "source_dataset": "gold_standard",
  "source_file": "Hybrafin.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "2025-10-hybra-finance",
  "source_finding_id": "M-06",
  "report_url": "https://code4rena.com/reports/2025-10-hybra-finance",
  "github_repo_url": "https://github.com/code-423n4/2025-10-hybra-finance",
  "contest_date": "2025-10-06",
  "vulnerability_type": "logic_error",
  "severity": "medium",
  "difficulty_tier": 2,
  "context_level": "single_file",
  "is_vulnerable": true,
  "finding_title": "ClaimFees steals staking rewards",
  "finding_description": "_claimFees() sweeps the entire balance of `token0`/`token1` after `collectFees()`, stealing rewards if `rewardToken` matches `token0` or `token1`. Impact: Bribe contract receives staking rewards instead of fees.",
  "attack_scenario": "A test deposits 10 HYBR rewards, adds 0.1 HYBR fees, and `claimFees()` sweeps all 10.1 HYBR to the bribe contract.",
  "fix_description": "Transfer only the difference in balance before/after `collectFees()`; add access control to `claimFees`. Status: Mitigation confirmed.",
  "call_flow": "collectFees() -> _claimFees() -> transfer full balance to bribe (includes rewards)",
  "context_hint": "Fee claiming sweeps all token balances, including unrelated staking rewards, to the bribe recipient.",
  "primary_file_path": "cl/contracts/GaugeCL.sol",
  "vulnerable_lines": [
    304,
    305,
    306,
    307,
    308,
    309,
    310,
    311,
    312,
    313,
    314,
    315,
    316,
    317,
    318,
    319,
    320,
    321,
    322,
    323,
    324,
    325,
    326,
    327,
    328,
    329,
    330,
    331,
    332,
    333,
    334,
    335
  ],
  "vulnerable_functions": [
    "_claimFees",
    "claimFees"
  ],
  "context_files": [],
  "has_context": false
}