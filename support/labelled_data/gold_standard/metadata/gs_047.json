{
  "id": "gs_047",
  "original_id": "gs_cantina_liminal_003",
  "source_dataset": "gold_standard",
  "vulnerability_type": "access_control_oracle",
  "severity": "medium",
  "difficulty_tier": 3,
  "context_level": "single_file",
  "is_vulnerable": true,
  "finding_title": "Critical Oracle Parameters Lack Timelock Protection",
  "finding_description": "The setPriceId and setPriceIds functions, which configure Pyth price feed IDs and their decimals, are only protected by PRICE_MANAGER_ROLE and lack timelock protection. A compromised price manager could instantly change valid price feed IDs to malicious ones or set incorrect decimals, enabling flash loan attacks and price manipulation that affects all share calculations and enables fund siphoning.",
  "vulnerable_lines": [],
  "vulnerable_functions": [],
  "has_context": false,
  "fix_description": "Apply timelock protection to setPriceId and setPriceIds functions, requiring all oracle parameter changes to be scheduled with a delay before taking effect.",
  "expert_notes": "This follows the pattern established in other Liminal functions (e.g., setFunctionDelay) where timelocks are already used. Cantina identified that oracle parameter changes should follow the same pattern. The fix involves adding onlyTimelock modifier and implementing scheduled changes rather than immediate execution.",
  "context_hint": "Timelock protection is a critical pattern for sensitive parameters in DeFi. It creates a delay window where the community can see proposed changes and react (withdraw, cancel, etc.). Oracle parameters are among the most critical because they affect all financial calculations. A compromised or malicious oracle manager can manipulate the entire protocol's price inputs.",
  "call_flow": [
    "1. PRICE_MANAGER_ROLE holder's key compromised or manager becomes malicious",
    "2. Attacker calls setPriceId(asset, newPriceId, newDecimals)",
    "3. assetPriceIds[asset] updated immediately (NO TIMELOCK)",
    "4. assetDecimals[asset] updated immediately",
    "5. Changes take effect in next block",
    "6. All price oracle queries use new (malicious) price feed",
    "7. Deposits/redemptions use inflated or deflated prices",
    "8. Share calculations compromised",
    "9. Users can be drained or diluted",
    "10. No timelock delay for detection/reaction",
    "11. Damage occurs before governance can respond"
  ]
}