{
  "id": "gs_032",
  "original_id": "gs_c4_2025-10-sequence_M02",
  "source_dataset": "gold_standard",
  "source_file": "sequence.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "",
  "source_finding_id": "M-02",
  "report_url": "https://code4rena.com/reports/2025-10-sequence",
  "github_repo_url": "https://github.com/code-423n4/2025-10-sequence",
  "contest_date": "2025-10-07",
  "vulnerability_type": "dos",
  "severity": "medium",
  "difficulty_tier": 2,
  "context_level": "multi_file",
  "is_vulnerable": true,
  "finding_title": "Static signatures bound to caller revert under ERC-4337, causing DoS",
  "finding_description": "In ERC-4337, validateUserOp uses external self-call to isValidSignature, changing msg.sender to wallet instead of entrypoint. BaseAuth.signatureValidation enforces caller binding, causing revert for static signatures bound to entrypoint.",
  "attack_scenario": "Deploy wallet with static signature bound to entrypoint. Attempt validateUserOp \u2192 reverts with InvalidStaticSignatureWrongCaller. PoC: Add test to test/modules/ERC4337v07.t.sol: test_validateUserOp_staticSig_callerMismatch_reverts. Uses server and forge test.",
  "fix_description": "Avoid external self-call; propagate intended caller into validation.",
  "call_flow": "EntryPoint.validateUserOp() -> Wallet.self-call isValidSignature() -> msg.sender = wallet -> BaseAuth check fails for entrypoint-bound sig",
  "context_hint": "ERC-4337 validation changes msg.sender via self-call, breaking static signatures bound to the original caller (EntryPoint).",
  "primary_file_path": "src/modules/ERC4337v07.sol",
  "vulnerable_lines": [
    30,
    31,
    32,
    33,
    34,
    35,
    36,
    37,
    38,
    39,
    40,
    41,
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    49,
    50,
    51,
    52,
    53,
    54
  ],
  "vulnerable_functions": [
    "validateUserOp"
  ],
  "context_files": [
    {
      "filename": "context_01_BaseAuth.sol",
      "original_path": "src/modules/auth/BaseAuth.sol",
      "relevance": "BaseAuth enforces strict caller check incompatible with ERC-4337 self-call."
    }
  ],
  "has_context": true
}