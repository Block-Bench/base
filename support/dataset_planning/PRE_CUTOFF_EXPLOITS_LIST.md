# Pre-Cutoff Famous Exploits - Extraction List

**Target:** 25-30 pre-cutoff originals  
**Criteria:** Well-documented, high-profile, definitely in training data  
**Date Range:** 2017-2023 (before Sept 2024 cutoffs)

---

## Top 30 Exploits to Extract

### Priority 1: Mega Hacks (>\$100M, Extremely Famous)

| #   | Exploit           | Date    | Loss   | Type                       | File Location                  | Status        |
| --- | ----------------- | ------- | ------ | -------------------------- | ------------------------------ | ------------- |
| 1   | **Euler Finance** | 2023-03 | \$197M | Donation attack            | ✅ 2023-03/Euler_exp.sol       | ✅ Done (POC) |
| 2   | **Nomad Bridge**  | 2022-08 | \$190M | Message validation         | ✅ 2022-08/NomadBridge_exp.sol | ⏳ Pending    |
| 3   | **Beanstalk**     | 2022-04 | \$182M | Governance flash loan      | ✅ 2022-04/Beanstalk_exp.sol   | ⏳ Pending    |
| 4   | **Cream Finance** | 2021-10 | \$130M | Flash loan + oracle        | ✅ 2021-10/Cream_2_exp.sol     | ⏳ Pending    |
| 5   | **Poly Network**  | 2021-08 | \$611M | Cross-chain access control | ✅ 2021-08/PolyNetwork_exp.sol | ⏳ Pending    |
| 6   | **Ronin Bridge**  | 2022-03 | \$625M | Multi-sig compromise       | ✅ 2022-03/Ronin_exp.sol       | ⏳ Pending    |

### Priority 2: Major Hacks ($20M-$100M, Very Famous)

| #   | Exploit             | Date    | Loss     | Type                          | File Location                      | Status     |
| --- | ------------------- | ------- | -------- | ----------------------------- | ---------------------------------- | ---------- |
| 7   | **Curve Finance**   | 2023-07 | \$70M    | Vyper reentrancy              | ✅ 2023-07/Curve_exp01.sol         | ⏳ Pending |
| 8   | **Harvest Finance** | 2020-10 | \$24M    | Flash loan price manipulation | ✅ 2020-10/HarvestFinance_exp.sol  | ⏳ Pending |
| 9   | **Platypus**        | 2023-02 | \$8.5M   | Flash loan                    | ✅ 2023-02/Platypus_exp.sol        | ⏳ Pending |
| 10  | **Hundred Finance** | 2022-03 | \$6M     | Price oracle manipulation     | ✅ 2022-03/HundredFinance_exp.sol  | ⏳ Pending |
| 11  | **Parity Wallet**   | 2017-11 | \$150M   | delegatecall + selfdestruct   | ✅ 2017-11/Parity_kill_exp.sol     | ⏳ Pending |
| 12  | **bZx**             | 2023-12 | Variable | Flash loan                    | ✅ 2023-12/bZx_exp.sol             | ⏳ Pending |
| 13  | **KyberSwap**       | 2023-11 | \$47M    | Liquidity calculation         | ✅ 2023-11/KyberSwap_exp.eth.1.sol | ⏳ Pending |
| 14  | **Rari Capital**    | 2022-04 | \$80M    | Reentrancy                    | ✅ 2022-04/Rari_exp.sol            | ⏳ Pending |

### Priority 3: Medium Hacks ($5M-$20M, Well-Known)

| #   | Exploit             | Date    | Loss   | Type            | File Location                     | Status     |
| --- | ------------------- | ------- | ------ | --------------- | --------------------------------- | ---------- |
| 15  | **Inverse Finance** | 2022-06 | \$5.8M | Price oracle    | ✅ 2022-06/InverseFinance_exp.sol | ⏳ Pending |
| 16  | **Agave**           | 2022-03 | \$11M  | Reentrancy      | ✅ 2022-03/Agave_exp.sol          | ⏳ Pending |
| 17  | **Transit Swap**    | 2022-10 | \$21M  | Arbitrary call  | ✅ 2022-10/TransitSwap_exp.sol    | ⏳ Pending |
| 18  | **Aku tar NFT**     | 2022-04 | \$34M  | Refund logic    | ✅ 2022-04/AkutarNFT_exp.sol      | ⏳ Pending |
| 19  | **BonqDAO**         | 2023-02 | \$11M  | Price oracle    | ✅ 2023-02/BonqDAO_exp.sol        | ⏳ Pending |
| 20  | **Saddle Finance**  | 2022-04 | \$10M  | Reentrancy      | ✅ 2022-04/Saddle_exp.sol         | ⏳ Pending |
| 21  | **Yearn Finance**   | 2023-04 | \$11M  | Vault logic     | ✅ 2023-04/YearnFinance_exp.sol   | ⏳ Pending |
| 22  | **Team Finance**    | 2022-10 | \$14M  | Migration logic | ✅ 2022-10/TeamFinance_exp.sol    | ⏳ Pending |

### Priority 4: Important Smaller Hacks (<\$5M but Significant Patterns)

| #   | Exploit          | Date    | Loss   | Type                | File Location                  | Status     |
| --- | ---------------- | ------- | ------ | ------------------- | ------------------------------ | ---------- |
| 23  | **Audius**       | 2022-07 | \$6M   | Governance attack   | ✅ 2022-07/Audius_exp.sol      | ⏳ Pending |
| 24  | **Qubit Bridge** | 2022-01 | \$80M  | Bridge validation   | ✅ 2022-01/Qubit_exp.sol       | ⏳ Pending |
| 25  | **Treasure DAO** | 2022-03 | \$1.4M | Arbitrary call      | ✅ 2022-03/TreasureDAO_exp.sol | ⏳ Pending |
| 26  | **dForce**       | 2023-02 | \$3.6M | Reentrancy          | ✅ 2023-02/dForce_exp.sol      | ⏳ Pending |
| 27  | **Revest**       | 2022-03 | \$2M   | Reentrancy          | ✅ 2022-03/Revest_exp.sol      | ⏳ Pending |
| 28  | **Optimism**     | 2022-06 | N/A    | Mint vulnerability  | ✅ 2022-06/Optimism_exp.sol    | ⏳ Pending |
| 29  | **Sentiment**    | 2023-04 | \$1M   | Oracle manipulation | ✅ 2023-04/Sentiment_exp.sol   | ⏳ Pending |
| 30  | **0vix**         | 2023-04 | \$6.5M | Price oracle        | ✅ 2023-04/0vix_exp.sol        | ⏳ Pending |

---

## Vulnerability Type Distribution

| Type                          | Count | Examples                                         |
| ----------------------------- | ----- | ------------------------------------------------ |
| **Oracle/Price Manipulation** | 8     | Hundred, Inverse, BonqDAO, 0vix, Sentiment, etc. |
| **Flash Loan**                | 6     | Beanstalk, Cream, Harvest, Platypus, bZx, etc.   |
| **Reentrancy**                | 5     | Curve, Rari, Agave, Saddle, dForce, Revest       |
| **Access Control/Validation** | 4     | Poly, Nomad, Ronin, Qubit                        |
| **Donation Attack**           | 1     | Euler                                            |
| **Governance**                | 2     | Beanstalk, Audius                                |
| **Logic Errors**              | 4     | Parity, Treasure, Akutar, Team Finance           |

**Good distribution!** Covers major vulnerability classes.

---

## Temporal Distribution

| Year | Count | Range                         |
| ---- | ----- | ----------------------------- |
| 2017 | 1     | Parity                        |
| 2020 | 1     | Harvest                       |
| 2021 | 3     | Poly, Cream (2x)              |
| 2022 | 14    | Nomad, Ronin, Beanstalk, etc. |
| 2023 | 11    | Euler, Curve, KyberSwap, etc. |

**Peak:** 2022-2023 (likely most discussed in training data)

---

## Processing Strategy

### Phase 1: High-Priority Extraction (10 exploits, ~4-5 hours)

Extract Priority 1 + select Priority 2 exploits:

1. Euler ✅
2. Nomad Bridge
3. Beanstalk
4. Cream Finance
5. Poly Network
6. Ronin Bridge
7. Curve Finance
8. Harvest Finance
9. Parity Wallet
10. KyberSwap

**Why these:** All >\$50M or historically significant patterns

### Phase 2: Medium-Priority (10 exploits, ~3-4 hours)

11. Platypus
12. Hundred Finance
13. bZx
14. Rari Capital
15. Inverse Finance
16. Agave
17. Transit Swap
18. Akutar NFT
19. BonqDAO
20. Saddle Finance

### Phase 3: Complete the Set (10 exploits, ~3-4 hours)

21. Yearn Finance
22. Team Finance
23. Audius
24. Qubit Bridge
25. Treasure DAO
26. dForce
27. Revest
28. Optimism
29. Sentiment
30. 0vix

---

## Extraction Approach

### For Each Exploit:

1. **Read the PoC file** (e.g., `Euler_exp.sol`)
2. **Extract metadata** from comments:
   - Date (from folder or comments)
   - Amount lost (from comments)
   - Vulnerability type (from summary)
3. **Identify vulnerable contract pattern**:
   - PoCs use interfaces - extract the vulnerable interface/contract
   - Look for the actual vulnerability code
   - Create simplified vulnerable contract version
4. **Create JSON entry** with all fields
5. **Validate** difficulty tier and severity

### Automation Strategy:

Create `process_defihacklabs_famous.py` that:

- Takes a curated list of exploit files
- Extracts comments/metadata automatically
- Prompts for manual input where needed (vulnerable lines, function names)
- Outputs standardized JSON

---

## Expected Output

```
dataset/processed/temporal_contamination/
├── pre_cutoff_originals/
│   ├── euler.json
│   ├── nomad_bridge.json
│   ├── beanstalk.json
│   ├── ... (27 more)
│   └── all_originals.json (consolidated)
└── metadata/
    └── extraction_log.json (processing notes)
```

**Total:** 30 pre-cutoff original exploits  
**Next:** Create variants later (60 more samples)

---

## Quality Checks Per Exploit

Before marking as "complete":

- [ ] Date verified from multiple sources
- [ ] Amount lost confirmed
- [ ] Vulnerability type accurate
- [ ] Vulnerable contract code extracted (not just PoC test)
- [ ] Vulnerable function identified
- [ ] Approximate vulnerable lines noted
- [ ] Attack vector documented
- [ ] Difficulty tier assigned (3-4 for famous exploits)
- [ ] Source URLs included

---

## Timeline Estimate

| Phase     | Exploits            | Time            | Cumulative     |
| --------- | ------------------- | --------------- | -------------- |
| Phase 1   | 10 high-priority    | 4-5 hours       | 10 done        |
| Phase 2   | 10 medium-priority  | 3-4 hours       | 20 done        |
| Phase 3   | 10 complete the set | 3-4 hours       | 30 done        |
| **TOTAL** | **30 originals**    | **10-13 hours** | **30 samples** |

**With variants later:** 30 × 3 variants = 90 total samples from pre-cutoff!

---

## Next Immediate Step

Create automated processing script to:

1. Read PoC files
2. Extract metadata from comments
3. Generate JSON entries
4. Batch process all 30 exploits

**Ready to proceed?**
