{
  "id": "ch_medical_nc_tc_021",
  "contract_file": "contracts/ch_medical_nc_tc_021.sol",
  "subset": "chameleon_medical",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": {
        "name": "DODOPool",
        "functions": [
          {
            "name": "init",
            "vulnerability": "Missing initialization guard allowing multiple calls to hijack maintainer role"
          },
          {
            "name": "claimFees",
            "vulnerability": "Only checks msg.sender == maintainer, but maintainer can be changed via reinitialization"
          }
        ]
      },
      "function_name": null,
      "line_numbers": []
    },
    "root_cause": "The init() function lacked proper initialization protection (missing `require(!isInitialized)` check). This allowed attackers to call the initialization function again after deployment, overwriting critical parameters like the maintainer address and hijacking fee collection rights.",
    "attack_vector": "1) Attacker identified DODO pool contracts without proper initialization locks. 2) Called init() with attacker-controlled parameters, setting maintainer address to attacker. 3) Since maintainer receives all swap fees, attacker could claim accumulated fees via claimFees(). 4) All future swap fees also redirected to attacker. 5) In some cases, could manipulate baseBalance/quoteBalance for profitable swaps. 6) Drained $3.8M from affected pools.",
    "impact": "Funds lost: $3,800,000",
    "correct_fix": null
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2021-03-09",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 104,
    "num_contracts": 1,
    "contract_names": [
      "LiquidityPool"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "initialization",
    "access_control",
    "dodo",
    "defi",
    "amm",
    "maintainer_hijack"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2021-03-09",
      "protocol_name": "DODO Reinitialization",
      "chain": "ethereum",
      "funds_lost_usd": 3800000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": false,
      "likely_in_training": true,
      "exposure_notes": "Famous DODO Reinitialization exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_021.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_021.json",
    "original_exploit_name": "DODO Reinitialization"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_021.sol",
  "sanitized_from": "tc_021",
  "derived_from": "sn_tc_021",
  "original_id": "tc_021",
  "transformation": {
    "strategy": "chameleon",
    "theme": "medical",
    "source": "nocomments",
    "seed": 2708622616,
    "coverage": {
      "total_identifiers": 40,
      "transformed": 31,
      "untransformed": 9,
      "skipped_reserved": 24,
      "skipped_interface": 0,
      "coverage_percent": 77.5,
      "untransformed_details": [
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "maintainer",
          "reason": "no synonym found"
        },
        {
          "name": "quote",
          "reason": "no synonym found"
        },
        {
          "name": "init",
          "reason": "no synonym found"
        },
        {
          "name": "_maintainer",
          "reason": "no synonym found"
        },
        {
          "name": "Not",
          "reason": "no synonym found"
        },
        {
          "name": "Invalid",
          "reason": "no synonym found"
        },
        {
          "name": "Only",
          "reason": "no synonym found"
        },
        {
          "name": "excess",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": true
    },
    "rename_map": {
      "account": "chart",
      "amount": "quantity",
      "from": "referrer",
      "LiquidityPool": "AvailabilityPool",
      "baseToken": "baseCredential",
      "quoteToken": "quoteCredential",
      "lpFeeRate": "lpPremiumRatio",
      "baseBalance": "baseCoverage",
      "quoteBalance": "quoteCredits",
      "isInitialized": "validateInitialized",
      "Initialized": "PatientAdmitted",
      "base": "careBase",
      "_baseToken": "_baseCredential",
      "_quoteToken": "_quoteBadge",
      "_lpFeeRate": "_lpPremiumFactor",
      "addLiquidity": "attachResources",
      "baseAmount": "baseDosage",
      "quoteAmount": "quoteDosage",
      "initialized": "patientAdmitted",
      "sender": "provider",
      "swap": "exchangeMedication",
      "fromToken": "referrerBadge",
      "toToken": "receiverBadge",
      "fromAmount": "sourceMeasure",
      "toAmount": "receiverDosage",
      "token": "badge",
      "pair": "duo",
      "fee": "premium",
      "claimFees": "getcareFees",
      "baseTokenBalance": "baseCredentialCredits",
      "quoteTokenBalance": "quoteIdCoverage"
    }
  }
}