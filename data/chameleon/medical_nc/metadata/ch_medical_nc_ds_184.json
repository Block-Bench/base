{
  "id": "ch_medical_nc_ds_184",
  "contract_file": "contracts/ch_medical_nc_ds_184.sol",
  "subset": "chameleon_medical",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "other",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "This vulnerability is associated with the approval process in ERC20 tokens. \nIn this scenario, Alice approves Eve to transfer an unlimited (type(uint256).max) amount of tokens \nfrom Alice's account. Later, Eve exploits this permission and transfers 1000 tokens from Alice's account to hers.\n\nMost current scams use approve or setApprovalForAll to defraud your transfer rights. Be especially careful with this part.",
    "attack_vector": "This vulnerability is associated with the approval process in ERC20 tokens. \nIn this scenario, Alice approves Eve to transfer an unlimited (type(uint256).max) amount of tokens \nfrom Alice's account. Later, Eve exploits this permission and transfers 1000 tokens from Alice's account to hers.\n\nMost current scams use approve or setApprovalForAll to defraud your transfer rights. Be especially careful with this part.",
    "impact": "Severity: medium",
    "correct_fix": "Users should only approve the amount of tokens necessary for the operation at hand."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_approvescam",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 112,
    "num_contracts": 2,
    "contract_names": [
      "ContractTest",
      "ERC20"
    ],
    "num_functions": 12,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_3_hard",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 3,
    "difficulty_tier_name": "subtle_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "This vulnerability is associated with the approval process in ERC20 tokens. \nIn this scenario, Alice approves Eve to transfer an unlimited (type(uint256).max) amount of tokens \nfrom Alice's account. Later, Eve exploits this permission and transfers 1000 tokens from Alice's account to hers.\n\nMost current scams use approve or setApprovalForAll to defraud your transfer rights. Be especially careful with this part.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_184.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_184.json",
    "original_id": "defivulnlabs_approvescam"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_184.sol",
  "sanitized_from": "ds_184",
  "derived_from": "sn_ds_184",
  "original_id": "ds_184",
  "transformation": {
    "strategy": "chameleon",
    "theme": "medical",
    "source": "nocomments",
    "seed": 3435093772,
    "coverage": {
      "total_identifiers": 40,
      "transformed": 15,
      "untransformed": 25,
      "skipped_reserved": 40,
      "skipped_interface": 0,
      "coverage_percent": 37.5,
      "untransformed_details": [
        {
          "name": "forge",
          "reason": "no synonym found"
        },
        {
          "name": "std",
          "reason": "no synonym found"
        },
        {
          "name": "Test",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "ERC20",
          "reason": "no synonym found"
        },
        {
          "name": "alice",
          "reason": "no synonym found"
        },
        {
          "name": "addr",
          "reason": "no synonym found"
        },
        {
          "name": "eve",
          "reason": "no synonym found"
        },
        {
          "name": "prank",
          "reason": "no synonym found"
        },
        {
          "name": "console",
          "reason": "no synonym found"
        },
        {
          "name": "Before",
          "reason": "no synonym found"
        },
        {
          "name": "operation",
          "reason": "no synonym found"
        },
        {
          "name": "Due",
          "reason": "no synonym found"
        },
        {
          "name": "Alice",
          "reason": "no synonym found"
        },
        {
          "name": "granted",
          "reason": "no synonym found"
        },
        {
          "name": "permission",
          "reason": "no synonym found"
        },
        {
          "name": "Eve",
          "reason": "no synonym found"
        },
        {
          "name": "can",
          "reason": "no synonym found"
        },
        {
          "name": "move",
          "reason": "no synonym found"
        },
        {
          "name": "funds",
          "reason": "no synonym found"
        },
        {
          "name": "After",
          "reason": "no synonym found"
        },
        {
          "name": "operate",
          "reason": "no synonym found"
        },
        {
          "name": "completed",
          "reason": "no synonym found"
        },
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "example",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "ContractTest": "AgreementTest",
      "ERC20Contract": "Erc20Agreement",
      "testApproveScam": "testAuthorizecaregiverScam",
      "mint": "createPrescription",
      "max": "ceiling",
      "log": "record",
      "from": "referrer",
      "account": "chart",
      "recipient": "patient",
      "amount": "measure",
      "spender": "payer",
      "sender": "provider",
      "value": "evaluation",
      "Approval": "AccessGranted",
      "burn": "archiveRecord"
    }
  }
}