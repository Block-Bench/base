{
  "id": "ch_gaming_sn_gs_007",
  "contract_file": "contracts/ch_gaming_sn_gs_007.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GaugeCL",
      "function_name": "_claimFees",
      "line_numbers": [
        304,
        305,
        306,
        307,
        308,
        309,
        310,
        311,
        312,
        313,
        314,
        315,
        316,
        317,
        318,
        319,
        320,
        321,
        322,
        323,
        324,
        325,
        326,
        327,
        328,
        329,
        330,
        331,
        332,
        333,
        334,
        335
      ]
    },
    "root_cause": "_claimFees() sweeps the entire balance of `token0`/`token1` after `collectFees()`, stealing rewards if `rewardToken` matches `token0` or `token1`. Impact: Bribe contract receives staking rewards instead of fees.",
    "attack_vector": "A test deposits 10 HYBR rewards, adds 0.1 HYBR fees, and `claimFees()` sweeps all 10.1 HYBR to the bribe contract.",
    "impact": "Severity: medium",
    "correct_fix": "Transfer only the difference in balance before/after `collectFees()`; add access control to `claimFees`. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M06",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 372,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Fee claiming sweeps all token balances, including unrelated staking rewards, to the bribe recipient.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-06",
    "finding_title": "ClaimFees steals staking rewards",
    "difficulty_tier": 2,
    "context_level": "single_file",
    "has_context": false,
    "call_flow": "collectFees() -> _claimFees() -> transfer full balance to bribe (includes rewards)"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_007.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_007.json",
    "original_finding_title": "ClaimFees steals staking rewards"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_007.sol",
  "sanitized_from": "gs_007",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 2167724758,
    "coverage": {
      "total_identifiers": 269,
      "transformed": 127,
      "untransformed": 142,
      "skipped_reserved": 62,
      "skipped_interface": 0,
      "coverage_percent": 47.21,
      "untransformed_details": [
        {
          "name": "openzeppelin",
          "reason": "no synonym found"
        },
        {
          "name": "contracts",
          "reason": "no synonym found"
        },
        {
          "name": "security",
          "reason": "no synonym found"
        },
        {
          "name": "ReentrancyGuard",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "access",
          "reason": "no synonym found"
        },
        {
          "name": "Ownable",
          "reason": "no synonym found"
        },
        {
          "name": "ERC20",
          "reason": "no synonym found"
        },
        {
          "name": "SafeERC20",
          "reason": "no synonym found"
        },
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "structs",
          "reason": "no synonym found"
        },
        {
          "name": "ERC721",
          "reason": "no synonym found"
        },
        {
          "name": "math",
          "reason": "no synonym found"
        },
        {
          "name": "SafeCast",
          "reason": "no synonym found"
        },
        {
          "name": "interfaces",
          "reason": "no synonym found"
        },
        {
          "name": "IGaugeFactoryCL",
          "reason": "no synonym found"
        },
        {
          "name": "ICLPool",
          "reason": "no synonym found"
        },
        {
          "name": "ICLFactory",
          "reason": "no synonym found"
        },
        {
          "name": "IBribe",
          "reason": "no synonym found"
        },
        {
          "name": "IRHYBR",
          "reason": "no synonym found"
        },
        {
          "name": "libraries",
          "reason": "no synonym found"
        },
        {
          "name": "FullMath",
          "reason": "no synonym found"
        },
        {
          "name": "FixedPoint128",
          "reason": "no synonym found"
        },
        {
          "name": "GaugeCL",
          "reason": "no synonym found"
        },
        {
          "name": "rHYBR",
          "reason": "no synonym found"
        },
        {
          "name": "DISTRIBUTION",
          "reason": "no synonym found"
        },
        {
          "name": "internal_bribe",
          "reason": "no synonym found"
        },
        {
          "name": "external_bribe",
          "reason": "no synonym found"
        },
        {
          "name": "clPool",
          "reason": "no synonym found"
        },
        {
          "name": "_stakes",
          "reason": "no synonym found"
        },
        {
          "name": "rewards",
          "reason": "no synonym found"
        },
        {
          "name": "claimed0",
          "reason": "no synonym found"
        },
        {
          "name": "claimed1",
          "reason": "no synonym found"
        },
        {
          "name": "gauge",
          "reason": "no synonym found"
        },
        {
          "name": "_rHYBR",
          "reason": "no synonym found"
        },
        {
          "name": "_ve",
          "reason": "no synonym found"
        },
        {
          "name": "_pool",
          "reason": "no synonym found"
        },
        {
          "name": "_distribution",
          "reason": "no synonym found"
        },
        {
          "name": "_internal_bribe",
          "reason": "no synonym found"
        },
        {
          "name": "_external_bribe",
          "reason": "no synonym found"
        },
        {
          "name": "nfpm",
          "reason": "no synonym found"
        },
        {
          "name": "_factory",
          "reason": "no synonym found"
        },
        {
          "name": "main",
          "reason": "no synonym found"
        },
        {
          "name": "vested",
          "reason": "no synonym found"
        },
        {
          "name": "distro",
          "reason": "no synonym found"
        },
        {
          "name": "WEEK",
          "reason": "no synonym found"
        },
        {
          "name": "fees",
          "reason": "no synonym found"
        },
        {
          "name": "goes",
          "reason": "no synonym found"
        },
        {
          "name": "here",
          "reason": "no synonym found"
        },
        {
          "name": "bribe",
          "reason": "no synonym found"
        },
        {
          "name": "onlyDistribution",
          "reason": "no synonym found"
        },
        {
          "name": "not",
          "reason": "no synonym found"
        },
        {
          "name": "RewardsDistribution",
          "reason": "no synonym found"
        },
        {
          "name": "tickLower",
          "reason": "no synonym found"
        },
        {
          "name": "tickUpper",
          "reason": "no synonym found"
        },
        {
          "name": "_earned",
          "reason": "no synonym found"
        },
        {
          "name": "positions",
          "reason": "no synonym found"
        },
        {
          "name": "token0",
          "reason": "no synonym found"
        },
        {
          "name": "token1",
          "reason": "no synonym found"
        },
        {
          "name": "tickSpacing",
          "reason": "no synonym found"
        },
        {
          "name": "contains",
          "reason": "no synonym found"
        },
        {
          "name": "mulDiv",
          "reason": "no synonym found"
        },
        {
          "name": "Q128",
          "reason": "no synonym found"
        },
        {
          "name": "claimable",
          "reason": "no synonym found"
        },
        {
          "name": "Gauge",
          "reason": "no synonym found"
        },
        {
          "name": "zero",
          "reason": "no synonym found"
        },
        {
          "name": "parameters",
          "reason": "no synonym found"
        },
        {
          "name": "positionPool",
          "reason": "no synonym found"
        },
        {
          "name": "that",
          "reason": "no synonym found"
        },
        {
          "name": "the",
          "reason": "no synonym found"
        },
        {
          "name": "matches",
          "reason": "no synonym found"
        },
        {
          "name": "mismatch",
          "reason": "no synonym found"
        },
        {
          "name": "collect",
          "reason": "no synonym found"
        },
        {
          "name": "trigger",
          "reason": "no synonym found"
        },
        {
          "name": "staked",
          "reason": "no synonym found"
        },
        {
          "name": "will",
          "reason": "no synonym found"
        },
        {
          "name": "with",
          "reason": "no synonym found"
        },
        {
          "name": "only",
          "reason": "no synonym found"
        },
        {
          "name": "has",
          "reason": "no synonym found"
        },
        {
          "name": "existing",
          "reason": "no synonym found"
        },
        {
          "name": "all",
          "reason": "no synonym found"
        },
        {
          "name": "removed",
          "reason": "no synonym found"
        },
        {
          "name": "already",
          "reason": "no synonym found"
        },
        {
          "name": "via",
          "reason": "no synonym found"
        },
        {
          "name": "Invalid",
          "reason": "no synonym found"
        },
        {
          "name": "global",
          "reason": "no synonym found"
        },
        {
          "name": "growth",
          "reason": "no synonym found"
        },
        {
          "name": "before",
          "reason": "no synonym found"
        },
        {
          "name": "processing",
          "reason": "no synonym found"
        },
        {
          "name": "remaining",
          "reason": "no synonym found"
        },
        {
          "name": "until",
          "reason": "no synonym found"
        },
        {
          "name": "begins",
          "reason": "no synonym found"
        },
        {
          "name": "Include",
          "reason": "no synonym found"
        },
        {
          "name": "any",
          "reason": "no synonym found"
        },
        {
          "name": "rolled",
          "reason": "no synonym found"
        },
        {
          "name": "over",
          "reason": "no synonym found"
        },
        {
          "name": "rollover",
          "reason": "no synonym found"
        },
        {
          "name": "are",
          "reason": "no synonym found"
        },
        {
          "name": "starting",
          "reason": "no synonym found"
        },
        {
          "name": "continuing",
          "reason": "no synonym found"
        },
        {
          "name": "one",
          "reason": "no synonym found"
        },
        {
          "name": "distribute",
          "reason": "no synonym found"
        },
        {
          "name": "Existing",
          "reason": "no synonym found"
        },
        {
          "name": "distribution",
          "reason": "no synonym found"
        },
        {
          "name": "Store",
          "reason": "no synonym found"
        },
        {
          "name": "tracking",
          "reason": "no synonym found"
        },
        {
          "name": "distributor",
          "reason": "no synonym found"
        },
        {
          "name": "sufficient",
          "reason": "no synonym found"
        },
        {
          "name": "support",
          "reason": "no synonym found"
        },
        {
          "name": "Insufficient",
          "reason": "no synonym found"
        },
        {
          "name": "finish",
          "reason": "no synonym found"
        },
        {
          "name": "and",
          "reason": "no synonym found"
        },
        {
          "name": "gaugeFees",
          "reason": "no synonym found"
        },
        {
          "name": "collectFees",
          "reason": "no synonym found"
        },
        {
          "name": "_token0",
          "reason": "no synonym found"
        },
        {
          "name": "_token1",
          "reason": "no synonym found"
        },
        {
          "name": "Fetch",
          "reason": "no synonym found"
        },
        {
          "name": "whole",
          "reason": "no synonym found"
        },
        {
          "name": "which",
          "reason": "no synonym found"
        },
        {
          "name": "just",
          "reason": "no synonym found"
        },
        {
          "name": "eneded",
          "reason": "no synonym found"
        },
        {
          "name": "Bribe",
          "reason": "no synonym found"
        },
        {
          "name": "_fees0",
          "reason": "no synonym found"
        },
        {
          "name": "_fees1",
          "reason": "no synonym found"
        },
        {
          "name": "notice",
          "reason": "no synonym found"
        },
        {
          "name": "where",
          "reason": "no synonym found"
        },
        {
          "name": "_int",
          "reason": "no synonym found"
        },
        {
          "name": "dev",
          "reason": "no synonym found"
        },
        {
          "name": "Handle",
          "reason": "no synonym found"
        },
        {
          "name": "receipt",
          "reason": "no synonym found"
        },
        {
          "name": "param",
          "reason": "no synonym found"
        },
        {
          "name": "The",
          "reason": "no synonym found"
        },
        {
          "name": "called",
          "reason": "no synonym found"
        },
        {
          "name": "previously",
          "reason": "no synonym found"
        },
        {
          "name": "owned",
          "reason": "no synonym found"
        },
        {
          "name": "identifier",
          "reason": "no synonym found"
        },
        {
          "name": "being",
          "reason": "no synonym found"
        },
        {
          "name": "transferred",
          "reason": "no synonym found"
        },
        {
          "name": "Additional",
          "reason": "no synonym found"
        },
        {
          "name": "specified",
          "reason": "no synonym found"
        },
        {
          "name": "format",
          "reason": "no synonym found"
        },
        {
          "name": "onERC721Received",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "token": "gem",
      "utils": "gameUtils",
      "EnumerableSet": "EnumerableGroup",
      "IERC721Receiver": "Ierc721Recipient",
      "IGaugeManager": "IGaugeHandler",
      "INonfungiblePositionManager": "INonfungiblePositionController",
      "HybraTimeLibrary": "HybraInstantLibrary",
      "from": "source",
      "UintSet": "CountGroup",
      "rewardToken": "prizeCrystal",
      "DURATION": "AdventurePeriod",
      "_periodFinish": "_durationFinish",
      "rewardRate": "payoutRatio",
      "poolAddress": "poolRealm",
      "nonfungiblePositionManager": "nonfungiblePositionHandler",
      "emergency": "critical",
      "isForPair": "isForDuo",
      "factory": "heroFactory",
      "rewardRateByEpoch": "payoutFactorByEra",
      "epoch": "era",
      "reward": "bounty",
      "rate": "ratio",
      "rewardGrowthInside": "payoutGrowthInside",
      "lastUpdateTime": "endingSyncprogressInstant",
      "RewardAdded": "BonusAdded",
      "Deposit": "CachePrize",
      "user": "character",
      "amount": "count",
      "Withdraw": "ObtainPrize",
      "Harvest": "FarmBounty",
      "ClaimFees": "ObtainrewardFees",
      "EmergencyActivated": "UrgentActivated",
      "timestamp": "adventureTime",
      "EmergencyDeactivated": "UrgentDeactivated",
      "_rewardToken": "_treasureCrystal",
      "_isForPair": "_isForDuo",
      "GaugeManager": "GaugeHandler",
      "sender": "caster",
      "Caller": "Summoner",
      "isNotEmergency": "isNotUrgent",
      "_updateRewards": "_updatelevelRewards",
      "tokenId": "medalIdentifier",
      "updateRewardsGrowthGlobal": "refreshstatsRewardsGrowthGlobal",
      "getRewardGrowthInside": "obtainBountyGrowthInside",
      "activateEmergencyMode": "activateUrgentMode",
      "stopEmergencyMode": "stopCriticalMode",
      "liquidity": "reserves",
      "_getPoolAddress": "_fetchPoolLocation",
      "getPool": "obtainPool",
      "earned": "accumulated",
      "bonsReward": "bonsBounty",
      "lastUpdated": "endingUpdated",
      "timeDelta": "instantDelta",
      "rewardGrowthGlobalX128": "treasureGrowthGlobalX128",
      "rewardReserve": "payoutReserve",
      "stakedLiquidity": "stakedFlow",
      "rewardPerTokenInsideInitialX128": "payoutPerMedalInsideInitialX128",
      "rewardPerTokenInsideX128": "payoutPerCoinInsideX128",
      "deposit": "cachePrize",
      "nonReentrant": "singleEntry",
      "Calculate": "Derive",
      "pool": "jackpotPool",
      "position": "coordinates",
      "Verify": "Validate",
      "Pool": "RewardPool",
      "Position": "Location",
      "CollectParams": "CollectSettings",
      "recipient": "target",
      "amount0Max": "amount0Ceiling",
      "max": "maximum",
      "amount1Max": "amount1Maximum",
      "stake": "lockEnergy",
      "rewardGrowth": "treasureGrowth",
      "add": "insert",
      "withdraw": "extractWinnings",
      "redeemType": "convertprizeType",
      "update": "syncProgress",
      "NFT": "Relic",
      "sync": "synchronize",
      "liquidityToStake": "reservesTargetPledge",
      "_getReward": "_obtainTreasure",
      "decreaseStakedLiquidity": "decreaseStakedReserves",
      "remove": "drop",
      "getReward": "obtainBounty",
      "account": "profile",
      "rewardAmount": "treasureCount",
      "safeApprove": "safePermitaccess",
      "depostionEmissionsToken": "depostionEmissionsCoin",
      "redeemFor": "exchangetokensFor",
      "notifyRewardAmount": "notifyBonusTotal",
      "currentRate": "activeRatio",
      "Update": "UpdateLevel",
      "time": "instant",
      "next": "upcoming",
      "epochTimeRemaining": "ageInstantRemaining",
      "epochNext": "eraFollowing",
      "epochEndTimestamp": "ageCloseQuesttime",
      "previous": "last",
      "period": "duration",
      "totalRewardAmount": "combinedPrizeCount",
      "Check": "Verify",
      "syncReward": "alignPrize",
      "periodFinish": "durationFinish",
      "pending": "waiting",
      "pendingRewards": "queuedRewards",
      "current": "present",
      "epochStart": "eraOpening",
      "tokens": "coins",
      "calculated": "computed",
      "contractBalance": "agreementPrizecount",
      "gaugeBalances": "gaugeHerotreasure",
      "claimFees": "collectbountyFees",
      "_claimFees": "_receiveprizeFees",
      "fee": "tax",
      "get": "obtain",
      "total": "full",
      "duration": "missionTime",
      "rewardForDuration": "bonusForMissiontime",
      "set": "configure",
      "setInternalBribe": "groupInternalBribe",
      "_safeTransfer": "_safeMovetreasure",
      "value": "magnitude",
      "length": "size",
      "success": "victory",
      "data": "details",
      "selector": "picker",
      "operator": "questRunner"
    }
  }
}