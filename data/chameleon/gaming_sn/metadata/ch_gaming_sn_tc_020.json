{
  "id": "ch_gaming_sn_tc_020",
  "contract_file": "contracts/ch_gaming_sn_tc_020.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "oracle_manipulation",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": {
        "name": "WarpVault",
        "functions": [
          {
            "name": "getLPTokenValue",
            "vulnerability": "Uses instantaneous pool reserves to calculate LP token value, vulnerable to flash loan manipulation"
          },
          {
            "name": "borrow",
            "vulnerability": "Relies on manipulatable LP token valuation to determine borrowing capacity"
          }
        ]
      },
      "function_name": null,
      "line_numbers": []
    },
    "root_cause": "LP token value was calculated directly from current Uniswap pool reserves without using time-weighted average prices (TWAP) or external oracles. Flash loan attackers could temporarily manipulate pool reserves within a single transaction, inflating the perceived value of LP tokens and overborrowing against them.",
    "attack_vector": "1) Flash loan 5M DAI. 2) Swap DAI -> ETH in Uniswap pool, heavily imbalancing reserves (6M DAI, 100 ETH). 3) LP token value calculation uses manipulated reserves, showing inflated value. 4) Deposit LP tokens as collateral in Warp Finance. 5) Borrow maximum stablecoins based on inflated collateral valuation (2-3x more than true value). 6) Swap back to rebalance pool. 7) Repay flash loan. 8) Keep overborrowed funds. Loss: $7.7M.",
    "impact": "Funds lost: $7,700,000",
    "correct_fix": null
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2020-12-17",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 104,
    "num_contracts": 1,
    "contract_names": [
      "LendingVault"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "flash_loan",
    "lp_tokens",
    "uniswap",
    "price_manipulation",
    "oracle",
    "collateral_valuation",
    "defi_lending"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2020-12-17",
      "protocol_name": "Warp Finance LP Token Price Manipulation",
      "chain": "ethereum",
      "funds_lost_usd": 7700000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": false,
      "likely_in_training": true,
      "exposure_notes": "Famous Warp Finance LP Token Price Manipulation exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_020.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_020.json",
    "original_exploit_name": "Warp Finance LP Token Price Manipulation"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_020.sol",
  "sanitized_from": "tc_020",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 824208173,
    "coverage": {
      "total_identifiers": 48,
      "transformed": 29,
      "untransformed": 19,
      "skipped_reserved": 28,
      "skipped_interface": 0,
      "coverage_percent": 60.42,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "reserve0",
          "reason": "no synonym found"
        },
        {
          "name": "reserve1",
          "reason": "no synonym found"
        },
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "LendingVault",
          "reason": "no synonym found"
        },
        {
          "name": "borrowed",
          "reason": "no synonym found"
        },
        {
          "name": "positions",
          "reason": "no synonym found"
        },
        {
          "name": "stablecoin",
          "reason": "no synonym found"
        },
        {
          "name": "_stablecoin",
          "reason": "no synonym found"
        },
        {
          "name": "Insufficient",
          "reason": "no synonym found"
        },
        {
          "name": "amount0",
          "reason": "no synonym found"
        },
        {
          "name": "amount1",
          "reason": "no synonym found"
        },
        {
          "name": "value0",
          "reason": "no synonym found"
        },
        {
          "name": "exceeds",
          "reason": "no synonym found"
        },
        {
          "name": "remainingLP",
          "reason": "no synonym found"
        },
        {
          "name": "would",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "IUniswapV2Pair": "IUniswapV2Duo",
      "getReserves": "retrieveStockpile",
      "blockTimestampLast": "frameGametimeEnding",
      "account": "character",
      "amount": "quantity",
      "from": "source",
      "Position": "Location",
      "lpTokenAmount": "lpCrystalSum",
      "lpToken": "lpGem",
      "COLLATERAL_RATIO": "pledge_proportion",
      "_lpToken": "_lpGem",
      "deposit": "stashRewards",
      "sender": "invoker",
      "borrow": "seekAdvance",
      "collateralValue": "pledgePrice",
      "getLPTokenValue": "retrieveLpCoinMagnitude",
      "maxBorrow": "ceilingRequestloan",
      "collateral": "security",
      "lpAmount": "lpTotal",
      "pair": "duo",
      "totalValue": "aggregateCost",
      "repay": "returnLoan",
      "Repay": "ReturnLoan",
      "debt": "liability",
      "withdraw": "redeemTokens",
      "remainingValue": "remainingWorth",
      "Withdrawal": "LootClaimed",
      "liquidate": "convertToGold",
      "position": "location"
    }
  }
}