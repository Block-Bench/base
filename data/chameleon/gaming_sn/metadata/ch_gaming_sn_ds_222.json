{
  "id": "ch_gaming_sn_ds_222",
  "contract_file": "contracts/ch_gaming_sn_ds_222.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "other",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "In this scenario, Alice signs a transaction that allows Bob to transfer tokens from Alice's account \nto Bob's account. Bob then replays this signature on multiple contracts \n(in this case, the TokenWhale and SixEyeToken contracts), each time authorizing the transfer of tokens \nfrom Alice's account to his. This is possible because the contracts use the same methodology for signing\nand validating transactions, but they do not share a nonce to prevent replay attacks.\n\nMissing protection against signature replay attacks, Same signature can be used multiple times to execute a function.",
    "attack_vector": "In this scenario, Alice signs a transaction that allows Bob to transfer tokens from Alice's account \nto Bob's account. Bob then replays this signature on multiple contracts \n(in this case, the TokenWhale and SixEyeToken contracts), each time authorizing the transfer of tokens \nfrom Alice's account to his. This is possible because the contracts use the same methodology for signing\nand validating transactions, but they do not share a nonce to prevent replay attacks.\n\nMissing protection against signature replay attacks, Same signature can be used multiple times to execute a function.",
    "impact": "Severity: high",
    "correct_fix": "Replay attacks can be prevented by implementing a nonce, a number that is only used once, into the signing and verification process."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_signaturereplay",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 231,
    "num_contracts": 4,
    "contract_names": [
      "ContractTest",
      "with",
      "TokenWhale",
      "SixEyeToken"
    ],
    "num_functions": 9,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_4_expert",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 4,
    "difficulty_tier_name": "multi_contract",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "In this scenario, Alice signs a transaction that allows Bob to transfer tokens from Alice's account \nto Bob's account. Bob then replays this signature on multiple contracts \n(in this case, the TokenWhale and SixEyeToken contracts), each time authorizing the transfer of tokens \nfrom Alice's account to his. This is possible because the contracts use the same methodology for signing\nand validating transactions, but they do not share a nonce to prevent replay attacks.\n\nMissing protection against signature replay attacks, Same signature can be used multiple times to execute a function.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_222.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_222.json",
    "original_id": "defivulnlabs_signaturereplay"
  },
  "original_contract_file": "base/contracts/ds_222.sol",
  "sanitized_from": "ds_222",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 3251266691,
    "coverage": {
      "total_identifiers": 90,
      "transformed": 28,
      "untransformed": 62,
      "skipped_reserved": 42,
      "skipped_interface": 0,
      "coverage_percent": 31.11,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "forge",
          "reason": "no synonym found"
        },
        {
          "name": "std",
          "reason": "no synonym found"
        },
        {
          "name": "Test",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "alice",
          "reason": "no synonym found"
        },
        {
          "name": "addr",
          "reason": "no synonym found"
        },
        {
          "name": "bob",
          "reason": "no synonym found"
        },
        {
          "name": "encodePacked",
          "reason": "no synonym found"
        },
        {
          "name": "The",
          "reason": "no synonym found"
        },
        {
          "name": "can",
          "reason": "no synonym found"
        },
        {
          "name": "combined",
          "reason": "no synonym found"
        },
        {
          "name": "into",
          "reason": "no synonym found"
        },
        {
          "name": "one",
          "reason": "no synonym found"
        },
        {
          "name": "byte",
          "reason": "no synonym found"
        },
        {
          "name": "long",
          "reason": "no synonym found"
        },
        {
          "name": "sequence",
          "reason": "no synonym found"
        },
        {
          "name": "and",
          "reason": "no synonym found"
        },
        {
          "name": "point",
          "reason": "no synonym found"
        },
        {
          "name": "the",
          "reason": "no synonym found"
        },
        {
          "name": "secp256k1",
          "reason": "no synonym found"
        },
        {
          "name": "elliptic",
          "reason": "no synonym found"
        },
        {
          "name": "curve",
          "reason": "no synonym found"
        },
        {
          "name": "recovery",
          "reason": "no synonym found"
        },
        {
          "name": "got",
          "reason": "no synonym found"
        },
        {
          "name": "Alice",
          "reason": "no synonym found"
        },
        {
          "name": "replay",
          "reason": "no synonym found"
        },
        {
          "name": "others",
          "reason": "no synonym found"
        },
        {
          "name": "contracts",
          "reason": "no synonym found"
        },
        {
          "name": "with",
          "reason": "no synonym found"
        },
        {
          "name": "same",
          "reason": "no synonym found"
        },
        {
          "name": "method",
          "reason": "no synonym found"
        },
        {
          "name": "Bob",
          "reason": "no synonym found"
        },
        {
          "name": "successfully",
          "reason": "no synonym found"
        },
        {
          "name": "transferred",
          "reason": "no synonym found"
        },
        {
          "name": "funds",
          "reason": "no synonym found"
        },
        {
          "name": "Because",
          "reason": "no synonym found"
        },
        {
          "name": "have",
          "reason": "no synonym found"
        },
        {
          "name": "protect",
          "reason": "no synonym found"
        },
        {
          "name": "not",
          "reason": "no synonym found"
        },
        {
          "name": "again",
          "reason": "no synonym found"
        },
        {
          "name": "BTW",
          "reason": "no synonym found"
        },
        {
          "name": "best",
          "reason": "no synonym found"
        },
        {
          "name": "practice",
          "reason": "no synonym found"
        },
        {
          "name": "another",
          "reason": "no synonym found"
        },
        {
          "name": "Before",
          "reason": "no synonym found"
        },
        {
          "name": "SIX",
          "reason": "no synonym found"
        },
        {
          "name": "After",
          "reason": "no synonym found"
        },
        {
          "name": "second",
          "reason": "no synonym found"
        },
        {
          "name": "player",
          "reason": "no synonym found"
        },
        {
          "name": "ERC20",
          "reason": "no synonym found"
        },
        {
          "name": "nonces",
          "reason": "no synonym found"
        },
        {
          "name": "_player",
          "reason": "no synonym found"
        },
        {
          "name": "_transfer",
          "reason": "no synonym found"
        },
        {
          "name": "_from",
          "reason": "no synonym found"
        },
        {
          "name": "_to",
          "reason": "no synonym found"
        },
        {
          "name": "_value",
          "reason": "no synonym found"
        },
        {
          "name": "Six",
          "reason": "no synonym found"
        },
        {
          "name": "Eye",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "ContractTest": "PactTest",
      "TokenWhale": "MedalWhale",
      "TokenWhaleContract": "MedalWhaleAgreement",
      "SixEyeToken": "SixEyeCoin",
      "SixEyeTokenContract": "SixEyeCrystalPact",
      "TokenWhaleDeploy": "CoinWhaleDeploy",
      "testSignatureReplay": "testSealReplay",
      "log_named_uint": "journal_named_number",
      "hash": "signature",
      "log_named_bytes32": "journal_named_bytes32",
      "signature": "mark",
      "sign": "authorize",
      "alice_address": "alice_realm",
      "log_named_address": "record_named_location",
      "log_string": "record_text",
      "operator": "questRunner",
      "startPrank": "beginPrank",
      "transferProxy": "shiftgoldProxy",
      "from": "origin",
      "SET": "Configure",
      "token": "medal",
      "nonce": "sequence",
      "start": "begin",
      "Simple": "BasicDungeon",
      "Token": "Crystal",
      "value": "worth",
      "sender": "caster",
      "_feeUgt": "_cutUgt"
    }
  }
}