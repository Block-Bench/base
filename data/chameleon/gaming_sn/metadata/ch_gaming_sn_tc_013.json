{
  "id": "ch_gaming_sn_tc_013",
  "contract_file": "contracts/ch_gaming_sn_tc_013.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "integer_overflow",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "pancake_hunny.sol",
      "function_name": "mintFor",
      "line_numbers": [
        95,
        98
      ]
    },
    "root_cause": "Using balanceOf(address(this)) for reward calculation instead of tracking actual deposits. Attacker sent tokens directly to contract before calling mintFor, inflating the balance used for reward calculation.",
    "attack_vector": "Attacker flash loaned large amount of LP tokens, sent them directly to minter contract, called getReward which triggered mintFor. Function calculated rewards based on inflated balance, minting excessive HUNNY tokens.",
    "impact": "Funds lost: $45,000,000",
    "correct_fix": "Track deposits explicitly instead of using balanceOf. Calculate delta: balanceAfter - balanceBefore. Never trust balanceOf for business logic as anyone can send tokens directly."
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2021-05-20",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 86,
    "num_contracts": 1,
    "contract_names": [
      "RewardMinter"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "balance-manipulation",
    "flash-loan",
    "reward-calculation",
    "balanceof-exploit"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2021-05-20",
      "protocol_name": "PancakeHunny (PancakeBunny)",
      "chain": "bsc",
      "funds_lost_usd": 45000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous PancakeHunny (PancakeBunny) exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_013.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_013.json",
    "original_exploit_name": "PancakeHunny (PancakeBunny)"
  },
  "original_contract_file": "base/contracts/tc_013.sol",
  "sanitized_from": "tc_013",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 2188089214,
    "coverage": {
      "total_identifiers": 48,
      "transformed": 30,
      "untransformed": 18,
      "skipped_reserved": 29,
      "skipped_interface": 0,
      "coverage_percent": 62.5,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "title",
          "reason": "no synonym found"
        },
        {
          "name": "notice",
          "reason": "no synonym found"
        },
        {
          "name": "Manages",
          "reason": "no synonym found"
        },
        {
          "name": "deposits",
          "reason": "no synonym found"
        },
        {
          "name": "and",
          "reason": "no synonym found"
        },
        {
          "name": "minting",
          "reason": "no synonym found"
        },
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "IPancakeRouter",
          "reason": "no synonym found"
        },
        {
          "name": "amounts",
          "reason": "no synonym found"
        },
        {
          "name": "depositedLP",
          "reason": "no synonym found"
        },
        {
          "name": "flip",
          "reason": "no synonym found"
        },
        {
          "name": "Invalid",
          "reason": "no synonym found"
        },
        {
          "name": "rewards",
          "reason": "no synonym found"
        },
        {
          "name": "Insufficient",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "Reward": "Bounty",
      "Minter": "Forger",
      "token": "coin",
      "reward": "prize",
      "amount": "quantity",
      "from": "source",
      "account": "profile",
      "swapExactTokensForTokens": "exchangelootExactGemsForCoins",
      "amountIn": "quantityIn",
      "amountOut": "quantityOut",
      "path": "way",
      "deadline": "cutoffTime",
      "RewardMinter": "BonusCreator",
      "lpToken": "lpCrystal",
      "rewardToken": "treasureMedal",
      "earnedRewards": "accumulatedRewards",
      "REWARD_RATE": "payout_multiplier",
      "_lpToken": "_lpMedal",
      "_rewardToken": "_bountyGem",
      "deposit": "cachePrize",
      "sender": "invoker",
      "mintFor": "forgeFor",
      "_withdrawalFee": "_withdrawalCharge",
      "_performanceFee": "_performanceCut",
      "feeSum": "chargeSum",
      "hunnyRewardAmount": "hunnyPrizeQuantity",
      "tokenToReward": "medalDestinationBonus",
      "lpAmount": "lpTotal",
      "getReward": "fetchTreasure",
      "withdraw": "gatherTreasure"
    }
  }
}