{
  "id": "ch_gaming_sn_gs_031",
  "contract_file": "contracts/ch_gaming_sn_gs_031.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "signature_replay",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "SessionSig",
      "function_name": "hashCallWithReplayProtection",
      "line_numbers": [
        406,
        407,
        408,
        409,
        410,
        411,
        412,
        413,
        414,
        415,
        416,
        417,
        418,
        419,
        420,
        421
      ]
    },
    "root_cause": "SessionSig.hashCallWithReplayProtection omits wallet address in hash, allowing signatures for one wallet to replay on another with same config and nonce. SessionManager.recoverSapientSignature and BaseAuth.signatureValidation do not bind to msg.sender.",
    "attack_vector": "Sign payload for Wallet A, replay on Wallet B (same config, nonce). Drains both wallets. PoC: test/extensions/sessions/SessionReplay.t.sol, run forge test --match-test test_crossWalletSessionReplayDrainsSiblingWallet -vv. Logs show attacker draining two wallets.",
    "impact": "Severity: medium",
    "correct_fix": "Include address(this) in hashCallWithReplayProtection. Update SDK to hash (wallet, chainId, space, nonce, callIdx, call details)."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-sequence_M01",
    "url": "https://code4rena.com/reports/2025-10-sequence",
    "date_discovered": "2025-10-07",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 1,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "signature_replay",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Session signature hashes omit the wallet address, enabling cross-wallet replay attacks on identically configured wallets.",
  "gold_standard_fields": {
    "source_report": "2025-10-sequence",
    "source_finding_id": "M-01",
    "finding_title": "Session signatures replay across wallets due to missing wallet binding",
    "difficulty_tier": 3,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "Sign session for WalletA -> Submit to WalletB (same config/nonce) -> Validation passes -> Drain WalletB"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_031.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_031.json",
    "original_finding_title": "Session signatures replay across wallets due to missing wallet binding"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_031.sol",
  "sanitized_from": "gs_031",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 252075018,
    "coverage": {
      "total_identifiers": 245,
      "transformed": 91,
      "untransformed": 154,
      "skipped_reserved": 46,
      "skipped_interface": 0,
      "coverage_percent": 37.14,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "Apache",
          "reason": "no synonym found"
        },
        {
          "name": "modules",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "LibOptim",
          "reason": "no synonym found"
        },
        {
          "name": "SessionErrors",
          "reason": "no synonym found"
        },
        {
          "name": "SessionPermissions",
          "reason": "no synonym found"
        },
        {
          "name": "explicit",
          "reason": "no synonym found"
        },
        {
          "name": "LibPermission",
          "reason": "no synonym found"
        },
        {
          "name": "Permission",
          "reason": "no synonym found"
        },
        {
          "name": "Attestation",
          "reason": "no synonym found"
        },
        {
          "name": "LibAttestation",
          "reason": "no synonym found"
        },
        {
          "name": "implicit",
          "reason": "no synonym found"
        },
        {
          "name": "title",
          "reason": "no synonym found"
        },
        {
          "name": "SessionSig",
          "reason": "no synonym found"
        },
        {
          "name": "author",
          "reason": "no synonym found"
        },
        {
          "name": "Michael",
          "reason": "no synonym found"
        },
        {
          "name": "Standen",
          "reason": "no synonym found"
        },
        {
          "name": "Agustin",
          "reason": "no synonym found"
        },
        {
          "name": "Aguilar",
          "reason": "no synonym found"
        },
        {
          "name": "notice",
          "reason": "no synonym found"
        },
        {
          "name": "session",
          "reason": "no synonym found"
        },
        {
          "name": "signatures",
          "reason": "no synonym found"
        },
        {
          "name": "specific",
          "reason": "no synonym found"
        },
        {
          "name": "param",
          "reason": "no synonym found"
        },
        {
          "name": "the",
          "reason": "no synonym found"
        },
        {
          "name": "sessionSigner",
          "reason": "no synonym found"
        },
        {
          "name": "signer",
          "reason": "no synonym found"
        },
        {
          "name": "sessionPermission",
          "reason": "no synonym found"
        },
        {
          "name": "Session",
          "reason": "no synonym found"
        },
        {
          "name": "permission",
          "reason": "no synonym found"
        },
        {
          "name": "calls",
          "reason": "no synonym found"
        },
        {
          "name": "attestation",
          "reason": "no synonym found"
        },
        {
          "name": "Decoded",
          "reason": "no synonym found"
        },
        {
          "name": "Derived",
          "reason": "no synonym found"
        },
        {
          "name": "configuration",
          "reason": "no synonym found"
        },
        {
          "name": "image",
          "reason": "no synonym found"
        },
        {
          "name": "identitySigner",
          "reason": "no synonym found"
        },
        {
          "name": "Identity",
          "reason": "no synonym found"
        },
        {
          "name": "implicitBlacklist",
          "reason": "no synonym found"
        },
        {
          "name": "Implicit",
          "reason": "no synonym found"
        },
        {
          "name": "blacklist",
          "reason": "no synonym found"
        },
        {
          "name": "addresses",
          "reason": "no synonym found"
        },
        {
          "name": "sessionPermissions",
          "reason": "no synonym found"
        },
        {
          "name": "permissions",
          "reason": "no synonym found"
        },
        {
          "name": "each",
          "reason": "no synonym found"
        },
        {
          "name": "Recovers",
          "reason": "no synonym found"
        },
        {
          "name": "decoded",
          "reason": "no synonym found"
        },
        {
          "name": "dev",
          "reason": "no synonym found"
        },
        {
          "name": "The",
          "reason": "no synonym found"
        },
        {
          "name": "encoded",
          "reason": "no synonym found"
        },
        {
          "name": "layout",
          "reason": "no synonym found"
        },
        {
          "name": "conceptually",
          "reason": "no synonym found"
        },
        {
          "name": "separated",
          "reason": "no synonym found"
        },
        {
          "name": "into",
          "reason": "no synonym found"
        },
        {
          "name": "three",
          "reason": "no synonym found"
        },
        {
          "name": "parts",
          "reason": "no synonym found"
        },
        {
          "name": "Configuration",
          "reason": "no synonym found"
        },
        {
          "name": "reusable",
          "reason": "no synonym found"
        },
        {
          "name": "Attestations",
          "reason": "no synonym found"
        },
        {
          "name": "their",
          "reason": "no synonym found"
        },
        {
          "name": "identity",
          "reason": "no synonym found"
        },
        {
          "name": "any",
          "reason": "no synonym found"
        },
        {
          "name": "exist",
          "reason": "no synonym found"
        },
        {
          "name": "Signatures",
          "reason": "no synonym found"
        },
        {
          "name": "one",
          "reason": "no synonym found"
        },
        {
          "name": "per",
          "reason": "no synonym found"
        },
        {
          "name": "High",
          "reason": "no synonym found"
        },
        {
          "name": "session_configuration",
          "reason": "no synonym found"
        },
        {
          "name": "identitySig",
          "reason": "no synonym found"
        },
        {
          "name": "section",
          "reason": "no synonym found"
        },
        {
          "name": "allow",
          "reason": "no synonym found"
        },
        {
          "name": "reusing",
          "reason": "no synonym found"
        },
        {
          "name": "same",
          "reason": "no synonym found"
        },
        {
          "name": "across",
          "reason": "no synonym found"
        },
        {
          "name": "multiple",
          "reason": "no synonym found"
        },
        {
          "name": "MSB",
          "reason": "no synonym found"
        },
        {
          "name": "bits",
          "reason": "no synonym found"
        },
        {
          "name": "compact",
          "reason": "no synonym found"
        },
        {
          "name": "session_permission",
          "reason": "no synonym found"
        },
        {
          "name": "sig",
          "reason": "no synonym found"
        },
        {
          "name": "read",
          "reason": "no synonym found"
        },
        {
          "name": "readUint24",
          "reason": "no synonym found"
        },
        {
          "name": "must",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidIdentitySigner",
          "reason": "no synonym found"
        },
        {
          "name": "readUint8",
          "reason": "no synonym found"
        },
        {
          "name": "Parse",
          "reason": "no synonym found"
        },
        {
          "name": "and",
          "reason": "no synonym found"
        },
        {
          "name": "its",
          "reason": "no synonym found"
        },
        {
          "name": "store",
          "reason": "no synonym found"
        },
        {
          "name": "att",
          "reason": "no synonym found"
        },
        {
          "name": "Read",
          "reason": "no synonym found"
        },
        {
          "name": "that",
          "reason": "no synonym found"
        },
        {
          "name": "approves",
          "reason": "no synonym found"
        },
        {
          "name": "readRSVCompact",
          "reason": "no synonym found"
        },
        {
          "name": "recoveredIdentitySigner",
          "reason": "no synonym found"
        },
        {
          "name": "have",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidBlacklist",
          "reason": "no synonym found"
        },
        {
          "name": "Determine",
          "reason": "no synonym found"
        },
        {
          "name": "out",
          "reason": "no synonym found"
        },
        {
          "name": "range",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidAttestation",
          "reason": "no synonym found"
        },
        {
          "name": "entire",
          "reason": "no synonym found"
        },
        {
          "name": "byte",
          "reason": "no synonym found"
        },
        {
          "name": "top",
          "reason": "no synonym found"
        },
        {
          "name": "bit",
          "reason": "no synonym found"
        },
        {
          "name": "conflict",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidSessionSigner",
          "reason": "no synonym found"
        },
        {
          "name": "Guess",
          "reason": "no synonym found"
        },
        {
          "name": "maximum",
          "reason": "no synonym found"
        },
        {
          "name": "additional",
          "reason": "no synonym found"
        },
        {
          "name": "bottom",
          "reason": "no synonym found"
        },
        {
          "name": "are",
          "reason": "no synonym found"
        },
        {
          "name": "Permissions",
          "reason": "no synonym found"
        },
        {
          "name": "nodePermissions",
          "reason": "no synonym found"
        },
        {
          "name": "readUint256",
          "reason": "no synonym found"
        },
        {
          "name": "readUint64",
          "reason": "no synonym found"
        },
        {
          "name": "_decodePermissions",
          "reason": "no synonym found"
        },
        {
          "name": "fkeccak256",
          "reason": "no synonym found"
        },
        {
          "name": "Push",
          "reason": "no synonym found"
        },
        {
          "name": "node",
          "reason": "no synonym found"
        },
        {
          "name": "Node",
          "reason": "no synonym found"
        },
        {
          "name": "pre",
          "reason": "no synonym found"
        },
        {
          "name": "readBytes32",
          "reason": "no synonym found"
        },
        {
          "name": "Branch",
          "reason": "no synonym found"
        },
        {
          "name": "branch",
          "reason": "no synonym found"
        },
        {
          "name": "nrindex",
          "reason": "no synonym found"
        },
        {
          "name": "branchSig",
          "reason": "no synonym found"
        },
        {
          "name": "branchHasBlacklist",
          "reason": "no synonym found"
        },
        {
          "name": "Store",
          "reason": "no synonym found"
        },
        {
          "name": "Blacklist",
          "reason": "no synonym found"
        },
        {
          "name": "already",
          "reason": "no synonym found"
        },
        {
          "name": "all",
          "reason": "no synonym found"
        },
        {
          "name": "lower",
          "reason": "no synonym found"
        },
        {
          "name": "nibble",
          "reason": "no synonym found"
        },
        {
          "name": "actual",
          "reason": "no synonym found"
        },
        {
          "name": "readUint16",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidBlacklistUnsorted",
          "reason": "no synonym found"
        },
        {
          "name": "InvalidNodeType",
          "reason": "no synonym found"
        },
        {
          "name": "mstore",
          "reason": "no synonym found"
        },
        {
          "name": "Decodes",
          "reason": "no synonym found"
        },
        {
          "name": "objects",
          "reason": "no synonym found"
        },
        {
          "name": "readPermission",
          "reason": "no synonym found"
        },
        {
          "name": "leaf",
          "reason": "no synonym found"
        },
        {
          "name": "encodedPermissions",
          "reason": "no synonym found"
        },
        {
          "name": "encodedBlacklist",
          "reason": "no synonym found"
        },
        {
          "name": "with",
          "reason": "no synonym found"
        },
        {
          "name": "replay",
          "reason": "no synonym found"
        },
        {
          "name": "protection",
          "reason": "no synonym found"
        },
        {
          "name": "based",
          "reason": "no synonym found"
        },
        {
          "name": "space",
          "reason": "no synonym found"
        },
        {
          "name": "chainid",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "Payload": "Load",
      "from": "source",
      "LibBytes": "LibData",
      "utils": "gameUtils",
      "IExplicitSessionManager": "IExplicitSessionController",
      "FLAG_PERMISSIONS": "marker_permissions",
      "FLAG_NODE": "indicator_node",
      "FLAG_BRANCH": "marker_branch",
      "FLAG_BLACKLIST": "marker_blacklist",
      "FLAG_IDENTITY_SIGNER": "marker_identity_signer",
      "MIN_ENCODED_PERMISSION_SIZE": "floor_encoded_permission_scale",
      "signature": "seal",
      "isImplicit": "validateImplicit",
      "CallSignature": "CastabilitySeal",
      "imageHash": "imageSeal",
      "hash": "signature",
      "callSignatures": "castabilitySignatures",
      "payload": "load",
      "DecodedSignature": "DecodedMark",
      "encodedSignature": "encodedSeal",
      "list": "roster",
      "level": "progress",
      "size": "magnitude",
      "attestation_list": "attestation_roster",
      "attestationCount": "attestationNumber",
      "call_signatures": "summonhero_signatures",
      "Size": "Scale",
      "length": "size",
      "call_signature": "castability_mark",
      "call_flags": "summonhero_flags",
      "session_signature": "session_mark",
      "is_implicit": "test_implicit",
      "attestation_index": "attestation_position",
      "index": "position",
      "recoverSignature": "restoreMark",
      "pointer": "reference",
      "hasBlacklistInConfig": "hasBlacklistInSettings",
      "First": "Primary",
      "dataSize": "infoMagnitude",
      "Recover": "Restore",
      "recoverConfiguration": "restoreConfiguration",
      "set": "establish",
      "attestationList": "attestationRegistry",
      "fromPacked": "sourcePacked",
      "attestationHash": "attestationSeal",
      "toHash": "destinationSignature",
      "callsCount": "callsTally",
      "callSignature": "castabilitySeal",
      "flag": "indicator",
      "attestationIndex": "attestationSlot",
      "Check": "Inspect",
      "Set": "Configure",
      "recover": "retrieve",
      "callHash": "summonheroSignature",
      "hashCallWithReplayProtection": "sealInvokespellWithReplayProtection",
      "data": "info",
      "hasBlacklist": "containsBlacklist",
      "permissionsCount": "permissionsNumber",
      "maxPermissionsSize": "maximumPermissionsMagnitude",
      "firstByte": "primaryByte",
      "pointerStart": "linkBegin",
      "readAddress": "readLocation",
      "chainId": "chainCode",
      "value": "price",
      "limit": "cap",
      "valueLimit": "magnitudeBound",
      "deadline": "cutoffTime",
      "Update": "SyncProgress",
      "root": "source585",
      "permissionHash": "permissionSeal",
      "_leafHashForPermissions": "_leafSealForPermissions",
      "hashed": "holdshed",
      "sizeSize": "scaleScale",
      "readUintX": "readCountX",
      "Process": "Execute",
      "count": "tally",
      "first": "primary",
      "blacklistCount": "blacklistNumber",
      "max": "ceiling",
      "next": "following",
      "previousAddress": "lastZone",
      "blacklistHash": "blacklistSignature",
      "_leafHashForBlacklist": "_leafSealForBlacklist",
      "identitySignerHash": "identitySignerSignature",
      "_leafHashForIdentitySigner": "_leafSignatureForIdentitySigner",
      "newPointer": "currentReference",
      "Hashes": "Includeshes",
      "nonce": "sequence",
      "callIdx": "invokespellIdx",
      "noChainId": "noChainIdentifier",
      "hashCall": "signatureInvokespell"
    }
  }
}