{
  "id": "ch_gaming_sn_ds_230",
  "contract_file": "contracts/ch_gaming_sn_ds_230.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "other",
    "severity": "critical",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "Missing flash loan initiator check refers to a potential security vulnerability in a flash loan implementation \nwhere the initiator of the flash loan is not properly verified or checked, anyone could exploit the flash loan \nfunctionality and set the receiver address to a vulnerable protocol.\n  \nBy doing so, an attacker could potentially manipulate balances, open trades, drain funds, \nor carry out other malicious actions within the vulnerable protocol. \nThis poses significant risks to the security and integrity of the protocol and its users.",
    "attack_vector": "Missing flash loan initiator check refers to a potential security vulnerability in a flash loan implementation \nwhere the initiator of the flash loan is not properly verified or checked, anyone could exploit the flash loan \nfunctionality and set the receiver address to a vulnerable protocol.\n  \nBy doing so, an attacker could potentially manipulate balances, open trades, drain funds, \nor carry out other malicious actions within the vulnerable protocol. \nThis poses significant risks to the security and integrity of the protocol and its users.",
    "impact": "Severity: critical",
    "correct_fix": "Check the initiator of the flash loan and revert if the initiator is not authorized."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_flashloan-flaw",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 162,
    "num_contracts": 5,
    "contract_names": [
      "ContractTest",
      "SimpleBankBug",
      "FixedSimpleBank",
      "USDa",
      "LendingPool"
    ],
    "num_functions": 10,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_4_expert",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 4,
    "difficulty_tier_name": "multi_contract",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "Missing flash loan initiator check refers to a potential security vulnerability in a flash loan implementation \nwhere the initiator of the flash loan is not properly verified or checked, anyone could exploit the flash loan \nfunctionality and set the receiver address to a vulnerable protocol.\n  \nBy doing so, an attacker could potentially manipulate balances, open trades, drain funds, \nor carry out other malicious actions within the vulnerable protocol. \nThis poses significant risks to the security and integrity of the protocol and its users.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_230.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_230.json",
    "original_id": "defivulnlabs_flashloan-flaw"
  },
  "original_contract_file": "base/contracts/ds_230.sol",
  "sanitized_from": "ds_230",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "sanitized",
    "seed": 4019934882,
    "coverage": {
      "total_identifiers": 65,
      "transformed": 27,
      "untransformed": 38,
      "skipped_reserved": 27,
      "skipped_interface": 0,
      "coverage_percent": 41.54,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "forge",
          "reason": "no synonym found"
        },
        {
          "name": "std",
          "reason": "no synonym found"
        },
        {
          "name": "Test",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "openzeppelin",
          "reason": "no synonym found"
        },
        {
          "name": "contracts",
          "reason": "no synonym found"
        },
        {
          "name": "ERC20",
          "reason": "no synonym found"
        },
        {
          "name": "access",
          "reason": "no synonym found"
        },
        {
          "name": "Ownable",
          "reason": "no synonym found"
        },
        {
          "name": "SafeERC20",
          "reason": "no synonym found"
        },
        {
          "name": "USDa",
          "reason": "no synonym found"
        },
        {
          "name": "LendingPool",
          "reason": "no synonym found"
        },
        {
          "name": "SimpleBankAlt",
          "reason": "no synonym found"
        },
        {
          "name": "SimpleBankV2",
          "reason": "no synonym found"
        },
        {
          "name": "IERC20",
          "reason": "no synonym found"
        },
        {
          "name": "lendingPool",
          "reason": "no synonym found"
        },
        {
          "name": "_asset",
          "reason": "no synonym found"
        },
        {
          "name": "amounts",
          "reason": "no synonym found"
        },
        {
          "name": "_initiator",
          "reason": "no synonym found"
        },
        {
          "name": "all",
          "reason": "no synonym found"
        },
        {
          "name": "borrowed",
          "reason": "no synonym found"
        },
        {
          "name": "assets",
          "reason": "no synonym found"
        },
        {
          "name": "back",
          "reason": "no synonym found"
        },
        {
          "name": "the",
          "reason": "no synonym found"
        },
        {
          "name": "lending",
          "reason": "no synonym found"
        },
        {
          "name": "USDA",
          "reason": "no synonym found"
        },
        {
          "name": "_mint",
          "reason": "no synonym found"
        },
        {
          "name": "_USDA",
          "reason": "no synonym found"
        },
        {
          "name": "borrower",
          "reason": "no synonym found"
        },
        {
          "name": "Not",
          "reason": "no synonym found"
        },
        {
          "name": "enough",
          "reason": "no synonym found"
        },
        {
          "name": "Flashloan",
          "reason": "no synonym found"
        },
        {
          "name": "not",
          "reason": "no synonym found"
        },
        {
          "name": "repaid",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "token": "gem",
      "utils": "gameUtils",
      "ContractTest": "AgreementTest",
      "USDaContract": "UsDaAgreement",
      "LendingPoolContract": "LendingPoolAgreement",
      "SimpleBankContract": "SimpleBankPact",
      "SimpleBankContractV2": "SimpleBankPactV2",
      "setUp": "collectionUp",
      "testFlashLoanFlaw": "testInstantLoanFlaw",
      "flashLoan": "instantLoan",
      "testFlashLoanSecure": "testQuickLoanSecure",
      "expectRevert": "expectReverse",
      "Unauthorized": "AccessDenied",
      "_lendingPoolAddress": "_lendingPoolZone",
      "receiverAddress": "collectorZone",
      "data": "info",
      "executeOperation": "runmissionOperation",
      "pool": "jackpotPool",
      "safeTransfer": "secureMove",
      "sender": "caster",
      "mint": "forge",
      "amount": "quantity",
      "IFlashLoanReceiver": "IInstantLoanRecipient",
      "balanceBefore": "prizecountBefore",
      "liquidity": "flow",
      "failed": "actionFailed",
      "balanceAfter": "treasureamountAfter"
    }
  }
}