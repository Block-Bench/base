{
  "id": "ch_gaming_nc_ds_190",
  "contract_file": "contracts/ch_gaming_nc_ds_190.sol",
  "subset": "chameleon_gaming",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "After the implementation of EIP 1884 in the Istanbul hard fork, \nthe gas cost of the SLOAD operation was increased, \nresulting in the breaking of some existing smart contracts.\n\nWhen transferring ETH to recipients, if Solidity's transfer() or send() method \nis used, certain shortcomings arise, particularly when the recipient \nis a smart contract. These shortcomings can make it impossible to \nsuccessfully transfer ETH to the smart contract recipient.\n\nSpecifically, the transfer will inevitably fail when the smart contract:\n    1.does not implement a payable fallback function, or\n    2.implements a payable fallback function which would incur more than 2300 gas units, or\n    3.implements a payable fallback function incurring less than 2300 gas units but is called through a proxy that raises the call\u2019s gas usage above 2300.",
    "attack_vector": "After the implementation of EIP 1884 in the Istanbul hard fork, \nthe gas cost of the SLOAD operation was increased, \nresulting in the breaking of some existing smart contracts.\n\nWhen transferring ETH to recipients, if Solidity's transfer() or send() method \nis used, certain shortcomings arise, particularly when the recipient \nis a smart contract. These shortcomings can make it impossible to \nsuccessfully transfer ETH to the smart contract recipient.\n\nSpecifically, the transfer will inevitably fail when the smart contract:\n    1.does not implement a payable fallback function, or\n    2.implements a payable fallback function which would incur more than 2300 gas units, or\n    3.implements a payable fallback function incurring less than 2300 gas units but is called through a proxy that raises the call\u2019s gas usage above 2300.",
    "impact": "Severity: medium",
    "correct_fix": "Using call with its returned boolean checked in combination with re-entrancy guard is highly recommended."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_payable-transfer",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 72,
    "num_contracts": 3,
    "contract_names": [
      "ContractTest",
      "SimpleBank",
      "FixedSimpleBank"
    ],
    "num_functions": 9,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_3_hard",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 3,
    "difficulty_tier_name": "subtle_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "After the implementation of EIP 1884 in the Istanbul hard fork, \nthe gas cost of the SLOAD operation was increased, \nresulting in the breaking of some existing smart contracts.\n\nWhen transferring ETH to recipients, if Solidity's transfer() or send() method \nis used, certain shortcomings arise, particularly when the recipient \nis a smart contract. These shortcomings can make it impossible to \nsuccessfully transfer ETH to the smart contract recipient.\n\nSpecifically, the transfer will inevitably fail when the smart contract:\n    1.does not implement a payable fallback function, or\n    2.implements a payable fallback function which would incur more than 2300 gas units, or\n    3.implements a payable fallback function incurring less than 2300 gas units but is called through a proxy that raises the call\u2019s gas usage above 2300.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_190.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_190.json",
    "original_id": "defivulnlabs_payable-transfer"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_190.sol",
  "sanitized_from": "ds_190",
  "derived_from": "sn_ds_190",
  "original_id": "ds_190",
  "transformation": {
    "strategy": "chameleon",
    "theme": "gaming",
    "source": "nocomments",
    "seed": 2353704470,
    "coverage": {
      "total_identifiers": 24,
      "transformed": 16,
      "untransformed": 8,
      "skipped_reserved": 25,
      "skipped_interface": 0,
      "coverage_percent": 66.67,
      "untransformed_details": [
        {
          "name": "forge",
          "reason": "no synonym found"
        },
        {
          "name": "std",
          "reason": "no synonym found"
        },
        {
          "name": "Test",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "SimpleBank",
          "reason": "no synonym found"
        },
        {
          "name": "SimpleBankV2",
          "reason": "no synonym found"
        },
        {
          "name": "assertEq",
          "reason": "no synonym found"
        },
        {
          "name": "ETH",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "ContractTest": "AgreementTest",
      "SimpleBankContract": "SimpleBankAgreement",
      "SimpleBankContractV2": "SimpleBankPactV2",
      "setUp": "groupUp",
      "testTransferFail": "testMovetreasureFail",
      "deposit": "stashRewards",
      "value": "magnitude",
      "getBalance": "viewTreasure",
      "expectRevert": "expectReverse",
      "withdraw": "retrieveRewards",
      "testCall": "testCastability",
      "balances": "userRewards",
      "sender": "invoker",
      "amount": "sum",
      "success": "win",
      "Failed": "OperationFailed"
    }
  }
}