{
  "id": "ch_medical_sn_ds_102",
  "contract_file": "contracts/ch_medical_sn_ds_102.sol",
  "subset": "chameleon_medical",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "access_control",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "The default visibility of the function is Public. \nIf there is an unsafe visibility setting, the attacker can directly call the sensitive function in the smart contract.\n\nThe ownerGame contract has a changeOwner function that is intended to change the owner of the contract.\nHowever, due to improper access control, this function is publicly accessible and \ncan be called by any external account or contract. As a result, an attacker can call this function\nto change the ownership of the contract and take control.",
    "attack_vector": "The default visibility of the function is Public. \nIf there is an unsafe visibility setting, the attacker can directly call the sensitive function in the smart contract.\n\nThe ownerGame contract has a changeOwner function that is intended to change the owner of the contract.\nHowever, due to improper access control, this function is publicly accessible and \ncan be called by any external account or contract. As a result, an attacker can call this function\nto change the ownership of the contract and take control.",
    "impact": "Severity: high",
    "correct_fix": "Use access control modifiers: Solidity provides modifiers, such as onlyOwner, \nwhich can be used to restrict the access of functions"
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_visibility",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 38,
    "num_contracts": 2,
    "contract_names": [
      "ContractTest",
      "ownerGame"
    ],
    "num_functions": 3,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_2_medium",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 2,
    "difficulty_tier_name": "clear_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "The default visibility of the function is Public. \nIf there is an unsafe visibility setting, the attacker can directly call the sensitive function in the smart contract.\n\nThe ownerGame contract has a changeOwner function that is intended to change the owner of the contract.\nHowever, due to improper access control, this function is publicly accessible and \ncan be called by any external account or contract. As a result, an attacker can call this function\nto change the ownership of the contract and take control.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_102.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_102.json",
    "original_id": "defivulnlabs_visibility"
  },
  "original_contract_file": "base/contracts/ds_102.sol",
  "sanitized_from": "ds_102",
  "transformation": {
    "strategy": "chameleon",
    "theme": "medical",
    "source": "sanitized",
    "seed": 893013291,
    "coverage": {
      "total_identifiers": 25,
      "transformed": 6,
      "untransformed": 19,
      "skipped_reserved": 16,
      "skipped_interface": 0,
      "coverage_percent": 24.0,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "forge",
          "reason": "no synonym found"
        },
        {
          "name": "std",
          "reason": "no synonym found"
        },
        {
          "name": "Test",
          "reason": "no synonym found"
        },
        {
          "name": "sol",
          "reason": "no synonym found"
        },
        {
          "name": "testVisibility",
          "reason": "no synonym found"
        },
        {
          "name": "console",
          "reason": "no synonym found"
        },
        {
          "name": "Before",
          "reason": "no synonym found"
        },
        {
          "name": "operation",
          "reason": "no synonym found"
        },
        {
          "name": "After",
          "reason": "no synonym found"
        },
        {
          "name": "operate",
          "reason": "no synonym found"
        },
        {
          "name": "completed",
          "reason": "no synonym found"
        },
        {
          "name": "wrong",
          "reason": "no synonym found"
        },
        {
          "name": "visibility",
          "reason": "no synonym found"
        },
        {
          "name": "should",
          "reason": "no synonym found"
        },
        {
          "name": "_new",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "ContractTest": "PolicyTest",
      "ownerGame": "directorGame",
      "ownerGameContract": "administratorGameAgreement",
      "log": "record",
      "changeOwner": "changeDirector",
      "sender": "provider"
    }
  }
}