{
  "id": "ch_medical_sn_tc_006",
  "contract_file": "contracts/ch_medical_sn_tc_006.sol",
  "subset": "chameleon_medical",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "access_control",
    "severity": "critical",
    "vulnerable_location": {
      "contract_name": "VulnerableRoninBridge",
      "function_name": "withdrawERC20For",
      "line_numbers": [
        81,
        82,
        83,
        84,
        85,
        86,
        87,
        88,
        89,
        90,
        91,
        92,
        93,
        94,
        95,
        96,
        97,
        98,
        99,
        100,
        101,
        102,
        103,
        113
      ]
    },
    "root_cause": "Excessive centralization where a single entity (Sky Mavis) controlled or had access to 5 out of 9 validators - exactly the threshold needed to approve withdrawals. Poor key management practices allowed attackers to compromise all necessary keys through a single infrastructure breach. The smart contract logic was correct, but the validator setup violated the principle of decentralization that multi-sig security depends on.",
    "attack_vector": "Attackers (Lazarus Group) compromised Sky Mavis infrastructure through social engineering and gained access to private keys for 4 validators directly controlled by Sky Mavis and 1 DAO validator that Sky Mavis had temporary access to. With 5 out of 9 required validator keys, attackers created fake withdrawal transactions with genuinely valid signatures. Bridge contract verified signatures (all valid), processed withdrawals, and transferred $625M to attacker addresses.",
    "impact": "Funds lost: $625,000,000",
    "correct_fix": "Increase total validator count significantly. Ensure no single entity controls multiple validators. Implement hardware security modules (HSMs) for key storage. Use Multi-Party Computation (MPC) threshold signatures instead of simple multi-sig. Require geographic and organizational diversity among validators. Implement real-time monitoring and anomaly detection for unusual withdrawals. Add withdrawal limits and timelocks for large amounts. Use cold wallets with delays for large reserves. Conduct regular security audits and penetration testing."
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": "temporal_ronin_001",
    "url": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2022-03/Ronin_exp.sol",
    "date_discovered": "2022-03-23",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 184,
    "num_contracts": 2,
    "contract_names": [
      "CrossChainBridge",
      "address"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "bridge",
    "multi_sig",
    "key_compromise",
    "centralization",
    "access_control",
    "infrastructure",
    "historical",
    "mega_hack",
    "lazarus_group"
  ],
  "notes": "Largest bridge hack in crypto history at the time. Attributed to North Korean Lazarus Group state hackers. Took 6 days before the hack was discovered. Demonstrates that smart contract security extends beyond code - key management, infrastructure security, and true decentralization are critical. The signature verification logic was perfect, but validator centralization made it useless.",
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2022-03-23",
      "protocol_name": "Ronin Bridge",
      "chain": "ethereum",
      "funds_lost_usd": 625000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous Ronin Bridge exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_006.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_006.json",
    "original_exploit_name": "Ronin Bridge"
  },
  "original_contract_file": "base/contracts/tc_006.sol",
  "sanitized_from": "tc_006",
  "transformation": {
    "strategy": "chameleon",
    "theme": "medical",
    "source": "sanitized",
    "seed": 1543318048,
    "coverage": {
      "total_identifiers": 114,
      "transformed": 40,
      "untransformed": 74,
      "skipped_reserved": 38,
      "skipped_interface": 0,
      "coverage_percent": 35.09,
      "untransformed_details": [
        {
          "name": "SPDX",
          "reason": "no synonym found"
        },
        {
          "name": "License",
          "reason": "no synonym found"
        },
        {
          "name": "Identifier",
          "reason": "no synonym found"
        },
        {
          "name": "MIT",
          "reason": "no synonym found"
        },
        {
          "name": "title",
          "reason": "no synonym found"
        },
        {
          "name": "Cross",
          "reason": "no synonym found"
        },
        {
          "name": "Chain",
          "reason": "no synonym found"
        },
        {
          "name": "notice",
          "reason": "no synonym found"
        },
        {
          "name": "Processes",
          "reason": "no synonym found"
        },
        {
          "name": "withdrawals",
          "reason": "no synonym found"
        },
        {
          "name": "sidechain",
          "reason": "no synonym found"
        },
        {
          "name": "mainnet",
          "reason": "no synonym found"
        },
        {
          "name": "multi",
          "reason": "no synonym found"
        },
        {
          "name": "sig",
          "reason": "no synonym found"
        },
        {
          "name": "validation",
          "reason": "no synonym found"
        },
        {
          "name": "dev",
          "reason": "no synonym found"
        },
        {
          "name": "Validators",
          "reason": "no synonym found"
        },
        {
          "name": "requests",
          "reason": "no synonym found"
        },
        {
          "name": "authorize",
          "reason": "no synonym found"
        },
        {
          "name": "transfers",
          "reason": "no synonym found"
        },
        {
          "name": "CrossChainBridge",
          "reason": "no synonym found"
        },
        {
          "name": "addresses",
          "reason": "no synonym found"
        },
        {
          "name": "validators",
          "reason": "no synonym found"
        },
        {
          "name": "requiredSignatures",
          "reason": "no synonym found"
        },
        {
          "name": "Track",
          "reason": "no synonym found"
        },
        {
          "name": "processed",
          "reason": "no synonym found"
        },
        {
          "name": "prevent",
          "reason": "no synonym found"
        },
        {
          "name": "replay",
          "reason": "no synonym found"
        },
        {
          "name": "processedWithdrawals",
          "reason": "no synonym found"
        },
        {
          "name": "Supported",
          "reason": "no synonym found"
        },
        {
          "name": "WithdrawalProcessed",
          "reason": "no synonym found"
        },
        {
          "name": "_validators",
          "reason": "no synonym found"
        },
        {
          "name": "Not",
          "reason": "no synonym found"
        },
        {
          "name": "enough",
          "reason": "no synonym found"
        },
        {
          "name": "Invalid",
          "reason": "no synonym found"
        },
        {
          "name": "Duplicate",
          "reason": "no synonym found"
        },
        {
          "name": "push",
          "reason": "no synonym found"
        },
        {
          "name": "request",
          "reason": "no synonym found"
        },
        {
          "name": "param",
          "reason": "no synonym found"
        },
        {
          "name": "Unique",
          "reason": "no synonym found"
        },
        {
          "name": "_user",
          "reason": "no synonym found"
        },
        {
          "name": "_token",
          "reason": "no synonym found"
        },
        {
          "name": "_amount",
          "reason": "no synonym found"
        },
        {
          "name": "_signatures",
          "reason": "no synonym found"
        },
        {
          "name": "Concatenated",
          "reason": "no synonym found"
        },
        {
          "name": "signatures",
          "reason": "no synonym found"
        },
        {
          "name": "already",
          "reason": "no synonym found"
        },
        {
          "name": "Already",
          "reason": "no synonym found"
        },
        {
          "name": "supported",
          "reason": "no synonym found"
        },
        {
          "name": "not",
          "reason": "no synonym found"
        },
        {
          "name": "Mark",
          "reason": "no synonym found"
        },
        {
          "name": "Reconstruct",
          "reason": "no synonym found"
        },
        {
          "name": "the",
          "reason": "no synonym found"
        },
        {
          "name": "encodePacked",
          "reason": "no synonym found"
        },
        {
          "name": "x19Ethereum",
          "reason": "no synonym found"
        },
        {
          "name": "Signed",
          "reason": "no synonym found"
        },
        {
          "name": "n32",
          "reason": "no synonym found"
        },
        {
          "name": "signers",
          "reason": "no synonym found"
        },
        {
          "name": "Extract",
          "reason": "no synonym found"
        },
        {
          "name": "and",
          "reason": "no synonym found"
        },
        {
          "name": "each",
          "reason": "no synonym found"
        },
        {
          "name": "signer",
          "reason": "no synonym found"
        },
        {
          "name": "duplicate",
          "reason": "no synonym found"
        },
        {
          "name": "All",
          "reason": "no synonym found"
        },
        {
          "name": "checks",
          "reason": "no synonym found"
        },
        {
          "name": "passed",
          "reason": "no synonym found"
        },
        {
          "name": "single",
          "reason": "no synonym found"
        },
        {
          "name": "concatenated",
          "reason": "no synonym found"
        },
        {
          "name": "_index",
          "reason": "no synonym found"
        },
        {
          "name": "offset",
          "reason": "no synonym found"
        },
        {
          "name": "_hash",
          "reason": "no synonym found"
        },
        {
          "name": "_signature",
          "reason": "no synonym found"
        },
        {
          "name": "mload",
          "reason": "no synonym found"
        },
        {
          "name": "byte",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "Bridge": "TransferBridge",
      "from": "referrer",
      "sign": "approve",
      "withdrawal": "benefitsDisbursed",
      "token": "id",
      "Validator": "Verifier",
      "isValidator": "isVerifier",
      "validatorCount": "verifierTally",
      "tokens": "credentials",
      "supportedTokens": "supportedCredentials",
      "withdrawalId": "withdrawalIdentifier",
      "user": "patient",
      "amount": "dosage",
      "length": "extent",
      "validator": "auditor",
      "Process": "Handle",
      "_withdrawalId": "_withdrawalIdentifier",
      "Token": "Credential",
      "Amount": "Dosage",
      "withdraw": "retrieveSupplies",
      "withdrawERC20For": "claimcoverageErc20For",
      "Check": "Assess",
      "Verify": "Confirm",
      "_verifySignatures": "_confirmSignatures",
      "signature": "consent",
      "signatureCount": "authorizationTally",
      "message": "alert",
      "hash": "checksum",
      "messageHash": "alertSignature",
      "ethSignedMessageHash": "ethSignedNotificationSignature",
      "Message": "Notification",
      "verify": "validate",
      "_extractSignature": "_extractAuthorization",
      "_recoverSigner": "_healSigner",
      "Recover": "Heal",
      "add": "insert",
      "value": "rating",
      "Add": "Append",
      "admin": "manager",
      "addSupportedToken": "includeSupportedCredential"
    }
  }
}