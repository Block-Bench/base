{
  "id": "gs_cei_pattern_sn_tc_007",
  "contract_file": "contracts/gs_cei_pattern_sn_tc_007.sol",
  "subset": "guardianshield",
  "ground_truth": {
    "is_vulnerable": false,
    "original_vulnerable": true,
    "vulnerability_type": "access_control",
    "neutralized_by": "cei_pattern",
    "neutralization_reason": "State updates before external calls prevent reentrancy"
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": "temporal_poly_001",
    "url": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2021-08/PolyNetwork_exp.sol",
    "date_discovered": "2021-08-10",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 149,
    "num_contracts": 2,
    "contract_names": [
      "CrossChainData",
      "CrossChainManager"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "bridge",
    "cross_chain",
    "access_control",
    "privilege_escalation",
    "proxy_bypass",
    "historical",
    "mega_hack"
  ],
  "notes": "One of the largest crypto hacks ever ($611M). Uniquely, the attacker returned most funds, suggesting white hat intentions or demonstrating vulnerability for recognition. Attacker communicated via embedded transaction messages. Classic access control bypass via proxy pattern. Demonstrates importance of restricting execution targets in proxy/manager contracts. Affected multiple chains (Ethereum, BSC, Polygon).",
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2021-08-10",
      "protocol_name": "Poly Network",
      "chain": "ethereum",
      "funds_lost_usd": 611000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous Poly Network exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_007.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_007.json",
    "original_exploit_name": "Poly Network"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_007.sol",
  "sanitized_from": "tc_007",
  "derived_from": "sn_tc_007",
  "transformation": {
    "strategy": "guardian_shield",
    "protection_type": "cei_pattern",
    "injection_details": {
      "reordered": false,
      "function": null,
      "reason": "No vulnerable function found",
      "protection_type": "cei_pattern"
    }
  }
}