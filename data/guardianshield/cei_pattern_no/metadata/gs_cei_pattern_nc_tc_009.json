{
  "id": "gs_cei_pattern_nc_tc_009",
  "contract_file": "contracts/gs_cei_pattern_nc_tc_009.sol",
  "subset": "guardianshield",
  "ground_truth": {
    "is_vulnerable": false,
    "original_vulnerable": true,
    "vulnerability_type": "integer_overflow",
    "neutralized_by": "cei_pattern",
    "neutralization_reason": "State updates before external calls prevent reentrancy"
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": "temporal_kyber_001",
    "url": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2023-11/KyberSwap_exp.eth.1.sol",
    "date_discovered": "2023-11-22",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 215,
    "num_contracts": 1,
    "contract_names": [
      "ConcentratedLiquidityPool"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "concentrated_liquidity",
    "amm",
    "precision_loss",
    "overflow",
    "tick_manipulation",
    "flash_loan",
    "multi_chain",
    "historical"
  ],
  "notes": "One of the most technically sophisticated DeFi hacks. Required deep understanding of concentrated liquidity mechanics, fixed-point arithmetic, and tick transition edge cases. Affected multiple chains simultaneously (Ethereum, Polygon, BSC, Arbitrum, Optimism). Attacker left on-chain message attempting to negotiate for control of KyberSwap in exchange for returning funds. Team rejected demand, most funds not recovered. Demonstrates complexity and risk in concentrated liquidity AMM implementations.",
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2023-11-22",
      "protocol_name": "KyberSwap Elastic",
      "chain": "ethereum",
      "funds_lost_usd": 47000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous KyberSwap Elastic exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_009.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_009.json",
    "original_exploit_name": "KyberSwap Elastic"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_009.sol",
  "sanitized_from": "tc_009",
  "derived_from": "nc_tc_009",
  "original_id": "tc_009",
  "transformation": {
    "strategy": "guardian_shield",
    "protection_type": "cei_pattern",
    "injection_details": {
      "reordered": false,
      "function": null,
      "reason": "No vulnerable function found",
      "protection_type": "cei_pattern"
    }
  }
}