{
  "id": "mr_expanded_sn_tc_028",
  "contract_file": "contracts/mr_expanded_sn_tc_028.sol",
  "subset": "mirror",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": {
        "name": "VulnerableVault",
        "functions": [
          {
            "name": "deposit",
            "vulnerability": "Doesn't check actual balance increase, credits full amount despite transfer fees"
          }
        ]
      },
      "function_name": null,
      "line_numbers": []
    },
    "root_cause": "Vault assumed tokens received equal amount transferred. Didn't check actual balance increase before/after transfer. Deflationary tokens with transfer fees caused accounting mismatch between credited amounts and actual holdings.",
    "attack_vector": "1) Deflationary token charges 10% fee on transfers. 2) Attacker deposits 100 tokens. 3) Vault receives only 90 tokens (10% burned as fee). 4) Vault credits attacker's account with full 100 tokens. 5) Attacker withdraws 100 tokens. 6) Vault sends 100 but only had 90 plus other users' funds. 7) Repeated deposits/withdrawals to drain $8.5M.",
    "impact": "Funds lost: $8,500,000",
    "correct_fix": null
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2021-05-30",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 31,
    "num_contracts": 1,
    "contract_names": [
      "TokenVault"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "deflationary_token",
    "transfer_fee",
    "vault",
    "bsc",
    "accounting"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2021-05-30",
      "protocol_name": "BVaults SafeMoon Drain",
      "chain": "binance_smart_chain",
      "funds_lost_usd": 8500000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": false,
      "likely_in_training": true,
      "exposure_notes": "Famous BVaults SafeMoon Drain exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_028.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_028.json",
    "original_exploit_name": "BVaults SafeMoon Drain"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_028.sol",
  "sanitized_from": "tc_028",
  "derived_from": "sn_tc_028",
  "transformation": {
    "strategy": "mirror",
    "mode": "expanded",
    "details": {
      "comments_removed": false,
      "blank_lines_added": 3,
      "mode": "expanded",
      "original_lines": 32,
      "transformed_lines": 35,
      "original_chars": 866,
      "transformed_chars": 869,
      "compression_ratio": 1.0
    }
  }
}