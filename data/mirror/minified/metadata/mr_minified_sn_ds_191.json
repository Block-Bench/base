{
  "id": "mr_minified_sn_ds_191",
  "contract_file": "contracts/mr_minified_sn_ds_191.sol",
  "subset": "mirror",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "Custom transferFrom function in contract VulnerableERC721, \ndoes not properly check if msg.sender is the current owner of the token or an approved address.\nAs a result, any address can call the transferFrom function to transfer any token, \nregardless of who the current owner is. \nThis allows unauthorized users to transfer tokens they do not own, leading to potential theft of assets.",
    "attack_vector": "Custom transferFrom function in contract VulnerableERC721, \ndoes not properly check if msg.sender is the current owner of the token or an approved address.\nAs a result, any address can call the transferFrom function to transfer any token, \nregardless of who the current owner is. \nThis allows unauthorized users to transfer tokens they do not own, leading to potential theft of assets.",
    "impact": "Severity: medium",
    "correct_fix": "To ensure that msg.sender is the current owner of the token or an approved address."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_nft-transfer",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 90,
    "num_contracts": 3,
    "contract_names": [
      "ContractTest",
      "VulnerableERC721",
      "FixedERC721"
    ],
    "num_functions": 9,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_3_hard",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 3,
    "difficulty_tier_name": "subtle_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "Custom transferFrom function in contract VulnerableERC721, \ndoes not properly check if msg.sender is the current owner of the token or an approved address.\nAs a result, any address can call the transferFrom function to transfer any token, \nregardless of who the current owner is. \nThis allows unauthorized users to transfer tokens they do not own, leading to potential theft of assets.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_191.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_191.json",
    "original_id": "defivulnlabs_nft-transfer"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_191.sol",
  "sanitized_from": "ds_191",
  "derived_from": "sn_ds_191",
  "transformation": {
    "strategy": "mirror",
    "mode": "minified",
    "details": {
      "comments_removed": true,
      "extreme_compression": true,
      "mode": "minified",
      "original_lines": 86,
      "transformed_lines": 2,
      "original_chars": 2219,
      "transformed_chars": 1746,
      "compression_ratio": 0.79
    }
  }
}