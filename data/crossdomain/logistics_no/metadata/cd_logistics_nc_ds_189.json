{
  "id": "cd_logistics_nc_ds_189",
  "contract_file": "contracts/cd_logistics_nc_ds_189.sol",
  "subset": "crossdomain",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "other",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "The contract ContractTest is exploiting a callback feature to bypass the maximum mint limit \nset by the MaxMint721 contract. This is achieved by triggering the onERC721Received function,\nwhich internally calls the mint function again. Therefore, although MaxMint721 attempts \nto limit the number of tokens that a user can mint to MAX_PER_USER, the ContractTest contract \nsuccessfully mints more tokens than this limit.",
    "attack_vector": "The contract ContractTest is exploiting a callback feature to bypass the maximum mint limit \nset by the MaxMint721 contract. This is achieved by triggering the onERC721Received function,\nwhich internally calls the mint function again. Therefore, although MaxMint721 attempts \nto limit the number of tokens that a user can mint to MAX_PER_USER, the ContractTest contract \nsuccessfully mints more tokens than this limit.",
    "impact": "Severity: high",
    "correct_fix": "Follow check-effect-interaction and use OpenZeppelin Reentrancy Guard."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_unprotected-callback",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 56,
    "num_contracts": 2,
    "contract_names": [
      "ContractTest",
      "MaxMint721"
    ],
    "num_functions": 3,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_3_hard",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 3,
    "difficulty_tier_name": "subtle_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "The contract ContractTest is exploiting a callback feature to bypass the maximum mint limit \nset by the MaxMint721 contract. This is achieved by triggering the onERC721Received function,\nwhich internally calls the mint function again. Therefore, although MaxMint721 attempts \nto limit the number of tokens that a user can mint to MAX_PER_USER, the ContractTest contract \nsuccessfully mints more tokens than this limit.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_189.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_189.json",
    "original_id": "defivulnlabs_unprotected-callback"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_189.sol",
  "sanitized_from": "ds_189",
  "derived_from": "nc_ds_189",
  "original_id": "ds_189",
  "transformation": {
    "strategy": "cross_domain",
    "source_domain": "defi",
    "target_domain": "logistics",
    "coverage": 0.3,
    "identifiers_transformed": 8,
    "rename_map": {
      "MaxMint721": "MaxRegistershipment721",
      "MaxMint721Contract": "MaxCreatemanifest721Contract",
      "testSafeMint": "testSafeRecordcargo",
      "mint": "registerShipment",
      "balanceOf": "goodsonhandOf",
      "MAX_PER_USER": "max_per_merchant",
      "mintIndex": "registershipmentIndex",
      "totalSupply": "warehouseCapacity"
    }
  }
}