{
  "id": "gs_reentrancy_guard_sn_gs_022",
  "contract_file": "contracts/gs_reentrancy_guard_sn_gs_022.sol",
  "subset": "guardianshield",
  "ground_truth": {
    "is_vulnerable": false,
    "original_vulnerable": true,
    "vulnerability_type": "front_running",
    "neutralized_by": "reentrancy_guard",
    "neutralization_reason": "Mutex lock prevents recursive calls during execution"
  },
  "provenance": {
    "source": "spearbit",
    "original_id": "gs_spearbit_kyber-hook_M02",
    "url": "https://github.com/spearbit/portfolio/tree/master/pdfs",
    "date_discovered": "2025-10-01",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 177,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "front_running",
    "spearbit",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "The vulnerability is that 'sender' in the digest (line 120) is the router contract address, not the actual end user who initiated the swap. Since the router is a public contract anyone can call, an MEV bot can replay the same hookData through the same router, and the signature will still be valid. The nonce is then consumed, causing the original user's transaction to fail.",
  "gold_standard_fields": {
    "source_report": "Uniswap Foundation: Kyber Hook Security Review",
    "source_finding_id": "M-02",
    "finding_title": "Quotes can be frontrun by replaying them through the router",
    "difficulty_tier": 2,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "Alice.broadcast(swap) -> MEV bot observes mempool -> Bot extracts hookData with signature -> Bot.swap(router, sameHookData) with higher gas -> Router.swap() -> PoolManager.swap() -> Hook.beforeSwap(sender=router) -> signature valid (sender is router for both) -> _useUnorderedNonce(nonce) succeeds -> Bot's swap completes -> Alice's tx executes -> _useUnorderedNonce(nonce) reverts NonceAlreadyUsed"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_022.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_022.json",
    "original_finding_title": "Quotes can be frontrun by replaying them through the router"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_022.sol",
  "sanitized_from": "gs_022",
  "derived_from": "sn_gs_022",
  "transformation": {
    "strategy": "guardian_shield",
    "protection_type": "reentrancy_guard",
    "injection_details": {
      "import_added": true,
      "inheritance_added": true,
      "functions_protected": [
        "claimEgTokens"
      ],
      "protection_type": "reentrancy_guard"
    }
  }
}