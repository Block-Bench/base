{
  "sample_id": "temporal_gamebridge_001",
  "exploit_name": "Ronin Bridge",
  "date": "2022-03-23",
  "amount_lost_usd": "625000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "centralization_key_compromise",
  "severity": "critical",
  "difficulty_tier": 4,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Ronin Bridge hack where attackers compromised 5 out of 9 validator private keys, all controlled or accessible by a single entity (Sky Mavis). With control of 5 validators, attackers forged valid signatures for fake withdrawal requests, draining $625M in ETH and USDC. The vulnerability was excessive centralization and poor key management, not a smart contract bug.",
  "vulnerable_contract": "BasicBridge",
  "vulnerable_function": "withdrawERC20For",
  "vulnerable_lines": [
    81,
    82,
    83,
    84,
    85,
    86,
    87,
    88,
    89,
    90,
    91,
    92,
    93,
    94,
    95,
    96,
    97,
    98,
    99,
    100,
    101,
    102,
    103,
    113
  ],
  "attack_scenario": "Attackers (Lazarus Group) compromised Sky Mavis infrastructure through social engineering and gained access to private keys for 4 validators directly controlled by Sky Mavis and 1 DAO validator that Sky Mavis had temporary access to. With 5 out of 9 required validator keys, attackers created fake withdrawal transactions with genuinely valid signatures. Bridge contract verified signatures (all valid), processed withdrawals, and transferred $625M to attacker addresses.",
  "root_cause": "Excessive centralization where a single entity (Sky Mavis) controlled or had access to 5 out of 9 validators - exactly the threshold needed to approve withdrawals. Poor key management practices allowed attackers to compromise all necessary keys through a single infrastructure breach. The smart contract logic was correct, but the validator setup violated the principle of decentralization that multi-sig security depends on.",
  "fix_description": "Increase total validator count significantly. Ensure no single entity controls multiple validators. Implement hardware security modules (HSMs) for key storage. Use Multi-Party Computation (MPC) threshold signatures instead of simple multi-sig. Require geographic and organizational diversity among validators. Implement real-time monitoring and anomaly detection for unusual withdrawals. Add withdrawal limits and timelocks for large amounts. Use cold wallets with delays for large reserves. Conduct regular security audits and penetration testing.",
  "tags": [
    "multi_sig",
    "key_compromise",
    "centralization",
    "access_control",
    "infrastructure",
    "historical",
    "mega_hack",
    "lazarus_group"
  ],
  "variant_type": "sanitized",
  "variant_parent_id": null,
  "notes": "Largest bridge hack in crypto history at the time. Attributed to North Korean Lazarus Group state hackers. Took 6 days before the hack was discovered. Demonstrates that smart contract security extends beyond code - key management, infrastructure security, and true decentralization are critical. The signature verification logic was perfect, but validator centralization made it useless.",
  "contract_file": "contracts/sn_tc_006.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "id": "sn_tc_006",
  "original_id": "tc_006",
  "sanitization_changes": [
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: Ronin...",
    "Removed comment: VULNERABILITY...",
    "Removed comment: // attackers can create valid signatures for fake ...",
    "Removed block comment with vulnerability hint",
    "Removed block comment with vulnerability hint",
    "Removed block comment with vulnerability hint",
    "Removed block comment with vulnerability hint",
    "Renamed: RoninBridge \u2192 RoninBridge",
    "Renamed: BasicRoninBridge \u2192 BasicBridge"
  ],
  "rename_mappings": {
    "RoninBridge": "RoninBridge",
    "BasicRoninBridge": "BasicBridge"
  }
}