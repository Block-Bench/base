{
  "id": "nc_ds_096",
  "contract_file": "contracts/nc_ds_096.sol",
  "subset": "nocomments",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "denial_of_service",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "ContractTest",
      "function_name": "multiple",
      "line_numbers": []
    },
    "root_cause": "The KingOfEther contract holds a game where a user can claim the throne by sending more Ether than the current balance. \nThe contract attempts to return the previous balance to the last \"king\" when a new user sends more Ether. However,\nthis mechanism can be exploited. An attacker's contract (here, the Attack contract) can become the king \nand then make the fallback function revert or consume more than the stipulated gas limit, \ncausing the claimThrone function to fail whenever the KingOfEther contract tries to return Ether to the last king.",
    "attack_vector": "The KingOfEther contract holds a game where a user can claim the throne by sending more Ether than the current balance. \nThe contract attempts to return the previous balance to the last \"king\" when a new user sends more Ether. However,\nthis mechanism can be exploited. An attacker's contract (here, the Attack contract) can become the king \nand then make the fallback function revert or consume more than the stipulated gas limit, \ncausing the claimThrone function to fail whenever the KingOfEther contract tries to return Ether to the last king.",
    "impact": "Severity: medium",
    "correct_fix": "Use a Pull payment pattern, A way to prevent this is to enable users to withdraw their Ether, instead of sending it to them."
  },
  "provenance": {
    "source": "other",
    "original_id": "defivulnlabs_dos",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.18",
    "num_lines": 70,
    "num_contracts": 3,
    "contract_names": [
      "ContractTest",
      "KingOfEther",
      "Attack"
    ],
    "num_functions": 4,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "defivulnlabs",
    "tier_2_medium",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 2,
    "difficulty_tier_name": "clear_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "The KingOfEther contract holds a game where a user can claim the throne by sending more Ether than the current balance. \nThe contract attempts to return the previous balance to the last \"king\" when a new user sends more Ether. However,\nthis mechanism can be exploited. An attacker's contract (here, the Attack contract) can become the king \nand then make the fallback function revert or consume more than the stipulated gas limit, \ncausing the claimThrone function to fail whenever the KingOfEther contract tries to return Ether to the last king.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_096.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_096.json",
    "original_id": "defivulnlabs_dos"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_096.sol",
  "sanitized_from": "ds_096",
  "derived_from": "sn_ds_096",
  "original_id": "ds_096"
}