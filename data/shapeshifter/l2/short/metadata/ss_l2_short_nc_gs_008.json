{
  "id": "ss_l2_short_nc_gs_008",
  "contract_file": "contracts/ss_l2_short_nc_gs_008.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GovernanceHYBR",
      "function_name": "bd",
      "line_numbers": [
        370
      ]
    },
    "root_cause": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
    "attack_vector": "A test votes on pools, warps time, and `claimRewards()` reverts due to invalid getter call.",
    "impact": "Severity: medium",
    "correct_fix": "Add `getPoolVote(veTokenId)` in `VoterV3.sol` to return the array. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M07",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 636,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Incorrect interface usage treats mapping as function, causing revert on reward claims.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-07",
    "finding_title": "Claiming rewards in GovernanceHYBR will always revert",
    "difficulty_tier": 1,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "claimRewards() -> IVoter.poolVote(veTokenId) [invalid call] -> revert"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_008.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_008.json",
    "original_finding_title": "Claiming rewards in GovernanceHYBR will always revert"
  },
  "original_subset": "gold_standard",
  "context": "context/gs_008/",
  "context_files": [
    "context_01_VoterV3.sol"
  ],
  "original_contract_file": "base/contracts/gs_008.sol",
  "sanitized_from": "gs_008",
  "derived_from": "nc_gs_008",
  "original_id": "gs_008",
  "identifier_mappings": {
    "setTailNotWithdrawTime": "a",
    "setHeadNotWithdrawTime": "b",
    "tail_not_withdraw_time": "c",
    "head_not_withdraw_time": "d",
    "setRewardsDistributor": "e",
    "setTransferLockPeriod": "f",
    "receivePenaltyReward": "g",
    "increase_unlock_time": "h",
    "_beforeTokenTransfer": "i",
    "_rewardsDistributor": "j",
    "transferLockPeriod": "k",
    "rewardsDistributor": "l",
    "rewardsListLength": "m",
    "_initializeVeNFT": "n",
    "currentAvailable": "o",
    "_addTransferLock": "p",
    "_extendLockToMax": "q",
    "previewAvailable": "r",
    "lastCompoundTime": "s",
    "safeTransferFrom": "t",
    "setGaugeManager": "u",
    "create_lock_for": "v",
    "external_bribes": "w",
    "emergencyUnlock": "x",
    "calculateAssets": "y",
    "internal_bribes": "z",
    "remainingAmount": "aa",
    "calculateShares": "ab",
    "finalAvailable": "ac",
    "lastRebaseTime": "ad",
    "setWithdrawFee": "ae",
    "sharesReceived": "af",
    "newTotalLocked": "ag",
    "getLockEndTime": "ah",
    "maxUnlockTime": "ai",
    "externalBribe": "aj",
    "lockedBalance": "ak",
    "internalBribe": "al",
    "_votingEscrow": "am",
    "lastVoteEpoch": "an",
    "currentLocked": "ao",
    "_cleanExpired": "ap",
    "initialAmount": "aq",
    "_gaugeManager": "ar",
    "_totalAssets": "as",
    "onlyOperator": "at",
    "gaugeManager": "au",
    "totalBalance": "av",
    "votingEscrow": "aw",
    "_totalSupply": "ax",
    "nonReentrant": "ay",
    "getUserLocks": "az",
    "transferFrom": "ba",
    "tokenBalance": "bb",
    "rebaseAmount": "bc",
    "claimRewards": "bd",
    "hybrReceived": "be",
    "deposit_for": "bf",
    "withdrawFee": "bg",
    "executeSwap": "bh",
    "userTokenId": "bi",
    "newTokenIds": "bj",
    "setOperator": "bk",
    "safeApprove": "bl",
    "votingYield": "bm",
    "isPermanent": "bn",
    "totalSupply": "bo",
    "totalAssets": "bp",
    "claimBribes": "bq",
    "newOperator": "br",
    "oldOperator": "bs",
    "bribeTokens": "bt",
    "hybrBalance": "bu",
    "oldSwapper": "bv",
    "tokenCount": "bw",
    "multiSplit": "bx",
    "swapToHYBR": "by",
    "newSwapper": "bz",
    "votedPools": "ca",
    "hybrAmount": "cb",
    "setSwapper": "cc",
    "unlockTime": "cd",
    "epochStart": "ce",
    "feeTokenId": "cf",
    "userAmount": "cg",
    "veBalance": "ch",
    "oldPeriod": "ci",
    "recipient": "cj",
    "available": "ck",
    "_operator": "cl",
    "epochNext": "cm",
    "onlyOwner": "cn",
    "feeAmount": "co",
    "balanceOf": "cp",
    "userLocks": "cq",
    "veTokenId": "cr",
    "_poolVote": "cs",
    "newPeriod": "ct",
    "_weights": "cu",
    "setVoter": "cv",
    "amountIn": "cw",
    "_swapper": "cx",
    "withdraw": "cy",
    "poolVote": "cz",
    "lockTime": "da",
    "operator": "db",
    "compound": "dc",
    "_period": "dd",
    "swapper": "de",
    "approve": "df",
    "penalty": "dg",
    "amounts": "dh",
    "setTeam": "di",
    "rewards": "dj",
    "deposit": "dk",
    "weights": "dl",
    "tokenIn": "dm",
    "_params": "dn",
    "enabled": "do",
    "gauges": "dp",
    "rebase": "dq",
    "bribes": "dr",
    "tokens": "ds",
    "shares": "dt",
    "locked": "du",
    "amount": "dv",
    "_voter": "dw",
    "owner": "dx",
    "pools": "dy",
    "reset": "dz",
    "claim": "ea",
    "write": "eb",
    "freed": "ec",
    "voter": "ed",
    "gauge": "ee",
    "voted": "ef",
    "_team": "eg",
    "_time": "eh",
    "epoch": "ei",
    "_burn": "ej",
    "_mint": "ek",
    "_HYBR": "el",
    "user": "em",
    "vote": "en",
    "_fee": "eo",
    "len": "ep",
    "max": "eq",
    "fee": "er",
    "arr": "es",
    "end": "et",
    "to": "eu"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l2",
    "variant": "short",
    "source": "nocomments",
    "changes": [
      "Renamed 151 identifiers using short style"
    ],
    "rename_map_size": 151,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: claimRewards \u2192 bd"
    ]
  }
}