{
  "id": "ss_l2_short_nc_gs_006",
  "contract_file": "contracts/ss_l2_short_nc_gs_006.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GaugeCL",
      "function_name": "j",
      "line_numbers": [
        251
      ]
    },
    "root_cause": "The `notifyRewardAmount()` function miscalculates the `rewardRate` when a new epoch begins, causing `rollover` rewards from previous epochs to be permanently lost. When `block.timestamp >= _periodFinish`, the function adds both the new `rewardAmount` and the previous epoch\u2019s `clPool.rollover()` to form the `totalRewardAmount`. However, the `rewardRate` is derived only from `rewardAmount`, ignoring the rollover portion: // @audit The total amount to be reserved includes rollover... uint256 totalRewardAmount = rewardAmount + clPool.rollover(); // @audit but the rate calculation completely ignores the rollover. rewardRate = rewardAmount / epochTimeRemaining; // @audit The pool is synced with a CORRECT",
    "attack_vector": "Refer to original submission for PoC (not detailed here).",
    "impact": "Severity: medium",
    "correct_fix": "Use `totalRewardAmount = rewardAmount + clPool.rollover()` for `rewardRate = totalRewardAmount / epochTimeRemaining`. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M05",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 372,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Reward rate calculation excludes rollover amounts, leading to permanent loss of carried-over rewards in new epochs.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-05",
    "finding_title": "Rollover rewards are permanently lost due to flawed rewardRate calculation",
    "difficulty_tier": 2,
    "context_level": "single_file",
    "has_context": false,
    "call_flow": "notifyRewardAmount(new reward) -> rollover() added to total but ignored in rewardRate -> stranded rewards overwritten"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_006.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_006.json",
    "original_finding_title": "Rollover rewards are permanently lost due to flawed rewardRate calculation"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_006.sol",
  "sanitized_from": "gs_006",
  "derived_from": "nc_gs_006",
  "original_id": "gs_006",
  "identifier_mappings": {
    "rewardPerTokenInsideInitialX128": "a",
    "nonfungiblePositionManager": "b",
    "updateRewardsGrowthGlobal": "c",
    "rewardPerTokenInsideX128": "d",
    "depostionEmissionsToken": "e",
    "rewardGrowthGlobalX128": "f",
    "activateEmergencyMode": "g",
    "getRewardGrowthInside": "h",
    "encodeWithSelector": "i",
    "notifyRewardAmount": "j",
    "rewardGrowthInside": "k",
    "epochTimeRemaining": "l",
    "rewardRateByEpoch": "m",
    "totalRewardAmount": "n",
    "stopEmergencyMode": "o",
    "epochEndTimestamp": "p",
    "rewardForDuration": "q",
    "onlyDistribution": "r",
    "setInternalBribe": "s",
    "liquidityToStake": "t",
    "safeTransferFrom": "u",
    "onERC721Received": "v",
    "stakedLiquidity": "w",
    "_external_bribe": "x",
    "_getPoolAddress": "y",
    "contractBalance": "z",
    "_internal_bribe": "aa",
    "lastUpdateTime": "ab",
    "pendingRewards": "ac",
    "external_bribe": "ad",
    "isNotEmergency": "ae",
    "internal_bribe": "af",
    "_updateRewards": "ag",
    "_periodFinish": "ah",
    "gaugeBalances": "ai",
    "rewardReserve": "aj",
    "_distribution": "ak",
    "_safeTransfer": "al",
    "_rewardToken": "am",
    "nonReentrant": "an",
    "positionPool": "ao",
    "rewardGrowth": "ap",
    "rewardAmount": "aq",
    "periodFinish": "ar",
    "lastUpdated": "as",
    "rewardToken": "at",
    "poolAddress": "au",
    "collectFees": "av",
    "currentRate": "aw",
    "safeApprove": "ax",
    "tickSpacing": "ay",
    "_isForPair": "az",
    "epochStart": "ba",
    "_claimFees": "bb",
    "_getReward": "bc",
    "redeemType": "bd",
    "rewardRate": "be",
    "amount1Max": "bf",
    "syncReward": "bg",
    "amount0Max": "bh",
    "positions": "bi",
    "epochNext": "bj",
    "claimable": "bk",
    "getReward": "bl",
    "tickUpper": "bm",
    "redeemFor": "bn",
    "claimFees": "bo",
    "recipient": "bp",
    "emergency": "bq",
    "onlyOwner": "br",
    "liquidity": "bs",
    "gaugeFees": "bt",
    "tickLower": "bu",
    "isForPair": "bv",
    "balanceOf": "bw",
    "timeDelta": "bx",
    "operator": "by",
    "_factory": "bz",
    "withdraw": "ca",
    "rollover": "cb",
    "claimed0": "cc",
    "claimed1": "cd",
    "contains": "ce",
    "_token1": "cf",
    "collect": "cg",
    "deposit": "ch",
    "_token0": "ci",
    "getPool": "cj",
    "success": "ck",
    "_earned": "cl",
    "_stakes": "cm",
    "rewards": "cn",
    "tokenId": "co",
    "factory": "cp",
    "account": "cq",
    "amount": "cr",
    "reward": "cs",
    "_fees1": "ct",
    "mulDiv": "cu",
    "_rHYBR": "cv",
    "decode": "cw",
    "token0": "cx",
    "_fees0": "cy",
    "remove": "cz",
    "earned": "da",
    "clPool": "db",
    "token1": "dc",
    "_pool": "dd",
    "token": "de",
    "rHYBR": "df",
    "gauge": "dg",
    "stake": "dh",
    "_int": "di",
    "user": "dj",
    "nfpm": "dk",
    "_ve": "dl",
    "add": "dm",
    "max": "dn",
    "to": "do"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l2",
    "variant": "short",
    "source": "nocomments",
    "changes": [
      "Renamed 119 identifiers using short style"
    ],
    "rename_map_size": 119,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: notifyRewardAmount \u2192 j"
    ]
  }
}