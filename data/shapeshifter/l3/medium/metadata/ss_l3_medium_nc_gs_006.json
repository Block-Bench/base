{
  "id": "ss_l3_medium_nc_gs_006",
  "contract_file": "contracts/ss_l3_medium_nc_gs_006.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GaugeCL",
      "function_name": "_0x13e31c",
      "line_numbers": []
    },
    "root_cause": "The `notifyRewardAmount()` function miscalculates the `rewardRate` when a new epoch begins, causing `rollover` rewards from previous epochs to be permanently lost. When `block.timestamp >= _periodFinish`, the function adds both the new `rewardAmount` and the previous epoch\u2019s `clPool.rollover()` to form the `totalRewardAmount`. However, the `rewardRate` is derived only from `rewardAmount`, ignoring the rollover portion: // @audit The total amount to be reserved includes rollover... uint256 totalRewardAmount = rewardAmount + clPool.rollover(); // @audit but the rate calculation completely ignores the rollover. rewardRate = rewardAmount / epochTimeRemaining; // @audit The pool is synced with a CORRECT",
    "attack_vector": "Refer to original submission for PoC (not detailed here).",
    "impact": "Severity: medium",
    "correct_fix": "Use `totalRewardAmount = rewardAmount + clPool.rollover()` for `rewardRate = totalRewardAmount / epochTimeRemaining`. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M05",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 372,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Reward rate calculation excludes rollover amounts, leading to permanent loss of carried-over rewards in new epochs.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-05",
    "finding_title": "Rollover rewards are permanently lost due to flawed rewardRate calculation",
    "difficulty_tier": 2,
    "context_level": "single_file",
    "has_context": false,
    "call_flow": "notifyRewardAmount(new reward) -> rollover() added to total but ignored in rewardRate -> stranded rewards overwritten"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_006.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_006.json",
    "original_finding_title": "Rollover rewards are permanently lost due to flawed rewardRate calculation"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_006.sol",
  "sanitized_from": "gs_006",
  "derived_from": "nc_gs_006",
  "original_id": "gs_006",
  "identifier_mappings": {
    "rewardPerTokenInsideInitialX128": "_0x78e302",
    "nonfungiblePositionManager": "_0x323db7",
    "updateRewardsGrowthGlobal": "_0xfd5cf8",
    "rewardPerTokenInsideX128": "_0x24758b",
    "depostionEmissionsToken": "_0x284e78",
    "rewardGrowthGlobalX128": "_0x9a870f",
    "activateEmergencyMode": "_0x31b75a",
    "getRewardGrowthInside": "_0x6b7231",
    "epochTimeRemaining": "_0x68ee92",
    "notifyRewardAmount": "_0x13e31c",
    "rewardGrowthInside": "_0x2825a7",
    "encodeWithSelector": "_0x61b35e",
    "totalRewardAmount": "_0x63fefa",
    "stopEmergencyMode": "_0xf1baf5",
    "rewardForDuration": "_0x4a9613",
    "rewardRateByEpoch": "_0xb1a810",
    "epochEndTimestamp": "_0x4facd7",
    "onERC721Received": "_0xbbde4b",
    "onlyDistribution": "_0xf1a89b",
    "liquidityToStake": "_0x78f9ab",
    "setInternalBribe": "_0x4ac419",
    "safeTransferFrom": "_0x1c176e",
    "_getPoolAddress": "_0x446af1",
    "_internal_bribe": "_0x733d3d",
    "contractBalance": "_0xbe6103",
    "stakedLiquidity": "_0x2ceef0",
    "_external_bribe": "_0x40f901",
    "external_bribe": "_0x70d304",
    "pendingRewards": "_0x847c25",
    "isNotEmergency": "_0xc92217",
    "internal_bribe": "_0xdebf24",
    "lastUpdateTime": "_0xebeeaf",
    "_updateRewards": "_0xe7491d",
    "_safeTransfer": "_0x776cb2",
    "rewardReserve": "_0x29d7a5",
    "gaugeBalances": "_0xa192b4",
    "_periodFinish": "_0x4d9235",
    "_distribution": "_0x3eea07",
    "positionPool": "_0x54aed3",
    "rewardGrowth": "_0x7ee89d",
    "_rewardToken": "_0x8e5f9f",
    "nonReentrant": "_0xd10f3c",
    "periodFinish": "_0xd15aa9",
    "rewardAmount": "_0xb24aae",
    "collectFees": "_0xd8fe51",
    "safeApprove": "_0xa348f4",
    "tickSpacing": "_0x86f355",
    "lastUpdated": "_0x02b6f8",
    "currentRate": "_0xd1e339",
    "poolAddress": "_0x354108",
    "rewardToken": "_0x5deb8a",
    "redeemType": "_0xc025a0",
    "rewardRate": "_0x485476",
    "_getReward": "_0xaa9c33",
    "amount1Max": "_0x7c9fcf",
    "_isForPair": "_0xdf7f38",
    "amount0Max": "_0xca4b45",
    "syncReward": "_0x02b208",
    "_claimFees": "_0x3e3672",
    "epochStart": "_0x64ae38",
    "liquidity": "_0x9aff2b",
    "balanceOf": "_0x506a34",
    "claimFees": "_0x0b3520",
    "claimable": "_0xe4ee0e",
    "emergency": "_0xd52d96",
    "redeemFor": "_0x9f6e0a",
    "recipient": "_0xd94e73",
    "epochNext": "_0x402445",
    "positions": "_0x95f0a5",
    "tickUpper": "_0x6e38e1",
    "onlyOwner": "_0x4ffb3c",
    "isForPair": "_0xdb57b0",
    "gaugeFees": "_0xaac0c7",
    "timeDelta": "_0xe709d7",
    "tickLower": "_0xaa9a5e",
    "getReward": "_0x6ebaf7",
    "withdraw": "_0x3678e5",
    "_factory": "_0x59abcc",
    "claimed1": "_0xa9afe7",
    "claimed0": "_0x629e04",
    "rollover": "_0x02b5e9",
    "operator": "_0xffe889",
    "contains": "_0x5d9200",
    "tokenId": "_0x443b5c",
    "_stakes": "_0x19b6ab",
    "account": "_0x19f0c6",
    "collect": "_0x3094ff",
    "getPool": "_0xb90215",
    "rewards": "_0xe38dda",
    "_token1": "_0x547b2e",
    "_earned": "_0x31c153",
    "success": "_0x45eb14",
    "factory": "_0x835570",
    "deposit": "_0x1344e8",
    "_token0": "_0x00561b",
    "clPool": "_0x86ac98",
    "reward": "_0x3d1655",
    "earned": "_0x87715b",
    "token0": "_0x159d78",
    "_rHYBR": "_0x4899d9",
    "_fees1": "_0xe6ddd4",
    "token1": "_0x2b27e8",
    "remove": "_0x696b98",
    "_fees0": "_0xe4531b",
    "amount": "_0x98c271",
    "decode": "_0x7820ef",
    "mulDiv": "_0xd9ee89",
    "rHYBR": "_0x12aa4e",
    "token": "_0x01636d",
    "_pool": "_0x4cac60",
    "gauge": "_0xded2f1",
    "stake": "_0x6e667c",
    "_int": "_0xf7ee81",
    "user": "_0x838b2c",
    "nfpm": "_0x1c0840",
    "_ve": "_0xe2180c",
    "max": "_0x22d1f6",
    "add": "_0xed8a00",
    "to": "_0x847eba"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 119 identifiers using hex style"
    ],
    "rename_map_size": 119,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: notifyRewardAmount \u2192 _0x13e31c"
    ]
  }
}