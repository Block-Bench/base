{
  "id": "ss_l3_medium_nc_gs_007",
  "contract_file": "contracts/ss_l3_medium_nc_gs_007.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GaugeCL",
      "function_name": "_0xa93810",
      "line_numbers": []
    },
    "root_cause": "_claimFees() sweeps the entire balance of `token0`/`token1` after `collectFees()`, stealing rewards if `rewardToken` matches `token0` or `token1`. Impact: Bribe contract receives staking rewards instead of fees.",
    "attack_vector": "A test deposits 10 HYBR rewards, adds 0.1 HYBR fees, and `claimFees()` sweeps all 10.1 HYBR to the bribe contract.",
    "impact": "Severity: medium",
    "correct_fix": "Transfer only the difference in balance before/after `collectFees()`; add access control to `claimFees`. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M06",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 372,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Fee claiming sweeps all token balances, including unrelated staking rewards, to the bribe recipient.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-06",
    "finding_title": "ClaimFees steals staking rewards",
    "difficulty_tier": 2,
    "context_level": "single_file",
    "has_context": false,
    "call_flow": "collectFees() -> _claimFees() -> transfer full balance to bribe (includes rewards)"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_007.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_007.json",
    "original_finding_title": "ClaimFees steals staking rewards"
  },
  "original_subset": "gold_standard",
  "original_contract_file": "base/contracts/gs_007.sol",
  "sanitized_from": "gs_007",
  "derived_from": "nc_gs_007",
  "original_id": "gs_007",
  "identifier_mappings": {
    "rewardPerTokenInsideInitialX128": "_0x484021",
    "nonfungiblePositionManager": "_0x3f40d3",
    "updateRewardsGrowthGlobal": "_0x45be72",
    "rewardPerTokenInsideX128": "_0xc6462f",
    "depostionEmissionsToken": "_0xc6ffb9",
    "rewardGrowthGlobalX128": "_0x05c282",
    "getRewardGrowthInside": "_0xcfa31c",
    "activateEmergencyMode": "_0x195724",
    "encodeWithSelector": "_0x80ac61",
    "rewardGrowthInside": "_0x4ddd53",
    "notifyRewardAmount": "_0xe79ddb",
    "epochTimeRemaining": "_0xe1ebb4",
    "stopEmergencyMode": "_0x94c8fb",
    "rewardRateByEpoch": "_0x2436a6",
    "epochEndTimestamp": "_0xf077ac",
    "totalRewardAmount": "_0x487d4a",
    "rewardForDuration": "_0x82a20e",
    "safeTransferFrom": "_0x4c4d35",
    "liquidityToStake": "_0x16d27c",
    "onERC721Received": "_0x08870d",
    "setInternalBribe": "_0xc7cd8d",
    "onlyDistribution": "_0x6fec85",
    "contractBalance": "_0x2784bf",
    "stakedLiquidity": "_0xebedef",
    "_internal_bribe": "_0x1f0818",
    "_external_bribe": "_0x6a8598",
    "_getPoolAddress": "_0xcadec1",
    "pendingRewards": "_0xfb1495",
    "lastUpdateTime": "_0xde5dd6",
    "internal_bribe": "_0x95e6cc",
    "_updateRewards": "_0xd21056",
    "external_bribe": "_0xdb6ea5",
    "isNotEmergency": "_0xdba6d8",
    "_safeTransfer": "_0xfab9fe",
    "gaugeBalances": "_0x5e1d01",
    "rewardReserve": "_0x638181",
    "_distribution": "_0x580f9b",
    "_periodFinish": "_0x928aec",
    "_rewardToken": "_0x42dcf2",
    "rewardAmount": "_0x8fb404",
    "periodFinish": "_0xfbb3ae",
    "nonReentrant": "_0x50c90d",
    "positionPool": "_0xc5877d",
    "rewardGrowth": "_0x1f28dc",
    "collectFees": "_0x29a1a8",
    "poolAddress": "_0xe7235c",
    "safeApprove": "_0x98b79c",
    "currentRate": "_0x650fdc",
    "lastUpdated": "_0xc016e5",
    "tickSpacing": "_0x86aab2",
    "rewardToken": "_0x73ff6d",
    "_claimFees": "_0xa93810",
    "_getReward": "_0x5446fe",
    "_isForPair": "_0xf26adc",
    "rewardRate": "_0xb78242",
    "amount1Max": "_0x878a8b",
    "redeemType": "_0x273da4",
    "epochStart": "_0x4b612c",
    "syncReward": "_0x5121e0",
    "amount0Max": "_0x79e2d2",
    "onlyOwner": "_0x6a0070",
    "emergency": "_0x153dd9",
    "timeDelta": "_0x9d23b1",
    "tickLower": "_0x758e02",
    "positions": "_0xe5f64b",
    "gaugeFees": "_0x135e1f",
    "isForPair": "_0xdef549",
    "liquidity": "_0xe2e5f1",
    "claimable": "_0xe21830",
    "claimFees": "_0xba8c33",
    "getReward": "_0x9ee91c",
    "epochNext": "_0xe9dbd4",
    "recipient": "_0x5a96ef",
    "tickUpper": "_0xde6387",
    "balanceOf": "_0xde5c17",
    "redeemFor": "_0x6ce6ad",
    "rollover": "_0x34f838",
    "claimed0": "_0xbbaeb7",
    "_factory": "_0x2a70bb",
    "claimed1": "_0xe19510",
    "operator": "_0xd2a4c5",
    "withdraw": "_0x851f6c",
    "contains": "_0xecaadf",
    "_earned": "_0xe1e196",
    "rewards": "_0xc3a213",
    "_token0": "_0xb4a39c",
    "_stakes": "_0xc26a1b",
    "account": "_0x0f2f02",
    "_token1": "_0xca5c7b",
    "tokenId": "_0xbb1bba",
    "deposit": "_0x6d3a47",
    "success": "_0xcfca34",
    "getPool": "_0x49db96",
    "factory": "_0x12a7e8",
    "collect": "_0xd37161",
    "remove": "_0xb7b21d",
    "earned": "_0x51ccf2",
    "mulDiv": "_0x731a84",
    "_fees0": "_0x133cae",
    "token0": "_0x9e88b3",
    "reward": "_0xe25faa",
    "_fees1": "_0x39a3bf",
    "amount": "_0xc6d15a",
    "decode": "_0x7d464b",
    "token1": "_0x7fc581",
    "_rHYBR": "_0x1cb588",
    "clPool": "_0x0871bf",
    "token": "_0xf819a3",
    "_pool": "_0xc49fc4",
    "rHYBR": "_0xfdcc24",
    "stake": "_0x01c767",
    "gauge": "_0x87e349",
    "_int": "_0x7cebc3",
    "user": "_0x6aa0a5",
    "nfpm": "_0x75fc83",
    "add": "_0x4ccbed",
    "_ve": "_0xf01642",
    "max": "_0x82b7c1",
    "to": "_0x1894c2"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 119 identifiers using hex style",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 119,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: _claimFees \u2192 _0xa93810"
    ]
  }
}