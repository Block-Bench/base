{
  "id": "ss_l3_medium_sn_gs_008",
  "contract_file": "contracts/ss_l3_medium_sn_gs_008.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GovernanceHYBR",
      "function_name": "_0x33314b",
      "line_numbers": []
    },
    "root_cause": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
    "attack_vector": "A test votes on pools, warps time, and `claimRewards()` reverts due to invalid getter call.",
    "impact": "Severity: medium",
    "correct_fix": "Add `getPoolVote(veTokenId)` in `VoterV3.sol` to return the array. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M07",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 636,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Incorrect interface usage treats mapping as function, causing revert on reward claims.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-07",
    "finding_title": "Claiming rewards in GovernanceHYBR will always revert",
    "difficulty_tier": 1,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "claimRewards() -> IVoter.poolVote(veTokenId) [invalid call] -> revert"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_008.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_008.json",
    "original_finding_title": "Claiming rewards in GovernanceHYBR will always revert"
  },
  "original_subset": "gold_standard",
  "context": "context/gs_008/",
  "context_files": [
    "context_01_VoterV3.sol"
  ],
  "original_contract_file": "base/contracts/gs_008.sol",
  "sanitized_from": "gs_008",
  "identifier_mappings": {
    "tail_not_withdraw_time": "_0x147518",
    "head_not_withdraw_time": "_0x07f6cd",
    "setHeadNotWithdrawTime": "_0x583220",
    "setTailNotWithdrawTime": "_0x524748",
    "setTransferLockPeriod": "_0x195d72",
    "setRewardsDistributor": "_0xb4f9ee",
    "increase_unlock_time": "_0xbda1ee",
    "receivePenaltyReward": "_0xc19a4e",
    "_beforeTokenTransfer": "_0x08b39f",
    "_rewardsDistributor": "_0x37e99b",
    "transferLockPeriod": "_0xf3ce84",
    "rewardsDistributor": "_0x3551b4",
    "rewardsListLength": "_0x1e51c0",
    "safeTransferFrom": "_0xed2320",
    "_initializeVeNFT": "_0x0b0e0e",
    "_extendLockToMax": "_0xd95f17",
    "_addTransferLock": "_0x284a2b",
    "currentAvailable": "_0x976df1",
    "lastCompoundTime": "_0xbb6bad",
    "previewAvailable": "_0xa0bf04",
    "emergencyUnlock": "_0xdf72ab",
    "remainingAmount": "_0x517507",
    "internal_bribes": "_0xc5f5bb",
    "calculateAssets": "_0x1d8b22",
    "setGaugeManager": "_0xa71f4d",
    "external_bribes": "_0x5c7d8e",
    "calculateShares": "_0xfdf9da",
    "create_lock_for": "_0xb2e877",
    "lastRebaseTime": "_0x8c5de0",
    "getLockEndTime": "_0xd282a7",
    "newTotalLocked": "_0xc78958",
    "setWithdrawFee": "_0x0d63b4",
    "finalAvailable": "_0x1a44ca",
    "sharesReceived": "_0x5660f6",
    "_cleanExpired": "_0x769871",
    "externalBribe": "_0xb82a34",
    "maxUnlockTime": "_0x20fb03",
    "initialAmount": "_0xc08880",
    "currentLocked": "_0x6e42e7",
    "lockedBalance": "_0xafd5f6",
    "_votingEscrow": "_0x237ef3",
    "internalBribe": "_0x9f2a86",
    "_gaugeManager": "_0xff2474",
    "lastVoteEpoch": "_0xc1055f",
    "claimRewards": "_0x33314b",
    "_totalSupply": "_0xa8606d",
    "hybrReceived": "_0x6b72ca",
    "transferFrom": "_0x963b5b",
    "tokenBalance": "_0x5c6560",
    "getUserLocks": "_0xfdd06c",
    "_totalAssets": "_0x3a4542",
    "totalBalance": "_0xf6e1f6",
    "nonReentrant": "_0xe49643",
    "onlyOperator": "_0x4e86eb",
    "rebaseAmount": "_0xf4b619",
    "votingEscrow": "_0x3aef25",
    "gaugeManager": "_0xc9f353",
    "newOperator": "_0xbb9443",
    "hybrBalance": "_0x31385d",
    "withdrawFee": "_0x11a33b",
    "oldOperator": "_0xcca464",
    "totalAssets": "_0x143a99",
    "executeSwap": "_0x55aba6",
    "totalSupply": "_0xd4f8a5",
    "deposit_for": "_0xa79387",
    "setOperator": "_0x95923c",
    "votingYield": "_0x969152",
    "safeApprove": "_0x9d9e10",
    "isPermanent": "_0xc18e9b",
    "newTokenIds": "_0x574dcc",
    "userTokenId": "_0x6fd1fe",
    "claimBribes": "_0xbc9d8b",
    "bribeTokens": "_0x9a1231",
    "multiSplit": "_0x6f1bfa",
    "votedPools": "_0x9783a2",
    "feeTokenId": "_0xf5c9d8",
    "tokenCount": "_0x1b1cfd",
    "userAmount": "_0xbc8205",
    "epochStart": "_0x06c01c",
    "oldSwapper": "_0xef2221",
    "hybrAmount": "_0x98ccec",
    "unlockTime": "_0x9363be",
    "newSwapper": "_0x548384",
    "setSwapper": "_0x5c6a73",
    "swapToHYBR": "_0xcf3e7e",
    "epochNext": "_0xe12a1f",
    "oldPeriod": "_0x5408c1",
    "userLocks": "_0xeff5bd",
    "veTokenId": "_0x5d0f3a",
    "feeAmount": "_0xe6db98",
    "balanceOf": "_0x8c15aa",
    "_operator": "_0x462819",
    "_poolVote": "_0x2e01ca",
    "onlyOwner": "_0xa4c1cc",
    "recipient": "_0x6a3aa2",
    "veBalance": "_0x4c3aa6",
    "available": "_0xe9ac87",
    "newPeriod": "_0x4a5fb7",
    "setVoter": "_0xeb4d12",
    "lockTime": "_0x44afc8",
    "operator": "_0x35ee12",
    "_weights": "_0xf8f138",
    "withdraw": "_0xc25c5e",
    "compound": "_0x86f186",
    "_swapper": "_0x567ee2",
    "poolVote": "_0xea6a54",
    "amountIn": "_0xf8b62e",
    "tokenIn": "_0xfd5548",
    "weights": "_0xb99573",
    "_period": "_0x28e0ec",
    "amounts": "_0x00424f",
    "approve": "_0x7d010f",
    "deposit": "_0x4279ae",
    "swapper": "_0xc9c23f",
    "rewards": "_0xb227c8",
    "enabled": "_0x328a7b",
    "setTeam": "_0xcd7437",
    "penalty": "_0xdafa73",
    "_params": "_0x4511b1",
    "rebase": "_0x6266cf",
    "shares": "_0xe87dba",
    "gauges": "_0x375bdc",
    "amount": "_0x51bb33",
    "bribes": "_0xb7eb4a",
    "locked": "_0xb47ccc",
    "tokens": "_0x4f12db",
    "_voter": "_0x40c4d1",
    "claim": "_0x28b147",
    "gauge": "_0x048169",
    "_mint": "_0xd62c64",
    "write": "_0x9cbf1a",
    "reset": "_0xc68751",
    "_time": "_0x51178c",
    "_burn": "_0x48fb30",
    "epoch": "_0x45bb81",
    "_HYBR": "_0x6f6a28",
    "voted": "_0x20e174",
    "owner": "_0xe02b47",
    "pools": "_0x211a11",
    "voter": "_0x77017c",
    "freed": "_0xcee478",
    "_team": "_0xf8bec3",
    "_fee": "_0x15b9b9",
    "vote": "_0xeac4ea",
    "user": "_0xae94a9",
    "len": "_0xdbcef7",
    "max": "_0x2a24e5",
    "end": "_0xaa5b3f",
    "fee": "_0x3aeee4",
    "arr": "_0x139867",
    "to": "_0x98a5e2"
  },
  "derived_from": "sn_gs_008",
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "sanitized",
    "changes": [
      "Renamed 151 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 151,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: claimRewards \u2192 _0x33314b"
    ]
  }
}