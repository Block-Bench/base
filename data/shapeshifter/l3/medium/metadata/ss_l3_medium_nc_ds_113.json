{
  "id": "ss_l3_medium_nc_ds_113",
  "contract_file": "contracts/ss_l3_medium_nc_ds_113.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "reentrancy",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "TokenInterface",
      "function_name": "_0xf51878",
      "line_numbers": []
    },
    "root_cause": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "attack_vector": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "impact": "Severity: high",
    "correct_fix": ""
  },
  "provenance": {
    "source": "trail_of_bits",
    "original_id": "notso_reentrancy_dao",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 1154,
    "num_contracts": 17,
    "contract_names": [
      "TokenInterface",
      "Token",
      "ManagedAccountInterface",
      "uint",
      "ManagedAccount",
      "receives",
      "TokenCreationInterface",
      "TokenCreation",
      "DAOInterface",
      "created",
      "able",
      "able",
      "of",
      "function",
      "itself",
      "DAO",
      "DAO_Creator"
    ],
    "num_functions": 72,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": true,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "not_so_smart",
    "tier_2_medium",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 2,
    "difficulty_tier_name": "clear_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_113.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_113.json",
    "original_id": "notso_reentrancy_dao"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_113.sol",
  "sanitized_from": "ds_113",
  "derived_from": "nc_ds_113",
  "original_id": "ds_113",
  "identifier_mappings": {
    "transferFromWithoutReward": "_0xe1825b",
    "changeAllowedRecipients": "_0xa1df66",
    "minProposalDebatePeriod": "_0x2b2d68",
    "transferWithoutReward": "_0x0d7ac3",
    "sumOfProposalDeposits": "_0xb732cd",
    "changeProposalDeposit": "_0xc9694b",
    "executeProposalPeriod": "_0x01a357",
    "minSplitDebatePeriod": "_0x0aa511",
    "lastTimeMinQuorumMet": "_0xdbd1cf",
    "splitExecutionPeriod": "_0x5a9b76",
    "rewardTokenToBeMoved": "_0x43f838",
    "creationGracePeriod": "_0x98edc8",
    "quorumHalvingPeriod": "_0x02f8d6",
    "isRecipientAllowed": "_0xe769c3",
    "_numberOfProposals": "_0x14d6ca",
    "_minTokensToCreate": "_0x0c1e2e",
    "_supportsProposal": "_0x2bdf09",
    "checkProposalCode": "_0x5e5a4a",
    "withdrawRewardFor": "_0x31f65b",
    "retrieveDAOReward": "_0xfbe7d1",
    "numberOfProposals": "_0xd90ca4",
    "maxDepositDivisor": "_0x0bc363",
    "minTokensToCreate": "_0x3bf5a8",
    "allowedRecipients": "_0x55348e",
    "minQuorumDivisor": "_0xfa7c3e",
    "getNewDAOAddress": "_0xc729b2",
    "createTokenProxy": "_0x3865de",
    "_proposalDeposit": "_0x07bebf",
    "_transactionData": "_0x798a5b",
    "onlyTokenholders": "_0xbb54b0",
    "_privateCreation": "_0x898780",
    "totalRewardToken": "_0xcf706e",
    "accumulatedInput": "_0xcc9182",
    "paidOutToBeMoved": "_0xc63904",
    "executeProposal": "_0xecb538",
    "proposalDeposit": "_0x258149",
    "transferPaidOut": "_0x068d8b",
    "_debatingPeriod": "_0xeb3425",
    "privateCreation": "_0xa08d4d",
    "proposalPassed": "_0x587765",
    "_codeChecksOut": "_0xa88e4e",
    "halveMinQuorum": "_0xd5e137",
    "votingDeadline": "_0x1c132c",
    "_actualBalance": "_0x6de020",
    "fundsToBeMoved": "_0xfa9eb8",
    "rewardAccount": "_0x09dcd4",
    "_payOwnerOnly": "_0x4fe1c0",
    "actualBalance": "_0x92f72e",
    "closeProposal": "_0xc7be8b",
    "proposalCheck": "_0xa35061",
    "_newContract": "_0xc7c9bd",
    "splitBalance": "_0xab97c5",
    "_closingTime": "_0x390573",
    "proposalHash": "_0xb6e1f5",
    "createNewDAO": "_0xdb37c7",
    "_tokenHolder": "_0xcd11a7",
    "receiveEther": "_0x4fdb13",
    "extraBalance": "_0x1f4aee",
    "transferFrom": "_0x644da0",
    "payOwnerOnly": "_0xfe017f",
    "_description": "_0xb619ef",
    "newContract": "_0xed413f",
    "getMyReward": "_0x41b865",
    "_daoCreator": "_0x5559f2",
    "_proposalID": "_0xa82900",
    "description": "_0x68c956",
    "newProposal": "_0x950d9b",
    "closingTime": "_0x237ae6",
    "totalSupply": "_0xeffac9",
    "rewardToken": "_0x297d78",
    "_newCurator": "_0x69c816",
    "_recipient": "_0x65c70a",
    "_isAllowed": "_0xf7991e",
    "_toMembers": "_0x75333f",
    "_minQuorum": "_0x58ec57",
    "waitPeriod": "_0x933909",
    "daoCreator": "_0x281933",
    "newCurator": "_0x102d26",
    "proposalID": "_0xb29661",
    "isBlocked": "_0xb4c5b7",
    "allowance": "_0x6e80f1",
    "splitData": "_0xbf6531",
    "proposals": "_0x9b5bf9",
    "createDAO": "_0xe8018f",
    "recipient": "_0xeb6a0e",
    "unblockMe": "_0x176120",
    "minQuorum": "_0x5b2ead",
    "balanceOf": "_0xf51878",
    "remaining": "_0xc5f60e",
    "_account": "_0xb9e296",
    "isFueled": "_0xcd62bc",
    "position": "_0xcb87c9",
    "splitDAO": "_0x27ace5",
    "balances": "_0xf26729",
    "weiGiven": "_0xba2f69",
    "_curator": "_0xcf890f",
    "_success": "_0xaa65a9",
    "_spender": "_0x5f3d80",
    "_allowed": "_0xc6a27e",
    "votedYes": "_0xe3886f",
    "curator": "_0x3df12b",
    "blocked": "_0xa098de",
    "creator": "_0x0b6751",
    "approve": "_0x102131",
    "_voteID": "_0xb983e0",
    "paidOut": "_0x3dc5b0",
    "votedNo": "_0xebcb58",
    "allowed": "_0xe8c88c",
    "_amount": "_0x35af93",
    "divisor": "_0x7a04de",
    "_newDAO": "_0x5f6113",
    "noEther": "_0x309e2b",
    "success": "_0x80ee41",
    "refund": "_0x2046d0",
    "_value": "_0x89ac2e",
    "newDAO": "_0x8dd462",
    "payOut": "_0x6bf5ce",
    "reward": "_0xa4f5bf",
    "amount": "_0xc86254",
    "quorum": "_0xf4f86f",
    "result": "_0xfb4851",
    "_owner": "_0xaba3ef",
    "token": "_0x4badf9",
    "owner": "_0xfe0940",
    "_from": "_0x0c8204",
    "voter": "_0x5497ae",
    "open": "_0x5eb6cb",
    "vote": "_0xf8c3ce",
    "sha3": "_0xcc24fb",
    "nay": "_0x8a7a3a",
    "dao": "_0xadace9",
    "_to": "_0xf4b9c5",
    "yea": "_0x1408dd",
    "now": "_0x16131f",
    "to": "_0x5c09b8"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 135 identifiers using hex style",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 135,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: balanceOf \u2192 _0xf51878"
    ]
  }
}