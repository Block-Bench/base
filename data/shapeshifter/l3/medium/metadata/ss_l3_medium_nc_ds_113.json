{
  "id": "ss_l3_medium_nc_ds_113",
  "contract_file": "contracts/ss_l3_medium_nc_ds_113.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "reentrancy",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "TokenInterface",
      "function_name": "_0xe0ffdc",
      "line_numbers": []
    },
    "root_cause": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "attack_vector": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "impact": "Severity: high",
    "correct_fix": ""
  },
  "provenance": {
    "source": "trail_of_bits",
    "original_id": "notso_reentrancy_dao",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 1154,
    "num_contracts": 17,
    "contract_names": [
      "TokenInterface",
      "Token",
      "ManagedAccountInterface",
      "uint",
      "ManagedAccount",
      "receives",
      "TokenCreationInterface",
      "TokenCreation",
      "DAOInterface",
      "created",
      "able",
      "able",
      "of",
      "function",
      "itself",
      "DAO",
      "DAO_Creator"
    ],
    "num_functions": 72,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": true,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "not_so_smart",
    "tier_2_medium",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 2,
    "difficulty_tier_name": "clear_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_113.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_113.json",
    "original_id": "notso_reentrancy_dao"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_113.sol",
  "sanitized_from": "ds_113",
  "derived_from": "nc_ds_113",
  "original_id": "ds_113",
  "identifier_mappings": {
    "transferFromWithoutReward": "_0xbfe377",
    "changeAllowedRecipients": "_0x2f982f",
    "minProposalDebatePeriod": "_0x7da85e",
    "executeProposalPeriod": "_0x93009b",
    "changeProposalDeposit": "_0x30d290",
    "sumOfProposalDeposits": "_0xed62f3",
    "transferWithoutReward": "_0xbc260d",
    "minSplitDebatePeriod": "_0xa47fb5",
    "rewardTokenToBeMoved": "_0xb7c1a5",
    "lastTimeMinQuorumMet": "_0xd4d731",
    "splitExecutionPeriod": "_0x4904fd",
    "creationGracePeriod": "_0x5c0352",
    "quorumHalvingPeriod": "_0xed6add",
    "_numberOfProposals": "_0xd4beac",
    "isRecipientAllowed": "_0x9262bf",
    "_minTokensToCreate": "_0xb87fbe",
    "retrieveDAOReward": "_0x6ac791",
    "withdrawRewardFor": "_0x27e88b",
    "_supportsProposal": "_0x7e7a42",
    "checkProposalCode": "_0x9dc802",
    "minTokensToCreate": "_0xbb3057",
    "maxDepositDivisor": "_0x1c175b",
    "numberOfProposals": "_0x7094e0",
    "allowedRecipients": "_0x0f9e0f",
    "accumulatedInput": "_0x04fed3",
    "createTokenProxy": "_0xda1ab8",
    "_privateCreation": "_0x53ca54",
    "_transactionData": "_0x9ee5a8",
    "totalRewardToken": "_0x905903",
    "paidOutToBeMoved": "_0xeaf670",
    "_proposalDeposit": "_0xf7dc95",
    "onlyTokenholders": "_0xe98ba6",
    "getNewDAOAddress": "_0xa010f2",
    "minQuorumDivisor": "_0xdfbfbc",
    "_debatingPeriod": "_0x408348",
    "executeProposal": "_0x994c2c",
    "privateCreation": "_0x8f57a6",
    "transferPaidOut": "_0x78bcb1",
    "proposalDeposit": "_0xe78ee9",
    "_codeChecksOut": "_0xc67964",
    "_actualBalance": "_0x7379a1",
    "votingDeadline": "_0x93e1a2",
    "fundsToBeMoved": "_0x1e6256",
    "proposalPassed": "_0xa7a5a2",
    "halveMinQuorum": "_0x3b8429",
    "rewardAccount": "_0xa21521",
    "proposalCheck": "_0xb955b1",
    "actualBalance": "_0xa392d0",
    "_payOwnerOnly": "_0x14e0b1",
    "closeProposal": "_0x2e198f",
    "_description": "_0x382dff",
    "createNewDAO": "_0x520bd9",
    "_closingTime": "_0xd93c92",
    "transferFrom": "_0xa2b519",
    "splitBalance": "_0x11181b",
    "receiveEther": "_0x3cb4a1",
    "payOwnerOnly": "_0x4dc403",
    "_tokenHolder": "_0x460a6d",
    "_newContract": "_0xd65127",
    "proposalHash": "_0x2896c9",
    "extraBalance": "_0xecc9bb",
    "totalSupply": "_0x318d3a",
    "getMyReward": "_0xb3ea4a",
    "newProposal": "_0xfa4a70",
    "description": "_0x07bbce",
    "rewardToken": "_0x71c0fd",
    "_newCurator": "_0x837f54",
    "closingTime": "_0x28ea27",
    "newContract": "_0x41da1c",
    "_daoCreator": "_0xebbe17",
    "_proposalID": "_0x790a8f",
    "_recipient": "_0xce380f",
    "_toMembers": "_0xa207c8",
    "_minQuorum": "_0x35d7bb",
    "waitPeriod": "_0xb5bd69",
    "proposalID": "_0xf31b45",
    "_isAllowed": "_0x3ab064",
    "newCurator": "_0x9806c1",
    "daoCreator": "_0x4dada0",
    "balanceOf": "_0xe0ffdc",
    "minQuorum": "_0x875a1f",
    "proposals": "_0xd073cf",
    "isBlocked": "_0xcac281",
    "remaining": "_0x2ce94c",
    "createDAO": "_0x03c84a",
    "recipient": "_0x6b611f",
    "unblockMe": "_0x8e4c52",
    "allowance": "_0x3736b1",
    "splitData": "_0xf86fae",
    "position": "_0xfb1738",
    "_success": "_0xe4d384",
    "_account": "_0xd46a67",
    "isFueled": "_0x927dcf",
    "votedYes": "_0xf94261",
    "_allowed": "_0xc6bc6e",
    "splitDAO": "_0x5bda1a",
    "_curator": "_0xdba3ea",
    "balances": "_0x22d612",
    "_spender": "_0x4ac7ce",
    "weiGiven": "_0x19c791",
    "allowed": "_0xee9abd",
    "divisor": "_0xb30f31",
    "_newDAO": "_0x31f299",
    "_voteID": "_0xaa6821",
    "creator": "_0x380e35",
    "paidOut": "_0x2ae6c1",
    "blocked": "_0x530f77",
    "_amount": "_0x02f499",
    "curator": "_0x3e4559",
    "votedNo": "_0xa3cc19",
    "approve": "_0x141b99",
    "success": "_0xe88010",
    "noEther": "_0xa4b0b8",
    "refund": "_0x18f362",
    "_value": "_0x606d67",
    "reward": "_0xafff75",
    "_owner": "_0x4fb0c8",
    "payOut": "_0x4c91fc",
    "newDAO": "_0xdc8536",
    "result": "_0x38ead3",
    "amount": "_0x5d4a1a",
    "quorum": "_0x1d89c5",
    "token": "_0xce5813",
    "voter": "_0x74d967",
    "owner": "_0xd1872a",
    "_from": "_0x7d2b1c",
    "sha3": "_0xe84e2d",
    "vote": "_0x72190f",
    "open": "_0x731501",
    "nay": "_0xdee2e2",
    "_to": "_0xdde2c1",
    "dao": "_0xd7a97b",
    "yea": "_0xc7e808",
    "now": "_0xa6133a",
    "to": "_0x92dc79"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 135 identifiers using hex style",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 135,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: balanceOf \u2192 _0xe0ffdc"
    ]
  }
}