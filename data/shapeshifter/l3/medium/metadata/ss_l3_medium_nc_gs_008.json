{
  "id": "ss_l3_medium_nc_gs_008",
  "contract_file": "contracts/ss_l3_medium_nc_gs_008.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GovernanceHYBR",
      "function_name": "_0xc485dd",
      "line_numbers": []
    },
    "root_cause": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
    "attack_vector": "A test votes on pools, warps time, and `claimRewards()` reverts due to invalid getter call.",
    "impact": "Severity: medium",
    "correct_fix": "Add `getPoolVote(veTokenId)` in `VoterV3.sol` to return the array. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M07",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 636,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Incorrect interface usage treats mapping as function, causing revert on reward claims.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-07",
    "finding_title": "Claiming rewards in GovernanceHYBR will always revert",
    "difficulty_tier": 1,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "claimRewards() -> IVoter.poolVote(veTokenId) [invalid call] -> revert"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_008.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_008.json",
    "original_finding_title": "Claiming rewards in GovernanceHYBR will always revert"
  },
  "original_subset": "gold_standard",
  "context": "context/gs_008/",
  "context_files": [
    "context_01_VoterV3.sol"
  ],
  "original_contract_file": "base/contracts/gs_008.sol",
  "sanitized_from": "gs_008",
  "derived_from": "nc_gs_008",
  "original_id": "gs_008",
  "identifier_mappings": {
    "setHeadNotWithdrawTime": "_0xec9b13",
    "setTailNotWithdrawTime": "_0x881b91",
    "tail_not_withdraw_time": "_0x4e6f19",
    "head_not_withdraw_time": "_0x0c65e1",
    "setRewardsDistributor": "_0x553028",
    "setTransferLockPeriod": "_0x6f8f38",
    "_beforeTokenTransfer": "_0x8a5c45",
    "receivePenaltyReward": "_0x4c8428",
    "increase_unlock_time": "_0xd78299",
    "_rewardsDistributor": "_0x567cb2",
    "rewardsDistributor": "_0xe16290",
    "transferLockPeriod": "_0x8e40db",
    "rewardsListLength": "_0x455322",
    "safeTransferFrom": "_0xf41f13",
    "_extendLockToMax": "_0xb11c81",
    "_initializeVeNFT": "_0xb9dbd6",
    "currentAvailable": "_0x56deff",
    "_addTransferLock": "_0x26cb28",
    "lastCompoundTime": "_0x6a7c25",
    "previewAvailable": "_0x371f16",
    "internal_bribes": "_0xb2c285",
    "calculateShares": "_0x6479fe",
    "remainingAmount": "_0x90b462",
    "create_lock_for": "_0xa4e32c",
    "external_bribes": "_0xada628",
    "setGaugeManager": "_0x1f2bd1",
    "emergencyUnlock": "_0x7f377d",
    "calculateAssets": "_0xaf61e2",
    "finalAvailable": "_0xff6c5f",
    "newTotalLocked": "_0x55a2db",
    "sharesReceived": "_0x02b862",
    "setWithdrawFee": "_0xbea1bf",
    "getLockEndTime": "_0x4fb3a9",
    "lastRebaseTime": "_0x7db46b",
    "_cleanExpired": "_0xc3c344",
    "currentLocked": "_0x9178d8",
    "_votingEscrow": "_0x3e13ed",
    "initialAmount": "_0x426457",
    "maxUnlockTime": "_0x97e2f5",
    "externalBribe": "_0xce6f96",
    "_gaugeManager": "_0x50e3de",
    "lastVoteEpoch": "_0x1dd50d",
    "internalBribe": "_0xe38f62",
    "lockedBalance": "_0xd439b9",
    "_totalAssets": "_0x4e5fac",
    "tokenBalance": "_0xa5f63c",
    "totalBalance": "_0x35c762",
    "getUserLocks": "_0x0a0243",
    "onlyOperator": "_0x355ff2",
    "_totalSupply": "_0x6e5b65",
    "nonReentrant": "_0x36da5d",
    "gaugeManager": "_0x663223",
    "votingEscrow": "_0xe3d5f5",
    "rebaseAmount": "_0x7ae4f7",
    "claimRewards": "_0xc485dd",
    "transferFrom": "_0x4d52e5",
    "hybrReceived": "_0x314e84",
    "userTokenId": "_0x9c160e",
    "setOperator": "_0x44a6a6",
    "isPermanent": "_0x52e7f1",
    "deposit_for": "_0xbd437e",
    "newTokenIds": "_0x960298",
    "oldOperator": "_0x15ada6",
    "safeApprove": "_0x641e80",
    "votingYield": "_0x387d8a",
    "totalSupply": "_0xb64bc3",
    "executeSwap": "_0x7a49ad",
    "hybrBalance": "_0x915ae9",
    "withdrawFee": "_0x5ef95c",
    "totalAssets": "_0x80dd85",
    "claimBribes": "_0x845a9b",
    "newOperator": "_0xaf1748",
    "bribeTokens": "_0x61e08c",
    "setSwapper": "_0xea4801",
    "votedPools": "_0x79af57",
    "oldSwapper": "_0x523582",
    "hybrAmount": "_0x8e7b36",
    "multiSplit": "_0x733841",
    "tokenCount": "_0xd0792f",
    "newSwapper": "_0xb383b4",
    "userAmount": "_0xed72f6",
    "swapToHYBR": "_0xbb53bb",
    "feeTokenId": "_0x4c6e55",
    "unlockTime": "_0x73c242",
    "epochStart": "_0x9bc671",
    "onlyOwner": "_0x07d37a",
    "available": "_0x9fb733",
    "veTokenId": "_0x1dc102",
    "oldPeriod": "_0xab06ad",
    "_operator": "_0xbc23d1",
    "userLocks": "_0x6280d6",
    "newPeriod": "_0x3787b7",
    "epochNext": "_0x62ebea",
    "feeAmount": "_0x95bb60",
    "recipient": "_0xfa1550",
    "_poolVote": "_0x96089f",
    "veBalance": "_0xc9abd5",
    "balanceOf": "_0xc84859",
    "compound": "_0xaa358f",
    "poolVote": "_0x40ee56",
    "amountIn": "_0xe0de05",
    "_weights": "_0x7ad5a9",
    "setVoter": "_0xff9081",
    "operator": "_0xdb7bef",
    "lockTime": "_0xe773e0",
    "_swapper": "_0xd6d188",
    "withdraw": "_0x1b3dbf",
    "rewards": "_0xa07c5e",
    "approve": "_0x466241",
    "_params": "_0x1c2c0d",
    "swapper": "_0x03b5f6",
    "penalty": "_0xd7f84f",
    "tokenIn": "_0x95834c",
    "weights": "_0xa91111",
    "amounts": "_0x461b70",
    "deposit": "_0x0f1d0d",
    "enabled": "_0xa1303e",
    "setTeam": "_0x47be4b",
    "_period": "_0x0fb11f",
    "rebase": "_0xd14f31",
    "shares": "_0xb66f3a",
    "gauges": "_0x804d00",
    "locked": "_0xabbaa1",
    "amount": "_0xffce9f",
    "tokens": "_0x6b66b4",
    "bribes": "_0xf331e4",
    "_voter": "_0xe300cf",
    "voted": "_0xe147ef",
    "freed": "_0x779b0c",
    "_burn": "_0x42fe29",
    "epoch": "_0x3799c1",
    "_team": "_0x88b314",
    "_HYBR": "_0xa0d278",
    "gauge": "_0xf41b9a",
    "_time": "_0xd74591",
    "reset": "_0x57b503",
    "_mint": "_0x42cfad",
    "pools": "_0x095904",
    "owner": "_0x8e9bff",
    "write": "_0x0dd2aa",
    "claim": "_0x4eafbd",
    "voter": "_0x7bf77a",
    "vote": "_0x84ef92",
    "_fee": "_0xde6367",
    "user": "_0x716d1a",
    "fee": "_0xc35382",
    "end": "_0xe0b938",
    "arr": "_0x95e7d7",
    "max": "_0x3450dd",
    "len": "_0x05472c",
    "to": "_0xb0fa9f"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 151 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 151,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: claimRewards \u2192 _0xc485dd"
    ]
  }
}