{
  "id": "ss_l3_medium_nc_gs_008",
  "contract_file": "contracts/ss_l3_medium_nc_gs_008.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "medium",
    "vulnerable_location": {
      "contract_name": "GovernanceHYBR",
      "function_name": "_0x7bcacb",
      "line_numbers": []
    },
    "root_cause": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
    "attack_vector": "A test votes on pools, warps time, and `claimRewards()` reverts due to invalid getter call.",
    "impact": "Severity: medium",
    "correct_fix": "Add `getPoolVote(veTokenId)` in `VoterV3.sol` to return the array. Status: Mitigation confirmed."
  },
  "provenance": {
    "source": "code4rena",
    "original_id": "gs_c4_2025-10-hybra-finance_M07",
    "url": "https://code4rena.com/reports/2025-10-hybra-finance",
    "date_discovered": "2025-10-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 636,
    "num_contracts": 1,
    "contract_names": [],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": false,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "notes": "Incorrect interface usage treats mapping as function, causing revert on reward claims.",
  "gold_standard_fields": {
    "source_report": "2025-10-hybra-finance",
    "source_finding_id": "M-07",
    "finding_title": "Claiming rewards in GovernanceHYBR will always revert",
    "difficulty_tier": 1,
    "context_level": "multi_file",
    "has_context": true,
    "call_flow": "claimRewards() -> IVoter.poolVote(veTokenId) [invalid call] -> revert"
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/gold_standard/contracts/gs_008.sol",
    "detailed_metadata": "labelled_data/gold_standard/metadata/gs_008.json",
    "original_finding_title": "Claiming rewards in GovernanceHYBR will always revert"
  },
  "original_subset": "gold_standard",
  "context": "context/gs_008/",
  "context_files": [
    "context_01_VoterV3.sol"
  ],
  "original_contract_file": "base/contracts/gs_008.sol",
  "sanitized_from": "gs_008",
  "derived_from": "nc_gs_008",
  "original_id": "gs_008",
  "identifier_mappings": {
    "head_not_withdraw_time": "_0x25f319",
    "setTailNotWithdrawTime": "_0x2a7508",
    "setHeadNotWithdrawTime": "_0x59ead6",
    "tail_not_withdraw_time": "_0x7b1111",
    "setRewardsDistributor": "_0xdefa93",
    "setTransferLockPeriod": "_0xd6fc84",
    "receivePenaltyReward": "_0x27a247",
    "_beforeTokenTransfer": "_0x6cbdee",
    "increase_unlock_time": "_0xa8dd28",
    "_rewardsDistributor": "_0xbb4603",
    "transferLockPeriod": "_0xcb54f0",
    "rewardsDistributor": "_0xfb4ce1",
    "rewardsListLength": "_0x0706c5",
    "_addTransferLock": "_0xf41bd8",
    "_extendLockToMax": "_0xab2aea",
    "_initializeVeNFT": "_0xbf8ab0",
    "previewAvailable": "_0x01b75b",
    "currentAvailable": "_0xb2c3e5",
    "lastCompoundTime": "_0x85e1d8",
    "safeTransferFrom": "_0x8ec680",
    "remainingAmount": "_0x4bba29",
    "calculateShares": "_0xd6420d",
    "calculateAssets": "_0xa5640a",
    "setGaugeManager": "_0x60dab6",
    "internal_bribes": "_0x2a69d1",
    "create_lock_for": "_0x4875e5",
    "emergencyUnlock": "_0x40bd19",
    "external_bribes": "_0xdae397",
    "newTotalLocked": "_0x8f5953",
    "setWithdrawFee": "_0x14d874",
    "finalAvailable": "_0x9f21cd",
    "sharesReceived": "_0x87e36d",
    "lastRebaseTime": "_0xbf9195",
    "getLockEndTime": "_0x8e524c",
    "lockedBalance": "_0x5ac277",
    "maxUnlockTime": "_0xe0e80f",
    "_gaugeManager": "_0x2c9b85",
    "initialAmount": "_0x779fbd",
    "currentLocked": "_0x113f29",
    "externalBribe": "_0x894765",
    "_votingEscrow": "_0x3f9ad3",
    "_cleanExpired": "_0x466264",
    "lastVoteEpoch": "_0x155a91",
    "internalBribe": "_0x640d09",
    "rebaseAmount": "_0x02fa14",
    "hybrReceived": "_0xe3e7eb",
    "getUserLocks": "_0x6661dd",
    "_totalSupply": "_0x4894fd",
    "transferFrom": "_0xd0c5ed",
    "_totalAssets": "_0xd76bcf",
    "totalBalance": "_0x08f0fe",
    "nonReentrant": "_0x963996",
    "votingEscrow": "_0x77e250",
    "claimRewards": "_0x7bcacb",
    "tokenBalance": "_0x168562",
    "onlyOperator": "_0x9ffd01",
    "gaugeManager": "_0xe1255a",
    "totalSupply": "_0x3f009d",
    "oldOperator": "_0xabaaff",
    "safeApprove": "_0x1acc80",
    "bribeTokens": "_0xf53b4b",
    "newTokenIds": "_0xa75cef",
    "totalAssets": "_0x65c07e",
    "isPermanent": "_0x982c24",
    "setOperator": "_0x612f15",
    "votingYield": "_0x5627f8",
    "executeSwap": "_0x0afbe2",
    "userTokenId": "_0x7aba56",
    "hybrBalance": "_0xbe97d5",
    "newOperator": "_0x793e2e",
    "withdrawFee": "_0x4e5705",
    "claimBribes": "_0xec982b",
    "deposit_for": "_0x310f34",
    "newSwapper": "_0x6206e1",
    "votedPools": "_0xc23cdd",
    "oldSwapper": "_0xd7dc0d",
    "feeTokenId": "_0x62f8e7",
    "multiSplit": "_0x3032c8",
    "tokenCount": "_0x35f22b",
    "hybrAmount": "_0x5f1aa1",
    "epochStart": "_0x59972b",
    "unlockTime": "_0x823e3a",
    "userAmount": "_0x1029e5",
    "setSwapper": "_0x3230b5",
    "swapToHYBR": "_0xcdb781",
    "veTokenId": "_0xab8475",
    "feeAmount": "_0x570124",
    "balanceOf": "_0x7a2679",
    "_poolVote": "_0xdaf19d",
    "userLocks": "_0xdd39d9",
    "oldPeriod": "_0x1b38be",
    "available": "_0x2b1ea2",
    "recipient": "_0x5a0989",
    "newPeriod": "_0xe4b98d",
    "epochNext": "_0xeb185c",
    "veBalance": "_0x6626e0",
    "onlyOwner": "_0x0355ed",
    "_operator": "_0x113301",
    "withdraw": "_0x18d6ed",
    "lockTime": "_0x2d021e",
    "setVoter": "_0x1e7b42",
    "compound": "_0xfd93e2",
    "_swapper": "_0x0e9b24",
    "poolVote": "_0x77c761",
    "_weights": "_0xa90b19",
    "amountIn": "_0x1430fb",
    "operator": "_0xa69e95",
    "tokenIn": "_0xbe4187",
    "penalty": "_0x314d36",
    "amounts": "_0x55f1d8",
    "enabled": "_0x7672e8",
    "setTeam": "_0xc07155",
    "_params": "_0x8f317c",
    "weights": "_0x7d520e",
    "approve": "_0xc92404",
    "rewards": "_0x71a4b4",
    "_period": "_0xc7d496",
    "swapper": "_0x0571e8",
    "deposit": "_0xae5667",
    "_voter": "_0x5bb1e1",
    "tokens": "_0x149f69",
    "gauges": "_0x7ceef2",
    "rebase": "_0x0a0d76",
    "shares": "_0x1bf0b6",
    "bribes": "_0xac9efb",
    "locked": "_0x310ca3",
    "amount": "_0xe85248",
    "write": "_0x55d78c",
    "_time": "_0x214f47",
    "reset": "_0x9d7dd1",
    "epoch": "_0xda0eb6",
    "_HYBR": "_0x4974b4",
    "_burn": "_0xdcee5e",
    "voter": "_0xbf5dc6",
    "_mint": "_0x0ce2d2",
    "gauge": "_0x3065fb",
    "owner": "_0xc4c6cb",
    "pools": "_0x92c607",
    "_team": "_0x1f8339",
    "freed": "_0x9d34b6",
    "voted": "_0x7eb1c1",
    "claim": "_0x6267ea",
    "user": "_0x0a4371",
    "_fee": "_0x65e246",
    "vote": "_0xd3fbf0",
    "end": "_0xff5947",
    "len": "_0x9f4811",
    "arr": "_0x1e6a8c",
    "max": "_0x4747e5",
    "fee": "_0x232183",
    "to": "_0x177f06"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 151 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 151,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: claimRewards \u2192 _0x7bcacb"
    ]
  }
}