{
  "id": "ss_l3_medium_sn_ds_113",
  "contract_file": "contracts/ss_l3_medium_sn_ds_113.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "reentrancy",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "TokenInterface",
      "function_name": "_0x04991d",
      "line_numbers": []
    },
    "root_cause": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "attack_vector": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
    "impact": "Severity: high",
    "correct_fix": ""
  },
  "provenance": {
    "source": "trail_of_bits",
    "original_id": "notso_reentrancy_dao",
    "url": null,
    "date_discovered": null,
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 1154,
    "num_contracts": 17,
    "contract_names": [
      "TokenInterface",
      "Token",
      "ManagedAccountInterface",
      "uint",
      "ManagedAccount",
      "receives",
      "TokenCreationInterface",
      "TokenCreation",
      "DAOInterface",
      "created",
      "able",
      "able",
      "of",
      "function",
      "itself",
      "DAO",
      "DAO_Creator"
    ],
    "num_functions": 72,
    "has_imports": true,
    "imports": [],
    "has_inheritance": true,
    "inherits_from": [],
    "has_modifiers": true,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "not_so_smart",
    "tier_2_medium",
    "solidity"
  ],
  "notes": null,
  "difficulty_fields": {
    "difficulty_tier": 2,
    "difficulty_tier_name": "clear_audit",
    "complexity_analysis": {
      "complexity_factors": [],
      "detection_hints": "# Re-entrancy\nA state variable is changed after a contract uses `call.value`. The attacker uses\n[a fallback function](ReentrancyExploit.sol#L26-L33)\u2014which is automatically executed after\nEther is transferred from the targeted contract\u2014to execute the vulnerable function again, *before* the\nstate variable is changed.",
      "detection_challenges": null,
      "estimated_human_time_minutes": null
    },
    "canonical_example": false
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/difficulty_stratified/contracts/ds_113.sol",
    "detailed_metadata": "labelled_data/difficulty_stratified/metadata/ds_113.json",
    "original_id": "notso_reentrancy_dao"
  },
  "original_subset": "difficulty_stratified",
  "original_contract_file": "base/contracts/ds_113.sol",
  "sanitized_from": "ds_113",
  "identifier_mappings": {
    "transferFromWithoutReward": "_0x0a9f44",
    "changeAllowedRecipients": "_0xbcd432",
    "minProposalDebatePeriod": "_0x3ac53a",
    "changeProposalDeposit": "_0x0cdf3e",
    "sumOfProposalDeposits": "_0x34ced8",
    "transferWithoutReward": "_0x8e2cb4",
    "executeProposalPeriod": "_0xf46f6a",
    "rewardTokenToBeMoved": "_0x724aeb",
    "minSplitDebatePeriod": "_0x8c565a",
    "splitExecutionPeriod": "_0x30d997",
    "lastTimeMinQuorumMet": "_0xda4f4d",
    "creationGracePeriod": "_0x47195d",
    "quorumHalvingPeriod": "_0x4e7ea2",
    "_numberOfProposals": "_0xb1dba5",
    "isRecipientAllowed": "_0x67a1a9",
    "_minTokensToCreate": "_0x4117a3",
    "maxDepositDivisor": "_0xb881ef",
    "withdrawRewardFor": "_0x08710d",
    "checkProposalCode": "_0x4c4454",
    "minTokensToCreate": "_0x0355dc",
    "numberOfProposals": "_0xf761f2",
    "retrieveDAOReward": "_0x6f979c",
    "_supportsProposal": "_0x56f125",
    "allowedRecipients": "_0xd74f28",
    "paidOutToBeMoved": "_0xb59190",
    "onlyTokenholders": "_0x9c814d",
    "minQuorumDivisor": "_0x227f45",
    "accumulatedInput": "_0x2040f0",
    "_transactionData": "_0x1ec86f",
    "totalRewardToken": "_0x90fbe4",
    "getNewDAOAddress": "_0xabb88e",
    "_privateCreation": "_0x05a501",
    "createTokenProxy": "_0x21c554",
    "_proposalDeposit": "_0x8efc40",
    "executeProposal": "_0xdeae60",
    "_debatingPeriod": "_0x17066f",
    "transferPaidOut": "_0x550e49",
    "proposalDeposit": "_0x4db59b",
    "privateCreation": "_0x74de6f",
    "votingDeadline": "_0xec09f1",
    "fundsToBeMoved": "_0x1c42aa",
    "proposalPassed": "_0xefee8f",
    "_actualBalance": "_0x49ab13",
    "_codeChecksOut": "_0xdc5a95",
    "halveMinQuorum": "_0xd84987",
    "actualBalance": "_0x018f5b",
    "rewardAccount": "_0x617363",
    "proposalCheck": "_0x24a2f2",
    "closeProposal": "_0x3e6166",
    "_payOwnerOnly": "_0x872b08",
    "extraBalance": "_0x1c7a69",
    "_newContract": "_0xb0e571",
    "transferFrom": "_0xa46180",
    "proposalHash": "_0xf922fc",
    "_description": "_0xed124e",
    "_closingTime": "_0x4a2595",
    "_tokenHolder": "_0xeba002",
    "receiveEther": "_0xe7b97a",
    "splitBalance": "_0x3577f0",
    "createNewDAO": "_0x026264",
    "payOwnerOnly": "_0xdf45bb",
    "_daoCreator": "_0xdd62cc",
    "newProposal": "_0x2bf0e1",
    "closingTime": "_0xc6634f",
    "_proposalID": "_0x6ce912",
    "_newCurator": "_0xa0c067",
    "newContract": "_0xb6ab1f",
    "totalSupply": "_0x65c7be",
    "getMyReward": "_0xef5fc0",
    "rewardToken": "_0x53460a",
    "description": "_0xf0c0ad",
    "_toMembers": "_0x701973",
    "newCurator": "_0xe658d9",
    "_recipient": "_0xdf6be0",
    "_minQuorum": "_0xb7cba4",
    "_isAllowed": "_0xf596ea",
    "daoCreator": "_0x0492aa",
    "waitPeriod": "_0x75565c",
    "proposalID": "_0x5b189a",
    "proposals": "_0x6833df",
    "allowance": "_0x21f953",
    "balanceOf": "_0x04991d",
    "minQuorum": "_0x969477",
    "remaining": "_0x801c1f",
    "createDAO": "_0x7a8b97",
    "isBlocked": "_0x039886",
    "recipient": "_0x3933b1",
    "unblockMe": "_0x6aa676",
    "splitData": "_0xe89d83",
    "_curator": "_0xdbe3a8",
    "_allowed": "_0x4e8d9e",
    "votedYes": "_0xd089bd",
    "_spender": "_0xec10eb",
    "_success": "_0x666330",
    "isFueled": "_0x4207a7",
    "_account": "_0x4de415",
    "weiGiven": "_0xc86b83",
    "splitDAO": "_0x2c9bcf",
    "position": "_0x81fc9b",
    "balances": "_0x00fb2c",
    "creator": "_0x40b282",
    "_newDAO": "_0x80ce34",
    "approve": "_0x8da64f",
    "allowed": "_0x2c62e7",
    "_amount": "_0x14e65a",
    "noEther": "_0x5a6397",
    "blocked": "_0xf37388",
    "curator": "_0xf39aa1",
    "_voteID": "_0x7a311a",
    "success": "_0xba9c65",
    "votedNo": "_0x3c3f4d",
    "divisor": "_0x38d505",
    "paidOut": "_0x1e231f",
    "amount": "_0xb39768",
    "result": "_0x6722ed",
    "_owner": "_0xf00075",
    "payOut": "_0x2a427c",
    "refund": "_0x3d10b4",
    "quorum": "_0xf34f3c",
    "_value": "_0x39982a",
    "newDAO": "_0xefe9c1",
    "reward": "_0x2ada3c",
    "_from": "_0x448579",
    "token": "_0x2d0a48",
    "owner": "_0xee21f3",
    "voter": "_0x0084fa",
    "vote": "_0x9dca67",
    "open": "_0x0daec4",
    "sha3": "_0x5fd524",
    "yea": "_0xd97bef",
    "dao": "_0xb852fa",
    "now": "_0xcbb481",
    "_to": "_0xfe828f",
    "nay": "_0x0b1fec",
    "to": "_0x59448d"
  },
  "derived_from": "sn_ds_113",
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "sanitized",
    "changes": [
      "Renamed 135 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 135,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: balanceOf \u2192 _0x04991d"
    ]
  }
}