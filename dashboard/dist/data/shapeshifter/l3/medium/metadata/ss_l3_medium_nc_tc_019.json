{
  "id": "ss_l3_medium_nc_tc_019",
  "contract_file": "contracts/ss_l3_medium_nc_tc_019.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": {
        "name": "QBridgeHandler",
        "functions": [
          {
            "name": "deposit",
            "vulnerability": "Missing validation that tokenContract != address(0)"
          },
          {
            "name": "setResource",
            "vulnerability": "Allows setting tokenAddress to address(0) without validation"
          }
        ]
      },
      "function_name": null,
      "line_numbers": []
    },
    "root_cause": "The bridge handler did not validate that the token contract address was not zero. Calls to address(0) do not revert in the EVM, so the transferFrom call succeeded silently without moving any tokens. However, the deposit event was still emitted, causing the destination chain to mint unbacked tokens.",
    "attack_vector": "1) Attacker identified or created a resourceID that mapped to address(0) in the bridge handler. 2) Called deposit() with this resourceID and large amount. 3) Handler attempted transferFrom on address(0), which succeeded without transferring anything. 4) Bridge emitted deposit event. 5) BSC handler received event and minted tokens to attacker. 6) Attacker repeated the exploit multiple times to extract $80M worth of tokens without providing any real collateral.",
    "impact": "Funds lost: $80,000,000",
    "correct_fix": null
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2022-01-27",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 62,
    "num_contracts": 2,
    "contract_names": [
      "CrossChainBridge",
      "BridgeHandler"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "bridge",
    "validation",
    "zero_address",
    "cross_chain",
    "access_control",
    "ethereum",
    "bsc"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2022-01-27",
      "protocol_name": "Qubit Bridge Zero Address Bypass",
      "chain": "ethereum",
      "funds_lost_usd": 80000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous Qubit Bridge Zero Address Bypass exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_019.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_019.json",
    "original_exploit_name": "Qubit Bridge Zero Address Bypass"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_019.sol",
  "sanitized_from": "tc_019",
  "derived_from": "nc_tc_019",
  "original_id": "tc_019",
  "identifier_mappings": {
    "resourceIDToTokenContractAddress": "_0x39056f",
    "destinationDomainID": "_0x114da6",
    "contractWhitelist": "_0xc14d27",
    "tokenContract": "_0x83258f",
    "depositNonce": "_0x8b3fbf",
    "tokenAddress": "_0xa4f40f",
    "transferFrom": "_0x9f1a02",
    "setResource": "_0x3d42e2",
    "resourceID": "_0xbb28f5",
    "depositer": "_0x1e8e7e",
    "balanceOf": "_0x3226e7",
    "_handler": "_0x68fea0",
    "handler": "_0x3bde47",
    "deposit": "_0x339dd0",
    "account": "_0x1aee90",
    "decode": "_0x452253",
    "amount": "_0xc660fe",
    "to": "_0xee1264"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 18 identifiers using hex style",
      "Wrapped assignment in conditional"
    ],
    "rename_map_size": 18,
    "metadata_changes": []
  }
}