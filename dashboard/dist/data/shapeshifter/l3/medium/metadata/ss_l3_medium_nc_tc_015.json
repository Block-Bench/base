{
  "id": "ss_l3_medium_nc_tc_015",
  "contract_file": "contracts/ss_l3_medium_nc_tc_015.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": "compound_tusd.sol",
      "function_name": "_0x3a4cf1",
      "line_numbers": []
    },
    "root_cause": "After TUSD token upgrade, cTUSD contract still referenced old address as underlying. sweepToken only blocked old address, allowing new TUSD address to be swept despite being the actual underlying asset.",
    "attack_vector": "TUSD upgraded from old to new contract address. cTUSD.sweepToken(newTUSD) was called. Check passed because newTUSD != oldTUSD. All TUSD swept from market. Exploiter returned funds.",
    "impact": "Funds lost: $0",
    "correct_fix": "Maintain mapping of all valid underlying addresses (old and new). Check against all addresses in sweepToken. Update contract when underlying token upgrades."
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2022-03-15",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 53,
    "num_contracts": 1,
    "contract_names": [
      "CompoundMarket"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "logic-error",
    "token-upgrade",
    "sweep-function",
    "address-mismatch",
    "compound"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2022-03-15",
      "protocol_name": "Compound cTUSD",
      "chain": "ethereum",
      "funds_lost_usd": 0,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": false,
      "likely_in_training": true,
      "exposure_notes": "Famous Compound cTUSD exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_015.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_015.json",
    "original_exploit_name": "Compound cTUSD"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_015.sol",
  "sanitized_from": "tc_015",
  "derived_from": "nc_tc_015",
  "original_id": "tc_015",
  "identifier_mappings": {
    "accountTokens": "_0x665852",
    "totalSupply": "_0x0b06f2",
    "sweepToken": "_0x3a4cf1",
    "underlying": "_0xa143c5",
    "balanceOf": "_0xf41300",
    "account": "_0x10a31d",
    "redeem": "_0x36201e",
    "amount": "_0xab128b",
    "admin": "_0x61b2f4",
    "token": "_0x0315fb",
    "mint": "_0x2b5093",
    "to": "_0x5c1e25"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 12 identifiers using hex style"
    ],
    "rename_map_size": 12,
    "metadata_changes": [
      "Transformed ground_truth.vulnerable_location.function_name: sweepToken \u2192 _0x3a4cf1"
    ]
  }
}