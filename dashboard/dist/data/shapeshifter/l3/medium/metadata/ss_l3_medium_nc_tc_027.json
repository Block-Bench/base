{
  "id": "ss_l3_medium_nc_tc_027",
  "contract_file": "contracts/ss_l3_medium_nc_tc_027.sol",
  "subset": "shapeshifter",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "logic_error",
    "severity": "high",
    "vulnerable_location": {
      "contract_name": {
        "name": "BurgerSwapRouter",
        "functions": [
          {
            "name": "swapExactTokensForTokens",
            "vulnerability": "Accepts any pair address without factory validation"
          }
        ]
      },
      "function_name": null,
      "line_numbers": []
    },
    "root_cause": "Router's swap function didn't verify that pairs came from the official factory. It accepted any pair address provided in the path, allowing attackers to inject fake pairs with arbitrary reserve ratios.",
    "attack_vector": "1) Attacker created fake token contracts mimicking legitimate addresses. 2) Created malicious pair contract with manipulated reserves (e.g., 1 fake token = 1000 real tokens). 3) Called router swap function with path through fake token. 4) Router accepted fake pair without factory validation. 5) Executed swap at manipulated price. 6) Extracted $7M in real tokens.",
    "impact": "Funds lost: $7,000,000",
    "correct_fix": null
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": null,
    "url": null,
    "date_discovered": "2021-05-28",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 41,
    "num_contracts": 1,
    "contract_names": [
      "SwapRouter"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "amm",
    "fake_token",
    "bsc",
    "pair_validation",
    "uniswap_fork"
  ],
  "notes": null,
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2021-05-28",
      "protocol_name": "BurgerSwap Fake Token",
      "chain": "binance_smart_chain",
      "funds_lost_usd": 7000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": false,
      "likely_in_training": true,
      "exposure_notes": "Famous BurgerSwap Fake Token exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_027.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_027.json",
    "original_exploit_name": "BurgerSwap Fake Token"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_027.sol",
  "sanitized_from": "tc_027",
  "derived_from": "nc_tc_027",
  "original_id": "tc_027",
  "identifier_mappings": {
    "swapExactTokensForTokens": "_0xd56dbc",
    "_getAmountOut": "_0x3dc68d",
    "amountOutMin": "_0xa23129",
    "encodePacked": "_0x88b248",
    "getReserves": "_0x002dbc",
    "reserveOut": "_0x1bc7cf",
    "reserveIn": "_0xe1cd7d",
    "keccak256": "_0x58b2ca",
    "reserve1": "_0xdef6e1",
    "amountIn": "_0xefd64b",
    "deadline": "_0x8d160f",
    "reserve0": "_0x3d3ef2",
    "_getPair": "_0xa4ae3d",
    "amounts": "_0xd4aac2",
    "token1": "_0x062469",
    "token0": "_0xf2721f",
    "tokenA": "_0xf9def9",
    "tokenB": "_0xca4d4d",
    "pair": "_0x3e1c15",
    "path": "_0x8f1355",
    "to": "_0x7d9a0e"
  },
  "transformation": {
    "strategy": "shapeshifter",
    "level": "l3",
    "variant": "medium",
    "source": "nocomments",
    "changes": [
      "Renamed 21 identifiers using hex style"
    ],
    "rename_map_size": 21,
    "metadata_changes": []
  }
}