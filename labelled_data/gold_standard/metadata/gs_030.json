{
  "id": "gs_030",
  "original_id": "gs_c4_2025-10-sequence_H02",
  "source_dataset": "gold_standard",
  "source_file": "sequence.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "",
  "source_finding_id": "H-02",
  "report_url": "https://code4rena.com/reports/2025-10-sequence",
  "github_repo_url": "https://github.com/code-423n4/2025-10-sequence",
  "contest_date": "2025-10-07",
  "vulnerability_type": "signature_replay",
  "severity": "high",
  "difficulty_tier": 3,
  "context_level": "multi_file",
  "is_vulnerable": true,
  "finding_title": "Partial signature replay/frontrunning attack on session calls",
  "finding_description": "When a session call with BEHAVIOR_REVERT_ON_ERROR fails, the transaction reverts but nonce is not consumed. The signature remains valid and can be replayed for partial calls. Session signatures are validated per-call using individual call hashes, enabling partial replay. Frontrunners can execute subsets of calls to grief or cause financial loss.",
  "attack_scenario": "Original payload: Calls [A, B, C] with signatures [SigA, SigB, SigC]. Execution: [A succeed, B succeed, C revert]. Result: Revert, nonce unused. Attack: Replay [A, B] with [SigA, SigB]. PoC: File POC.t.sol with test testSubmissionValidity. It builds a 2-call payload, expects revert on second call, then replays partial payload successfully.",
  "fix_description": "Bind session call signatures to the complete payload hash to prevent partial signature replay.",
  "call_flow": "User.submit(session calls [A,B,C]) -> C fails -> revert (nonce preserved) -> Attacker/Frontrunner.submit([A,B]) -> succeeds with partial sigs",
  "context_hint": "Session signatures are per-call, and failed batches preserve nonce, allowing replay of successful subsets for griefing or frontrunning.",
  "primary_file_path": "src/modules/Calls.sol",
  "vulnerable_lines": [
    36,
    37,
    38,
    39,
    40,
    41,
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    61,
    62,
    63,
    64,
    65,
    66,
    67,
    68,
    69,
    70,
    71,
    72,
    73,
    74,
    75,
    76,
    77,
    78,
    79,
    80,
    81,
    82,
    83,
    84,
    85,
    86,
    87,
    88,
    89,
    90,
    91,
    92,
    93,
    94,
    95,
    96,
    97,
    98,
    99,
    100,
    101,
    102,
    103,
    104,
    105,
    106,
    107,
    108,
    109,
    110,
    111,
    112,
    113,
    114,
    115,
    116,
    117,
    118,
    119,
    120,
    121,
    122,
    123
  ],
  "vulnerable_functions": [
    "executeSessionCalls"
  ],
  "context_files": [
    {
      "filename": "context_01_SessionSig.sol",
      "original_path": "src/extensions/sessions/SessionSig.sol",
      "relevance": "SessionSig hashes individual calls rather than full payload, enabling partial replay."
    }
  ],
  "has_context": true
}