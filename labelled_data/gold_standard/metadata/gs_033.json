{
  "id": "gs_033",
  "original_id": "gs_c4_2025-10-sequence_M03",
  "source_dataset": "gold_standard",
  "source_file": "sequence.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "",
  "source_finding_id": "M-03",
  "report_url": "https://code4rena.com/reports/2025-10-sequence",
  "github_repo_url": "https://github.com/code-423n4/2025-10-sequence",
  "contest_date": "2025-10-07",
  "vulnerability_type": "logic_error",
  "severity": "medium",
  "difficulty_tier": 2,
  "context_level": "multi_file",
  "is_vulnerable": true,
  "finding_title": "BaseAuth.recoverSapientSignature returns a constant instead of signer image hash, breaking sapient signer flows",
  "finding_description": "BaseAuth.recoverSapientSignature returns bytes32(uint256(1)) instead of actual signer imageHash, violating ISapient interface. Breaks Merkle leaf construction in BaseSig.recoverBranch.",
  "attack_scenario": "Wallet uses another wallet as sapient signer \u2192 signature validation fails due to incorrect image hash. PoC: Add test to test/modules/BaseSig.t.sol: test_BaseAuth_recoverSapientSignature_ReturnsConstant. Deploys MinimalSapient, crafts signature, asserts constant return.",
  "fix_description": "Return actual image hash from recoverSapientSignature. Extend signatureValidation to return imageHash or call BaseSig.recover.",
  "call_flow": "Sapient signature validation -> BaseAuth.recoverSapientSignature() -> returns constant (0x1) -> Merkle leaf mismatch -> validation fails",
  "context_hint": "Sapient signer recovery returns hardcoded constant instead of actual image hash, breaking nested/sapient signer configurations.",
  "primary_file_path": "src/modules/auth/BaseAuth.sol",
  "vulnerable_lines": [
    120,
    121,
    122,
    123,
    124,
    125,
    126,
    127,
    128,
    129,
    130,
    131,
    132,
    133,
    134,
    135,
    136,
    137,
    138,
    139,
    140
  ],
  "vulnerable_functions": [
    "recoverSapientSignature"
  ],
  "context_files": [
    {
      "filename": "context_01_ISapient.sol",
      "original_path": "src/modules/interfaces/ISapient.sol",
      "relevance": "ISapient expects proper imageHash return for sapient signer flows."
    }
  ],
  "has_context": true
}