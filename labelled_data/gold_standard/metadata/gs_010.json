{
  "id": "gs_010",
  "original_id": "gs_c4_2025-10-hybra-finance_M09",
  "source_dataset": "gold_standard",
  "source_file": "Hybrafin.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "2025-10-hybra-finance",
  "source_finding_id": "M-09",
  "report_url": "https://code4rena.com/reports/2025-10-hybra-finance",
  "github_repo_url": "https://github.com/code-423n4/2025-10-hybra-finance",
  "contest_date": "2025-10-06",
  "vulnerability_type": "access_control",
  "severity": "medium",
  "difficulty_tier": 3,
  "context_level": "multi_file",
  "is_vulnerable": true,
  "finding_title": "CL gauge accepts unverified pools, allowing malicious pool to brick distribution",
  "finding_description": "`GaugeManager._createGauge()` for CL pools (`_gaugeType == 1`) skips factory verification, allowing malicious pools to revert in `updateRewardsGrowthGlobal()`, bricking emissions.",
  "attack_scenario": "A test creates a malicious pool that reverts, votes for it, and `distributeAll()` reverts.",
  "fix_description": "Require `_pool` to be from the trusted CL factory; restrict gauge creation to governance. Status: Unmitigated.",
  "call_flow": "createGauge(malicious pool, type=1) -> vote for gauge -> distributeAll() -> updateRewardsGrowthGlobal() revert",
  "context_hint": "Unverified CL pools can be created and voted for, causing reverts in reward distribution.",
  "primary_file_path": "cl/contracts/GaugeManager.sol",
  "vulnerable_lines": [
    165,
    166,
    167,
    168,
    169,
    170,
    171,
    172,
    173,
    174,
    175,
    176,
    177,
    178,
    179,
    180,
    181,
    182,
    183,
    184,
    185,
    186,
    187,
    188,
    189,
    197,
    198,
    199,
    200,
    201
  ],
  "vulnerable_functions": [
    "_createGauge",
    "createGauge"
  ],
  "context_files": [
    {
      "filename": "context_01_GaugeCL.sol",
      "original_path": "cl/contracts/GaugeCL.sol",
      "relevance": "GaugeCL's reward update reverts on unverified pools, bricking emissions."
    }
  ],
  "has_context": true
}