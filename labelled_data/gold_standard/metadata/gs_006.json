{
  "id": "gs_006",
  "original_id": "gs_c4_2025-10-hybra-finance_M05",
  "source_dataset": "gold_standard",
  "source_file": "Hybrafin.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "2025-10-hybra-finance",
  "source_finding_id": "M-05",
  "report_url": "https://code4rena.com/reports/2025-10-hybra-finance",
  "github_repo_url": "https://github.com/code-423n4/2025-10-hybra-finance",
  "contest_date": "2025-10-06",
  "vulnerability_type": "logic_error",
  "severity": "medium",
  "difficulty_tier": 2,
  "context_level": "single_file",
  "is_vulnerable": true,
  "finding_title": "Rollover rewards are permanently lost due to flawed rewardRate calculation",
  "finding_description": "The `notifyRewardAmount()` function miscalculates the `rewardRate` when a new epoch begins, causing `rollover` rewards from previous epochs to be permanently lost. When `block.timestamp >= _periodFinish`, the function adds both the new `rewardAmount` and the previous epoch\u2019s `clPool.rollover()` to form the `totalRewardAmount`. However, the `rewardRate` is derived only from `rewardAmount`, ignoring the rollover portion: // @audit The total amount to be reserved includes rollover... uint256 totalRewardAmount = rewardAmount + clPool.rollover(); // @audit but the rate calculation completely ignores the rollover. rewardRate = rewardAmount / epochTimeRemaining; // @audit The pool is synced with a CORRECT",
  "attack_scenario": "Refer to original submission for PoC (not detailed here).",
  "fix_description": "Use `totalRewardAmount = rewardAmount + clPool.rollover()` for `rewardRate = totalRewardAmount / epochTimeRemaining`. Status: Mitigation confirmed.",
  "call_flow": "notifyRewardAmount(new reward) -> rollover() added to total but ignored in rewardRate -> stranded rewards overwritten",
  "context_hint": "Reward rate calculation excludes rollover amounts, leading to permanent loss of carried-over rewards in new epochs.",
  "primary_file_path": "cl/contracts/GaugeCL.sol",
  "vulnerable_lines": [
    251
  ],
  "vulnerable_functions": [
    "notifyRewardAmount"
  ],
  "context_files": [],
  "has_context": false
}