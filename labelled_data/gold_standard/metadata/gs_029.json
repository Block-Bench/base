{
  "id": "gs_029",
  "original_id": "gs_c4_2025-10-sequence_H01",
  "source_dataset": "gold_standard",
  "source_file": "sequence.json",
  "language": "solidity",
  "chain": "ethereum",
  "source_platform": "code4rena",
  "source_report": "2025-10-sequence",
  "source_finding_id": "H-01",
  "report_url": "https://code4rena.com/reports/2025-10-sequence",
  "github_repo_url": "https://github.com/code-423n4/2025-10-sequence",
  "contest_date": "2025-10-07",
  "vulnerability_type": "access_control",
  "severity": "high",
  "difficulty_tier": 3,
  "context_level": "multi_file",
  "is_vulnerable": true,
  "finding_title": "Chained signature with checkpoint usage disabled can bypass all checkpointer validation",
  "finding_description": "When a wallet is behind a checkpointer and a chained signature is used with bit 6 (checkpointer usage flag) set to zero, BaseSig.recover skips the checkpointer validation block (BaseSig.sol:88-106). This leaves _checkpointer and snapshot unset (zero-valued). In recoverChained, the checkpointer is ignored, and the signature validation passes even if the checkpointer should be enforced. The final validation succeeds because snapshot.imageHash == bytes32(0) as the checkpointer is ignored.",
  "attack_scenario": "An evicted signer can sign a payload valid under stale wallet configuration and bypass checkpointer validation. PoC: Add test case to BaseSigTest and run forge test --match-test test_PoC_checkpointer_bypass. The test constructs a chained signature with checkpointer disabled, mocks the checkpointer response, and asserts successful recovery with correct image hash.",
  "fix_description": "Do not permit checkpointer to be disabled (bit 6 unset) if chained signature is used. Revert in this case with custom error. Example fix in BaseSig.sol:\nif (signatureFlag & 0x40 == 0) {\n    revert MissingCheckpointer();\n}",
  "call_flow": "User.submit(chained sig with checkpointer flag off) -> BaseSig.recover() skips checkpointer -> recoverChained() ignores checkpointer -> validation passes with stale config",
  "context_hint": "Chained signatures can disable checkpointer enforcement via flag, allowing bypass of intended validation and use of evicted/stale signers.",
  "primary_file_path": "src/modules/auth/BaseSig.sol",
  "vulnerable_lines": [
    88,
    89,
    90,
    91,
    92,
    93,
    94,
    95,
    96,
    97,
    98,
    99,
    100,
    101,
    102,
    103,
    104,
    105,
    106,
    138,
    139,
    140,
    179,
    180,
    181,
    182,
    183,
    184,
    185,
    186,
    187,
    188,
    189,
    190,
    191,
    192,
    193
  ],
  "vulnerable_functions": [
    "recover",
    "recoverChained"
  ],
  "context_files": [],
  "has_context": false
}